


ARM Macro Assembler    Page 1 


    1 00000000         
    2 00000000                 INCLUDE          equates.s
    1 00000000         
    2 00000000        A 
                       globalptr
                               RN               r10         ;//=wram_globals* p
                                                            tr
    3 00000000         ;//cpu_zpage RN r11 ;=CPU_RAM
    4 00000000         ;-------------------------------------------------------
                       ---------------------
    5 00000000         
    6 00000000         
    7 00000000                 MAP              0,globalptr ;//MAP ÓÃÓÚ¶¨ÒåÒ»¸ö
                                                            ½á¹¹»¯µÄÄÚ´æ±íµÄÊ×µ
                                                            ØÖ·
    8 00000000         ;//6502.s   ;//¶¨ÒåÄÚ´æ±íµÄÊ×µØÖ·Îªglobalptr
    9 00000000 00000000 
                       opz     #                4           ;opz # 256*4       
                                                            ;//´úÂë±íµØÖ·      
                                                             
   10 00000000 00000004 
                       readmem_tbl
                               #                8*4         ;//8*4
   11 00000000 00000024 
                       writemem_tbl
                               #                8*4         ;//8*4
   12 00000000 00000044 
                       memmap_tbl
                               #                8*4         ;//´æ´¢Æ÷Ó³Ïó ram+r
                                                            om
   13 00000000 00000064 
                       cpuregs #                7*4         ;//1208´æ·Å6502¼Ä´æ
                                                            Æ÷±£´æµÄ¿ªÊ¼µØÖ·
   14 00000000 00000080 
                       m6502_s #                4           ;//
   15 00000000 00000084 
                       lastbank
                               #                4           ;//6502PC´Ó ROMµÄ×î
                                                            ºóÆ«ÒÆÁ¿
   16 00000000 00000088 
                       nexttimeout
                               #                4
   17 00000000         
   18 00000000 0000008C 
                       rombase #                4           ;//ROM¿ªÊ¼µØÖ·
   19 00000000 00000090 
                       romnumber
                               #                4           ;// ROM´óÐ¡  
   20 00000000 00000094 
                       rommask #                4           ;//ROMÑÚÄ¤ rommask=
                                                            romsize-1
   21 00000000         
   22 00000000 00000098 
                       joy0data
                               #                4           ;//´®ÐÐÊý¾Ý
   23 00000000 0000009C 
                       joy1data
                               #                4           ;//ÊÖ±ú1´®ÐÐÊý¾Ý
   24 00000000         



ARM Macro Assembler    Page 2 


   25 00000000 000000A0 
                       clocksh #                4           ;//Ö´ÐÐµÄÊ±ÖÓÊý apu
                                                            ÓÃ
   26 00000000 000000A4 
                       cpunmif #                4           ;cpuÖÐ¶Ï±êÖ¾
   27 00000000 000000A8 
                       cpuirqf #                4           ;cpuÖÐ¶Ï±êÖ¾ 
   28 00000000         ;-------------------------------------------------------
                       -----------------------------------
   29 00000000         
   30 00000000         
   31 00000000         ;// # 2 ;align      
   32 00000000         
   33 00000000                 END
    3 00000000                 INCLUDE          6502mac.s
    1 00000000         
    2 00000000 00000001 
                       C       EQU              0x01        ;//6502 flags  6502
                                                            ±êÖ¾
    3 00000000 00000002 
                       Z       EQU              0x02
    4 00000000 00000004 
                       I       EQU              0x04
    5 00000000 00000008 
                       D       EQU              0x08
    6 00000000 00000010 
                       B       EQU              0x10        ;//(allways 1 excep
                                                            t when IRQ pushes i
                                                            t)IRQÍâ²¿ÖÐ¶Ï
    7 00000000 00000020 
                       R       EQU              0x20        ;//(locked at 1)
    8 00000000 00000040 
                       V       EQU              0x40
    9 00000000 00000080 
                       N       EQU              0x80
   10 00000000         
   11 00000000         
   12 00000000         
   13 00000000                 MACRO                        ;//translate from 6
                                                            502 PC to rom offse
                                                            t·­Òë´Ó6502 PC ROMµ
                                                            ÄÆ«ÒÆÁ¿
   14 00000000                 encodePC
   15 00000000                 and              r1,m6502_pc,#0xE000 ;//r9ºÍ0xe0
                                                            00°´Î»ÓëÔËËã
   16 00000000                 adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ
                                                            Ö·¼ÓÔØµ½r2
   17 00000000         ;// ldr r0,[r2,r1,lsr#11]    ;//¸Ä¹ý£¬¼Ó2ÐÐ 
   18 00000000                 lsr              r0,r1,#11   ;//>>11Î»   r1/2048
                                                            
   19 00000000                 ldr              r0,[r2,r0]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
   20 00000000         
   21 00000000                 str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
   22 00000000                 add              m6502_pc,m6502_pc,r0 
                                                            ;//m6502_pc+r0
   23 00000000                 MEND
   24 00000000         



ARM Macro Assembler    Page 3 


   25 00000000                 MACRO                        ;//pack 6502 flags 
                                                            into r0   6502±êÖ¾°
                                                            ü×°µ½R0
   26 00000000                 encodeP          $extra
   27 00000000                 and              r0,cycles,#CYC_V+CYC_D+CYC_I+CY
C_C
   28 00000000                 tst              m6502_nz,#0x80000000 ;//PSR_N
   29 00000000                 orrne            r0,r0,#N    ;N
   30 00000000                 tst              m6502_nz,#0xff
   31 00000000                 orreq            r0,r0,#Z    ;Z
   32 00000000                 orr              r0,r0,#$extra ;R(&B)
   33 00000000                 MEND
   34 00000000         
   35 00000000                 MACRO                        ;//;ºê¶¨Òå//unpack 
                                                            6502 flags from r0 
                                                              ½âÑ¹Ëõ6502´ÓR0µÄ±
                                                            êÖ¾
   36 00000000                 decodeP
   37 00000000                 bic              cycles,cycles,#CYC_V+CYC_D+CYC_
I+CYC_C
   38 00000000                 and              r1,r0,#V+D+I+C
   39 00000000                 orr              cycles,cycles,r1 ;//VDIC
   40 00000000                 bic              m6502_nz,r0,#0xFD 
                                                            ;//r0 is signed
   41 00000000                 eor              m6502_nz,m6502_nz,#Z
   42 00000000                 MEND                         ;//    ;ºê¶¨Òå½áÊø
   43 00000000         
   44 00000000                 MACRO
   45 00000000                 fetch            $count      ;//ÌáÈ¡²Ù×÷Âë ;$±êº
                                                            Å ºêÃû $²ÎÊý1£¬$²ÎÊ
                                                            ý2£¬...
   46 00000000         ;//-----------------------------------------------------
                       ----------------
   47 00000000                 ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000000                 add              r0,r0,#$count
   49 00000000                 str              r0,clocksh
   50 00000000         
   51 00000000                 ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000000         ;//-----------------------------------------------------
                       --------------------
   53 00000000                 subs             cycles,cycles,#$count*256 ;//CY
                                                            CLE=256 ;// 3*256 Õ
                                                            ýÊý»ò0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸
                                                            Áî  
   54 00000000                 ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000000         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000000                 ldrpl            pc,[r1,r0,lsl#2]
   57 00000000                 ldr              pc,nexttimeout
   58 00000000                 MEND
   59 00000000         
   60 00000000                 MACRO                        ;//ÏàÍ¬µÄÌáÈ¡£¬µ«Ëü
                                                            Ôö¼ÓÁË½øÎ»£¨Î»0£©
   61 00000000                 fetch_c          $count      ;//same as fetch ex



ARM Macro Assembler    Page 4 


                                                            cept it adds the Ca
                                                            rry (bit 0) also.
   62 00000000         ;//-----------------------------------------------------
                       ----------------
   63 00000000                 ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00000000                 add              r0,r0,#$count
   65 00000000                 str              r0,clocksh
   66 00000000         
   67 00000000                 ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00000000         ;//-----------------------------------------------------
                       --------------------
   69 00000000                 sbcs             cycles,cycles,#$count*256 
                                                            ;//CYCLE=256
   70 00000000                 ldrplb           r0,[m6502_pc],#1
   71 00000000         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00000000                 ldrpl            pc,[r1,r0,lsl#2]
   73 00000000                 ldr              pc,nexttimeout
   74 00000000                 MEND
   75 00000000         
   76 00000000                 MACRO
   77 00000000                 clearcycles
   78 00000000                 and              cycles,cycles,#CYC_MASK 
                                                            ;Save CPU bits
   79 00000000                 MEND
   80 00000000         
   81 00000000                 MACRO
   82 00000000                 readmemabs
   83 00000000                 and              r1,addy,#0xE000
   84 00000000                 adr              lr,%F0
   85 00000000         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00000000                 lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00000000                 ldr              pc,[m6502_rmem,r1]
   88 00000000         
   89 00000000         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
   90 00000000                 MEND
   91 00000000         
   92 00000000                 MACRO
   93 00000000                 readmemzp
   94 00000000                 ldrb             r0,[cpu_zpage,addy]
   95 00000000                 MEND
   96 00000000         
   97 00000000                 MACRO
   98 00000000                 readmemzpi
   99 00000000         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  100 00000000                 lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  101 00000000                 ldrb             r0,[cpu_zpage,r0]
  102 00000000         
  103 00000000                 MEND
  104 00000000         
  105 00000000                 MACRO
  106 00000000                 readmemzps



ARM Macro Assembler    Page 5 


  107 00000000                 ldrsb            m6502_nz,[cpu_zpage,addy] ;RAM
  108 00000000                 MEND
  109 00000000         
  110 00000000                 MACRO
  111 00000000                 readmemimm
  112 00000000                 ldrb             r0,[m6502_pc],#1 ;ROM
  113 00000000                 MEND
  114 00000000         
  115 00000000                 MACRO
  116 00000000                 readmemimms
  117 00000000                 ldrsb            m6502_nz,[m6502_pc],#1
  118 00000000                 MEND
  119 00000000         
  120 00000000                 MACRO
  121 00000000                 readmem
  122 00000000                 [                _type = _ABS
  123 00000000                 readmemabs
  124 00000000                 ]
  125 00000000                 [                _type = _ZP
  126 00000000                 readmemzp
  127 00000000                 ]
  128 00000000                 [                _type = _ZPI
  129 00000000                 readmemzpi
  130 00000000                 ]
  131 00000000                 [                _type = _IMM
  132 00000000                 readmemimm
  133 00000000                 ]
  134 00000000                 MEND
  135 00000000         
  136 00000000                 MACRO
  137 00000000                 readmems
  138 00000000                 [                _type = _ABS
  139 00000000                 readmemabs
  140 00000000                 orr              m6502_nz,r0,r0,lsl#24
  141 00000000                 ]
  142 00000000                 [                _type = _ZP
  143 00000000                 readmemzps
  144 00000000                 ]
  145 00000000                 [                _type = _IMM
  146 00000000                 readmemimms
  147 00000000                 ]
  148 00000000                 MEND
  149 00000000         
  150 00000000         
  151 00000000                 MACRO
  152 00000000                 writememabs
  153 00000000                 and              r1,addy,#0xe000
  154 00000000                 adr              r2,writemem_tbl
  155 00000000                 adr              lr,%F0
  156 00000000         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 00000000                 lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 00000000                 ldr              pc,[r2,r1]
  159 00000000         
  160 00000000         0                                    ;out: r0,r1,r2,addy
                                                            =?
  161 00000000                 MEND
  162 00000000         



ARM Macro Assembler    Page 6 


  163 00000000                 MACRO
  164 00000000                 writememzp
  165 00000000                 strb             r0,[cpu_zpage,addy]
  166 00000000                 MEND
  167 00000000         
  168 00000000                 MACRO
  169 00000000                 writememzpi
  170 00000000         ;// strb r0,[cpu_zpage,addy,lsr#24]
  171 00000000                 lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  172 00000000                 strb             r0,[cpu_zpage,r1]
  173 00000000         
  174 00000000         
  175 00000000                 MEND
  176 00000000         
  177 00000000                 MACRO
  178 00000000                 writemem                     ;//Ð´ÄÚ´æ
  179 00000000                 [                _type = _ABS
  180 00000000                 writememabs
  181 00000000                 ]
  182 00000000                 [                _type = _ZP
  183 00000000                 writememzp
  184 00000000                 ]
  185 00000000                 [                _type = _ZPI
  186 00000000                 writememzpi
  187 00000000                 ]
  188 00000000                 MEND
  189 00000000         ;-------------------------------------------------------
                       ---------------------
  190 00000000         
  191 00000000                 MACRO                        ;//////////////////
                                                            /////////////// ///
                                                            //////////////////
  192 00000000                 push16                       ;push r0
  193 00000000                 mov              r1,r0,lsr#8
  194 00000000                 ldr              r2,m6502_s
  195 00000000                 strb             r1,[r2],#-1
  196 00000000                 orr              r2,r2,#0x100
  197 00000000                 strb             r0,[r2],#-1
  198 00000000                 strb             r2,m6502_s
  199 00000000                 MEND                         ;r1,r2=?
  200 00000000         
  201 00000000                 MACRO
  202 00000000                 push8            $x
  203 00000000                 ldr              r2,m6502_s
  204 00000000                 strb             $x,[r2],#-1
  205 00000000                 strb             r2,m6502_s
  206 00000000                 MEND                         ;r2=?
  207 00000000         
  208 00000000                 MACRO
  209 00000000                 pop16                        ;pop m6502_pc
  210 00000000                 ldrb             r2,m6502_s
  211 00000000                 add              r2,r2,#2
  212 00000000                 strb             r2,m6502_s
  213 00000000                 ldr              r2,m6502_s
  214 00000000                 ldrb             r0,[r2],#-1
  215 00000000                 orr              r2,r2,#0x100
  216 00000000                 ldrb             m6502_pc,[r2]
  217 00000000                 orr              m6502_pc,m6502_pc,r0,lsl#8



ARM Macro Assembler    Page 7 


  218 00000000                 MEND                         ;r0,r1=?
  219 00000000         
  220 00000000                 MACRO
  221 00000000                 pop8             $x
  222 00000000                 ldrb             r2,m6502_s
  223 00000000                 add              r2,r2,#1
  224 00000000                 strb             r2,m6502_s
  225 00000000                 orr              r2,r2,#0x100
  226 00000000                 ldrsb            $x,[cpu_zpage,r2] ;signed for P
                                                            LA & PLP
  227 00000000         
  228 00000000                 MEND                         ;r2=?
  229 00000000         
  230 00000000         ;-------------------------------------------------------
                       ---------------------
  231 00000000         ;doXXX: load addy, increment m6502_pc
  232 00000000         
  233 00000000                 GBLA             _type
  234 00000000         
  235 00000000 00000001 
                       _IMM    EQU              1           ;immediate
  236 00000000 00000002 
                       _ZP     EQU              2           ;zero page
  237 00000000 00000003 
                       _ZPI    EQU              3           ;zero page indexed
  238 00000000 00000004 
                       _ABS    EQU              4           ;absolute
  239 00000000         
  240 00000000                 MACRO
  241 00000000                 doABS                        ;absolute          
                                                                 $nnnn
  242 00000000         _type   SETA             _ABS
  243 00000000                 ldrb             addy,[m6502_pc],#1
  244 00000000                 ldrb             r0,[m6502_pc],#1
  245 00000000                 orr              addy,addy,r0,lsl#8
  246 00000000                 MEND
  247 00000000         
  248 00000000                 MACRO
  249 00000000                 doAIX                        ;absolute indexed X
                                                                 $nnnn,X
  250 00000000         _type   SETA             _ABS
  251 00000000                 ldrb             addy,[m6502_pc],#1
  252 00000000                 ldrb             r0,[m6502_pc],#1
  253 00000000                 orr              addy,addy,r0,lsl#8
  254 00000000                 add              addy,addy,m6502_x,lsr#24
  255 00000000         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  256 00000000                 MEND
  257 00000000         
  258 00000000                 MACRO
  259 00000000                 doAIY                        ;absolute indexed Y
                                                                 $nnnn,Y
  260 00000000         _type   SETA             _ABS
  261 00000000                 ldrb             addy,[m6502_pc],#1
  262 00000000                 ldrb             r0,[m6502_pc],#1
  263 00000000                 orr              addy,addy,r0,lsl#8
  264 00000000                 add              addy,addy,m6502_y,lsr#24
  265 00000000         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
  266 00000000                 MEND
  267 00000000         



ARM Macro Assembler    Page 8 


  268 00000000                 MACRO
  269 00000000                 doIMM                        ;immediate         
                                                                 #$nn
  270 00000000         _type   SETA             _IMM
  271 00000000                 MEND
  272 00000000         
  273 00000000                 MACRO
  274 00000000                 doIIX                        ;indexed indirect X
                                                                 ($nn,X)
  275 00000000         _type   SETA             _ABS
  276 00000000                 ldrb             r0,[m6502_pc],#1
  277 00000000                 add              r0,m6502_x,r0,lsl#24
  278 00000000         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  279 00000000                 lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  280 00000000                 ldrb             addy,[cpu_zpage,addy]
  281 00000000         
  282 00000000                 add              r0,r0,#0x01000000
  283 00000000         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  284 00000000                 lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  285 00000000                 ldrb             r1,[cpu_zpage,r1]
  286 00000000         
  287 00000000                 orr              addy,addy,r1,lsl#8
  288 00000000                 MEND
  289 00000000         
  290 00000000                 MACRO
  291 00000000                 doIIY                        ;indirect indexed Y
                                                                 ($nn),Y
  292 00000000         _type   SETA             _ABS
  293 00000000                 ldrb             r0,[m6502_pc],#1
  294 00000000         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  295 00000000         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  296 00000000                 ldrb             addy,[r0,cpu_zpage]
  297 00000000                 add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  298 00000000         
  299 00000000         
  300 00000000                 ldrb             r1,[r0,#1]
  301 00000000                 orr              addy,addy,r1,lsl#8
  302 00000000                 add              addy,addy,m6502_y,lsr#24
  303 00000000         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
  304 00000000                 MEND
  305 00000000         
  306 00000000                 MACRO
  307 00000000                 doZPI                        ;Zeropage indirect 
                                                                ($nn)
  308 00000000         _type   SETA             _ABS
  309 00000000                 ldrb             r0,[m6502_pc],#1
  310 00000000         ;// ldrb addy,[r0,cpu_zpage]!;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼Ó
                       µ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  311 00000000         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  312 00000000                 ldrb             addy,[r0,cpu_zpage]
  313 00000000                 add              r0,r0,cpu_zpage
  314 00000000         
  315 00000000         



ARM Macro Assembler    Page 9 


  316 00000000                 ldrb             r1,[r0,#1]
  317 00000000                 orr              addy,addy,r1,lsl#8
  318 00000000                 MEND
  319 00000000         
  320 00000000                 MACRO
  321 00000000                 doZ                          ;zero page         
                                                                 $nn
  322 00000000         _type   SETA             _ZP
  323 00000000                 ldrb             addy,[m6502_pc],#1
  324 00000000                 MEND
  325 00000000         
  326 00000000                 MACRO
  327 00000000                 doZ2                         ;zero page         
                                                                 $nn
  328 00000000         _type   SETA             _ZP
  329 00000000                 ldrb             addy,[m6502_pc],#2 ;ugly thing 
                                                            for bbr/bbs
  330 00000000                 MEND
  331 00000000         
  332 00000000                 MACRO
  333 00000000                 doZIX                        ;zero page indexed 
                                                            X    $nn,X
  334 00000000         _type   SETA             _ZP
  335 00000000                 ldrb             addy,[m6502_pc],#1
  336 00000000                 add              addy,addy,m6502_x,lsr#24
  337 00000000                 and              addy,addy,#0xff 
                                                            ;Rygar needs this
  338 00000000                 MEND
  339 00000000         
  340 00000000                 MACRO
  341 00000000                 doZIXf                       ;zero page indexed 
                                                            X    $nn,X
  342 00000000         _type   SETA             _ZPI
  343 00000000                 ldrb             addy,[m6502_pc],#1
  344 00000000                 add              addy,m6502_x,addy,lsl#24
  345 00000000                 MEND
  346 00000000         
  347 00000000                 MACRO
  348 00000000                 doZIY                        ;zero page indexed 
                                                            Y    $nn,Y
  349 00000000         _type   SETA             _ZP
  350 00000000                 ldrb             addy,[m6502_pc],#1
  351 00000000                 add              addy,addy,m6502_y,lsr#24
  352 00000000                 and              addy,addy,#0xff
  353 00000000                 MEND
  354 00000000         
  355 00000000                 MACRO
  356 00000000                 doZIYf                       ;zero page indexed 
                                                            Y    $nn,Y
  357 00000000         _type   SETA             _ZPI
  358 00000000                 ldrb             addy,[m6502_pc],#1
  359 00000000                 add              addy,m6502_y,addy,lsl#24
  360 00000000                 MEND
  361 00000000         
  362 00000000         ;-------------------------------------------------------
                       ---------------------
  363 00000000         
  364 00000000                 MACRO
  365 00000000                 opADC



ARM Macro Assembler    Page 10 


  366 00000000                 readmem
  367 00000000                 movs             r1,cycles,lsr#1 ;get C
  368 00000000                 subcs            r0,r0,#0x00000100
  369 00000000                 adcs             m6502_a,m6502_a,r0,ror#8
  370 00000000                 mov              m6502_nz,m6502_a,asr#24 ;NZ
  371 00000000                 orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  372 00000000                 bicvc            cycles,cycles,#CYC_V ;V
  373 00000000                 MEND
  374 00000000         
  375 00000000                 MACRO
  376 00000000                 opAND
  377 00000000                 readmem
  378 00000000                 and              m6502_a,m6502_a,r0,lsl#24
  379 00000000                 mov              m6502_nz,m6502_a,asr#24 ;NZ
  380 00000000                 MEND
  381 00000000         
  382 00000000                 MACRO
  383 00000000                 opASL
  384 00000000                 readmem
  385 00000000                 add              r0,r0,r0
  386 00000000                 orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  387 00000000                 orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  388 00000000                 writemem
  389 00000000                 MEND
  390 00000000         
  391 00000000                 MACRO
  392 00000000                 opBIT
  393 00000000                 readmem
  394 00000000                 bic              cycles,cycles,#CYC_V ;reset V
  395 00000000                 tst              r0,#V
  396 00000000                 orrne            cycles,cycles,#CYC_V ;V
  397 00000000                 and              m6502_nz,r0,m6502_a,lsr#24 ;Z
  398 00000000                 orr              m6502_nz,m6502_nz,r0,lsl#24 ;N
  399 00000000                 MEND
  400 00000000         
  401 00000000                 MACRO
  402 00000000                 opCOMP           $x          ;A,X & Y
  403 00000000                 readmem
  404 00000000                 subs             m6502_nz,$x,r0,lsl#24
  405 00000000                 mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 00000000                 orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  407 00000000                 MEND
  408 00000000         
  409 00000000                 MACRO
  410 00000000                 opDEC
  411 00000000                 readmem
  412 00000000                 sub              r0,r0,#1
  413 00000000                 orr              m6502_nz,r0,r0,lsl#24 ;NZ
  414 00000000                 writemem
  415 00000000                 MEND
  416 00000000         
  417 00000000                 MACRO
  418 00000000                 opEOR
  419 00000000                 readmem
  420 00000000                 eor              m6502_a,m6502_a,r0,lsl#24
  421 00000000                 mov              m6502_nz,m6502_a,asr#24 ;NZ



ARM Macro Assembler    Page 11 


  422 00000000                 MEND
  423 00000000         
  424 00000000                 MACRO
  425 00000000                 opINC
  426 00000000                 readmem
  427 00000000                 add              r0,r0,#1
  428 00000000                 orr              m6502_nz,r0,r0,lsl#24 ;NZ
  429 00000000                 writemem
  430 00000000                 MEND
  431 00000000         
  432 00000000                 MACRO
  433 00000000                 opLOAD           $x
  434 00000000                 readmems
  435 00000000                 mov              $x,m6502_nz,lsl#24
  436 00000000                 MEND
  437 00000000         
  438 00000000                 MACRO
  439 00000000                 opLSR
  440 00000000                 [                _type = _ABS
  441 00000000                 readmemabs
  442 00000000                 movs             r0,r0,lsr#1
  443 00000000                 orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  444 00000000                 mov              m6502_nz,r0 ;Z, (N=0)
  445 00000000                 writememabs
  446 00000000                 ]
  447 00000000                 [                _type = _ZP
  448 00000000                 ldrb             m6502_nz,[cpu_zpage,addy]
  449 00000000                 movs             m6502_nz,m6502_nz,lsr#1 
                                                            ;Z, (N=0)
  450 00000000                 orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  451 00000000                 strb             m6502_nz,[cpu_zpage,addy]
  452 00000000                 ]
  453 00000000                 [                _type = _ZPI
  454 00000000         ;//  ldrb m6502_nz,[cpu_zpage,addy,lsr#24]
  455 00000000                 lsr              m6502_nz,addy,#24 
                                                            ;//¸Ä¹ý£¬¼Ó2ÐÐ
  456 00000000                 ldrb             m6502_nz,[cpu_zpage,m6502_nz]
  457 00000000         
  458 00000000                 movs             m6502_nz,m6502_nz,lsr#1 
                                                            ;Z, (N=0)
  459 00000000                 orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  460 00000000         ;//  strb m6502_nz,[cpu_zpage,addy,lsr#24]
  461 00000000                 lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ
  462 00000000                 strb             m6502_nz,[cpu_zpage,r1]
  463 00000000         
  464 00000000                 ]
  465 00000000                 MEND
  466 00000000         
  467 00000000                 MACRO
  468 00000000                 opORA
  469 00000000                 readmem
  470 00000000                 orr              m6502_a,m6502_a,r0,lsl#24
  471 00000000                 mov              m6502_nz,m6502_a,asr#24
  472 00000000                 MEND
  473 00000000         
  474 00000000                 MACRO



ARM Macro Assembler    Page 12 


  475 00000000                 opROL
  476 00000000                 readmem
  477 00000000                 movs             cycles,cycles,lsr#1 ;get C
  478 00000000                 adc              r0,r0,r0
  479 00000000                 orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  480 00000000                 adc              cycles,cycles,cycles ;Set C
  481 00000000                 writemem
  482 00000000                 MEND
  483 00000000         
  484 00000000                 MACRO
  485 00000000                 opROR
  486 00000000                 readmem
  487 00000000                 movs             cycles,cycles,lsr#1 ;get C
  488 00000000                 orrcs            r0,r0,#0x100
  489 00000000                 movs             r0,r0,lsr#1
  490 00000000                 orr              m6502_nz,r0,r0,lsl#24 ;NZ
  491 00000000                 adc              cycles,cycles,cycles ;Set C
  492 00000000                 writemem
  493 00000000                 MEND
  494 00000000         
  495 00000000                 MACRO
  496 00000000                 opSBC
  497 00000000                 readmem
  498 00000000                 movs             r1,cycles,lsr#1 ;get C
  499 00000000                 sbcs             m6502_a,m6502_a,r0,lsl#24
  500 00000000                 and              m6502_a,m6502_a,#0xff000000
  501 00000000                 mov              m6502_nz,m6502_a,asr#24 ;NZ
  502 00000000                 orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  503 00000000                 bicvc            cycles,cycles,#CYC_V ;V
  504 00000000                 MEND
  505 00000000         
  506 00000000                 MACRO
  507 00000000                 opSTORE          $x
  508 00000000                 mov              r0,$x,lsr#24
  509 00000000                 writemem
  510 00000000                 MEND
  511 00000000         ;----------------------------------------------------
  512 00000000                 END
    4 00000000         
    5 00000000                 IMPORT           NES_RAM     ;nes_main.c   __ali
                                                            gn(1024) uint8 NES_
                                                            RAM[0x800];//±£³Ö10
                                                            24×Ö½Ú¶ÔÆë
    6 00000000                 IMPORT           NES_SRAM    ;nes_main.c   uint8
                                                             NES_SRAM[0x2000]; 
                                                            
    7 00000000                 IMPORT           spr_ram     ;             uint8
                                                             spr_ram[0x100];
    8 00000000         
    9 00000000                 EXPORT           cpunmi      ;cpuÖÐ¶Ï±êÖ¾
   10 00000000                 EXPORT           cpuirq      ;cpuÖÐ¶Ï±êÖ¾ 
   11 00000000                 EXPORT           clocks      ;apuÒªµÄcpuÊ±ÖÓ
   12 00000000                 EXPORT           cpu_data    ;µØÖ· cart.s
   13 00000000                 EXPORT           NMI6502
   14 00000000                 EXPORT           CPU_reset
   15 00000000                 EXPORT           run6502
   16 00000000                 EXPORT           op_table
   17 00000000         



ARM Macro Assembler    Page 13 


   18 00000000 0000FFFE 
                       IRQ_VECTOR
                               EQU              0xfffe      ; //IRQ / BRKÖÐ¶ÏÏò
                                                            Á¿µØÖ·
   19 00000000 0000FFFC 
                       RES_VECTOR
                               EQU              0xfffc      ;// ¸´Î»ÖÐ¶ÏÏòÁ¿µØÖ
                                                            ·
   20 00000000 0000FFFA 
                       NMI_VECTOR
                               EQU              0xfffa      ;// NMIÖÐ¶ÏÏòÁ¿µØÖ·
                                                            
   21 00000000         
   22 00000000         ;cycle flags- (stored in cycles reg for speed)´æ´¢ÔÚÖÜÆÚ
                       ÕÂËÙ¶È
   23 00000000         
   24 00000000 00000001 
                       CYC_C   EQU              0x01        ;Carry bit ½øÎ»
   25 00000000         ;BRANCH   EQU 0x02 ;branch instruction encountered Óöµ½·
                       ÖÖ§Ö¸Áî
   26 00000000 00000004 
                       CYC_I   EQU              0x04        ;IRQ mask
   27 00000000 00000008 
                       CYC_D   EQU              0x08        ;Decimal bit Ð¡ÊýÎ»
                                                            
   28 00000000 00000040 
                       CYC_V   EQU              0x40        ;Overflow bit  Òç³ö
                                                            Î»
   29 00000000         ;CYC_MASK  EQU 0xFF;CYCLE-1 ;Mask
   30 00000000         
   31 00000000                 AREA             cpu_code, CODE, READONLY 
                                                            ;, ALIGN=2
   32 00000000         ; ²»Òª¶Ô ARM ´úÂë½ÚÊ¹ÓÃ ALIGN=0 »ò ALIGN=1¡£
   33 00000000         ;    ²»Òª¶Ô Thumb ´úÂë½ÚÊ¹ÓÃ ALIGN=0¡£
   34 00000000         ;AREA  Î±´úÂëÒ²ÊÇÐèÒªÓï·¨µÄ£¬AREA  ºóÃæ¸ú×Å¶ÎÃû±êºÅ£¬È»º
                       óÊÇÊôÐÔ£¬CODE ±íÊ¾ÕâÊÇÒ» 
   35 00000000         ;¸ö´úÂë¶Î£¬READONLY ±íÊ¾Õâ¸ö¶ÎÊÇÖ»¶ÁµÄ
   36 00000000         ;|.text|ÏµÍ³Ä¬ÈÏµÄ´úÂë¶ÎÃû  
   37 00000000         ; ALIGN Ö¸ÁîÍ¨¹ýÓÃÁã»ò NOP Ö¸Áî½øÐÐÌî³ä½«µ±Ç°Î»ÖÃ¶ÔÆëµ½Ö
                       ¸¶¨±ß½ç
   38 00000000         ;ENTRY  Õâ¸öÎ±´úÂëÊÇÓÃÀ´¶¨ÒåÈë¿Úµã
   39 00000000                 THUMB                        ;ThumbÊÇARMÌåÏµ½á¹¹
                                                            ÖÐÒ»ÖÖ16Î»µÄÖ¸Áî¼¯
   40 00000000         ; REQUIRE8  ;REQUIRE8 Ö¸ÁîÖ¸¶¨µ±Ç°ÎÄ¼þÒªÇó¶ÑÕ»°Ë×Ö½Ú¶ÔÆë
                       ¡£ ËüÉèÖÃ REQ8 ±àÒëÊôÐÔÒÔÍ¨ÖªÁ´½ÓÆ÷¡£
   41 00000000                 PRESERVE8                    ;{TRUE} ;PRESERVE8 
                                                            Ö¸ÁîÖ¸¶¨µ±Ç°ÎÄ¼þ±£³
                                                            Ö¶ÑÕ»°Ë×Ö½Ú¶ÔÆë¡£ Ë
                                                            üÉèÖÃ PRES8 ±àÒëÊôÐ
                                                            ÔÒÔÍ¨ÖªÁ´½ÓÆ÷¡£
   42 00000000         ;Èç¹ûÄúÊ¡ÂÔ PRESERVE8 ºÍ PRESERVE8 {FALSE}£¬»ã±à³ÌÐò»á¼ì
                       ²éÐÞ¸Ä sp µÄÖ¸Áî£¬
   43 00000000         ;ÒÔ¾ö¶¨ÊÇ·ñÉèÖÃ PRES8 ±àÒëÊôÐÔ¡£ ARM ½¨ÒéÃ÷È·Ö¸¶¨ PRESER
                       VE8¡£
   44 00000000         ; ARMÊ¹ÓÃr0×÷Îª·µ»ØÖµ
   45 00000000         ;²ÎÊý´«µÝARM£º¼Ä´æÆ÷µ½¶ÑÕ»£¬Ê×ÏÈ½«²ÎÊý¸³¸ør0, r1µÈ
   46 00000000         
   47 00000000         ;  PROC Îª×Ó³ÌÐò¿ªÊ¼£¬ENDP Îª×Ó³ÌÐò½áÊø
   48 00000000         



ARM Macro Assembler    Page 14 


   49 00000000         
   50 00000000         ;r0,r1,r2=temp regs   
   51 00000000        3 
                       m6502_nz
                               RN               r3          ;bit 31=N, Z=1 if b
                                                            its 0-7=0    ;RN¶¨Ò
                                                            å¼Ä´æÆ÷Ãû
   52 00000000        4 
                       m6502_rmem
                               RN               r4          ;readmem_tbl
   53 00000000        5 
                       m6502_a RN               r5          ;//bits 0-23=0, »¹Ó
                                                            ÃÓÚÇå³ýÔÚÄÚ´æÖÐµÄ×Ö
                                                            ½Ú
   54 00000000        6 
                       m6502_x RN               r6          ;bits 0-23=0
   55 00000000        7 
                       m6502_y RN               r7          ;bits 0-23=0
   56 00000000        8 
                       cycles  RN               r8          ;//also VDIC flagsÒ
                                                            ²VDIC±êÖ¾
   57 00000000        9 
                       m6502_pc
                               RN               r9
   58 00000000        A 
                       globalptr
                               RN               r10         ;=wram_globals* ptr
                                                            
   59 00000000        A 
                       m6502_optbl
                               RN               r10
   60 00000000        B 
                       cpu_zpage
                               RN               r11         ;=CPU_RAM
   61 00000000        C 
                       addy    RN               r12         ;//keep this at r12
                                                             (´ÓÍ· APCS) //addr
                                                              :´ú±í8Î»µØÖ· 
   62 00000000         ;r13=SP
   63 00000000         ;r14=LR
   64 00000000         ;r15=PC
   65 00000000         ;---------------------------------------------------
   66 00000000         
   67 00000000         
   68 00000000         _00                                  ;   BRK
   69 00000000         ;-------------------------------------------------------
                       ---------------------
   70 00000000         
   71 00000000 F8DA 0084       ldr              r0,lastbank ;   6502PC´Ó ROMµÄ×
                                                            îºóÆ«ÒÆÁ¿
   72 00000004 EBA9 0100       sub              r1,m6502_pc,r0
   73 00000008 F101 0001       add              r0,r1,#1
   74 0000000C                 push16                       ;save PC
  193 0000000C EA4F 2110       mov              r1,r0,lsr#8
  194 00000010 F8DA 2080       ldr              r2,m6502_s
  195 00000014 F802 1901       strb             r1,[r2],#-1
  196 00000018 F442 7280       orr              r2,r2,#0x100
  197 0000001C F802 0901       strb             r0,[r2],#-1
  198 00000020 F88A 2080       strb             r2,m6502_s



ARM Macro Assembler    Page 15 


   75 00000024         
   76 00000024                 encodeP          (B+R)       ;save P
   27 00000024 F008 004D       and              r0,cycles,#CYC_V+CYC_D+CYC_I+CY
C_C
   28 00000028 F013 4F00       tst              m6502_nz,#0x80000000 ;//PSR_N
   29 0000002C BF18 F040 
              0080             orrne            r0,r0,#N    ;N
   30 00000032 F013 0FFF       tst              m6502_nz,#0xff
   31 00000036 BF08 F040 
              0002             orreq            r0,r0,#Z    ;Z
   32 0000003C F040 0030       orr              r0,r0,#(B+R) ;R(&B)
   77 00000040         
   78 00000040 F64F 7CFE       ldr              r12,=IRQ_VECTOR
   79 00000044 F7FF FFFE       bl               VecCont
   80 00000048         
   81 00000048                 fetch            7
   46 00000048         ;//-----------------------------------------------------
                       ----------------
   47 00000048 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000004C F100 0007       add              r0,r0,#7
   49 00000050 F8CA 00A0       str              r0,clocksh
   50 00000054         
   51 00000054 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000058         ;//-----------------------------------------------------
                       --------------------
   53 00000058 F5B8 68E0       subs             cycles,cycles,#7*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000005C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000062         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000062 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000066 F8DA F088       ldr              pc,nexttimeout
   82 0000006A                 LTORG                        ;Ö¸Áî£¬ LTORG¿ÉÄÜÊÇ
                                                            ÔÚÒ»¸ö¿ÉÖ´ÐÐµÄÎ»ÖÃ
   83 0000006A         ;-------------------------------------------------------
                       ---------------------
   84 0000006A         _01                                  ;   ORA ($nn,X)
   85 0000006A         ;-------------------------------------------------------
                       ---------------------
   86 0000006A                 doIIX
  275 0000006A 00000004 
                       _type   SETA             _ABS
  276 0000006A F819 0B01       ldrb             r0,[m6502_pc],#1
  277 0000006E EB06 6000       add              r0,m6502_x,r0,lsl#24
  278 00000072         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  279 00000072 EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  280 00000076 F81B C00C       ldrb             addy,[cpu_zpage,addy]
  281 0000007A         
  282 0000007A F100 7080       add              r0,r0,#0x01000000
  283 0000007E         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ



ARM Macro Assembler    Page 16 


                       ÝÓÒÒÆ2Î»
  284 0000007E EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  285 00000082 F81B 1001       ldrb             r1,[cpu_zpage,r1]
  286 00000086         
  287 00000086 EA4C 2C01       orr              addy,addy,r1,lsl#8
   87 0000008A                 opORA
  469 0000008A                 readmem
  122 0000008A                 [                _type = _ABS
  123 0000008A                 readmemabs
   83 0000008A F40C 4160       and              r1,addy,#0xE000
   84 0000008E F20F 0E0A       adr              lr,%F0
   85 00000092         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00000092 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00000096 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 0000009A         
   89 0000009A         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 0000009A                 ]
  125 0000009A                 [                _type = _ZP
  127                          ]
  128 0000009A                 [                _type = _ZPI
  130                          ]
  131 0000009A                 [                _type = _IMM
  133                          ]
  470 0000009A EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  471 0000009E EA4F 6325       mov              m6502_nz,m6502_a,asr#24
   88 000000A2                 fetch            6
   46 000000A2         ;//-----------------------------------------------------
                       ----------------
   47 000000A2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000000A6 F100 0006       add              r0,r0,#6
   49 000000AA F8CA 00A0       str              r0,clocksh
   50 000000AE         
   51 000000AE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000000B2         ;//-----------------------------------------------------
                       --------------------
   53 000000B2 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000000B6 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000000BC         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000000BC F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000000C0 F8DA F088       ldr              pc,nexttimeout
   89 000000C4         ;-------------------------------------------------------
                       ---------------------
   90 000000C4         _05                                  ;   ORA $nn
   91 000000C4         ;-------------------------------------------------------



ARM Macro Assembler    Page 17 


                       ---------------------
   92 000000C4                 doZ
  322 000000C4 00000002 
                       _type   SETA             _ZP
  323 000000C4 F819 CB01       ldrb             addy,[m6502_pc],#1
   93 000000C8                 opORA
  469 000000C8                 readmem
  122 000000C8                 [                _type = _ABS
  124                          ]
  125 000000C8                 [                _type = _ZP
  126 000000C8                 readmemzp
   94 000000C8 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  127 000000CC                 ]
  128 000000CC                 [                _type = _ZPI
  130                          ]
  131 000000CC                 [                _type = _IMM
  133                          ]
  470 000000CC EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  471 000000D0 EA4F 6325       mov              m6502_nz,m6502_a,asr#24
   94 000000D4                 fetch            3
   46 000000D4         ;//-----------------------------------------------------
                       ----------------
   47 000000D4 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000000D8 F100 0003       add              r0,r0,#3
   49 000000DC F8CA 00A0       str              r0,clocksh
   50 000000E0         
   51 000000E0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000000E4         ;//-----------------------------------------------------
                       --------------------
   53 000000E4 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000000E8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000000EE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000000EE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000000F2 F8DA F088       ldr              pc,nexttimeout
   95 000000F6         ;-------------------------------------------------------
                       ---------------------
   96 000000F6         _06                                  ;   ASL $nn
   97 000000F6         ;-------------------------------------------------------
                       ---------------------
   98 000000F6                 doZ
  322 000000F6 00000002 
                       _type   SETA             _ZP
  323 000000F6 F819 CB01       ldrb             addy,[m6502_pc],#1
   99 000000FA                 opASL
  384 000000FA                 readmem
  122 000000FA                 [                _type = _ABS
  124                          ]
  125 000000FA                 [                _type = _ZP
  126 000000FA                 readmemzp
   94 000000FA F81B 000C       ldrb             r0,[cpu_zpage,addy]



ARM Macro Assembler    Page 18 


  127 000000FE                 ]
  128 000000FE                 [                _type = _ZPI
  130                          ]
  131 000000FE                 [                _type = _IMM
  133                          ]
  385 000000FE 4400            add              r0,r0,r0
  386 00000100 EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  387 00000104 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  388 00000108                 writemem
  179 00000108                 [                _type = _ABS
  181                          ]
  182 00000108                 [                _type = _ZP
  183 00000108                 writememzp
  165 00000108 F80B 000C       strb             r0,[cpu_zpage,addy]
  184 0000010C                 ]
  185 0000010C                 [                _type = _ZPI
  187                          ]
  100 0000010C                 fetch_c          5
   62 0000010C         ;//-----------------------------------------------------
                       ----------------
   63 0000010C F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00000110 F100 0005       add              r0,r0,#5
   65 00000114 F8CA 00A0       str              r0,clocksh
   66 00000118         
   67 00000118 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 0000011C         ;//-----------------------------------------------------
                       --------------------
   69 0000011C F578 68A0       sbcs             cycles,cycles,#5*256 
                                                            ;//CYCLE=256
   70 00000120 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00000126         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00000126 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 0000012A F8DA F088       ldr              pc,nexttimeout
  101 0000012E         ;-------------------------------------------------------
                       ---------------------
  102 0000012E         _08                                  ;   PHP
  103 0000012E         ;-------------------------------------------------------
                       ---------------------
  104 0000012E                 encodeP          (B+R)
   27 0000012E F008 004D       and              r0,cycles,#CYC_V+CYC_D+CYC_I+CY
C_C
   28 00000132 F013 4F00       tst              m6502_nz,#0x80000000 ;//PSR_N
   29 00000136 BF18 F040 
              0080             orrne            r0,r0,#N    ;N
   30 0000013C F013 0FFF       tst              m6502_nz,#0xff
   31 00000140 BF08 F040 
              0002             orreq            r0,r0,#Z    ;Z
   32 00000146 F040 0030       orr              r0,r0,#(B+R) ;R(&B)
  105 0000014A                 push8            r0
  203 0000014A F8DA 2080       ldr              r2,m6502_s
  204 0000014E F802 0901       strb             r0,[r2],#-1
  205 00000152 F88A 2080       strb             r2,m6502_s
  106 00000156                 fetch            3
   46 00000156         ;//-----------------------------------------------------
                       ----------------



ARM Macro Assembler    Page 19 


   47 00000156 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000015A F100 0003       add              r0,r0,#3
   49 0000015E F8CA 00A0       str              r0,clocksh
   50 00000162         
   51 00000162 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000166         ;//-----------------------------------------------------
                       --------------------
   53 00000166 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000016A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000170         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000170 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000174 F8DA F088       ldr              pc,nexttimeout
  107 00000178         ;-------------------------------------------------------
                       ---------------------
  108 00000178         _09                                  ;   ORA #$nn
  109 00000178         ;-------------------------------------------------------
                       ---------------------
  110 00000178                 doIMM
  270 00000178 00000001 
                       _type   SETA             _IMM
  111 00000178                 opORA
  469 00000178                 readmem
  122 00000178                 [                _type = _ABS
  124                          ]
  125 00000178                 [                _type = _ZP
  127                          ]
  128 00000178                 [                _type = _ZPI
  130                          ]
  131 00000178                 [                _type = _IMM
  132 00000178                 readmemimm
  112 00000178 F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  133 0000017C                 ]
  470 0000017C EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  471 00000180 EA4F 6325       mov              m6502_nz,m6502_a,asr#24
  112 00000184                 fetch            2
   46 00000184         ;//-----------------------------------------------------
                       ----------------
   47 00000184 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000188 F100 0002       add              r0,r0,#2
   49 0000018C F8CA 00A0       str              r0,clocksh
   50 00000190         
   51 00000190 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000194         ;//-----------------------------------------------------
                       --------------------
   53 00000194 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000198 BF5C F819 



ARM Macro Assembler    Page 20 


              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000019E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000019E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000001A2 F8DA F088       ldr              pc,nexttimeout
  113 000001A6         ;-------------------------------------------------------
                       ---------------------
  114 000001A6         _0A                                  ;   ASL
  115 000001A6         ;-------------------------------------------------------
                       ---------------------
  116 000001A6 196D            adds             m6502_a,m6502_a,m6502_a
  117 000001A8 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  118 000001AC F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  119 000001B0                 fetch_c          2           ;also subs carry
   62 000001B0         ;//-----------------------------------------------------
                       ----------------
   63 000001B0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 000001B4 F100 0002       add              r0,r0,#2
   65 000001B8 F8CA 00A0       str              r0,clocksh
   66 000001BC         
   67 000001BC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 000001C0         ;//-----------------------------------------------------
                       --------------------
   69 000001C0 F578 7800       sbcs             cycles,cycles,#2*256 
                                                            ;//CYCLE=256
   70 000001C4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 000001CA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 000001CA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 000001CE F8DA F088       ldr              pc,nexttimeout
  120 000001D2         ;-------------------------------------------------------
                       ---------------------
  121 000001D2         _0D                                  ;   ORA $nnnn
  122 000001D2         ;-------------------------------------------------------
                       ---------------------
  123 000001D2                 doABS
  242 000001D2 00000004 
                       _type   SETA             _ABS
  243 000001D2 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 000001D6 F819 0B01       ldrb             r0,[m6502_pc],#1
  245 000001DA EA4C 2C00       orr              addy,addy,r0,lsl#8
  124 000001DE                 opORA
  469 000001DE                 readmem
  122 000001DE                 [                _type = _ABS
  123 000001DE                 readmemabs
   83 000001DE F40C 4160       and              r1,addy,#0xE000
   84 000001E2 F20F 0E0A       adr              lr,%F0
   85 000001E6         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000001E6 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 000001EA F854 F001       ldr              pc,[m6502_rmem,r1]
   88 000001EE         



ARM Macro Assembler    Page 21 


   89 000001EE         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 000001EE                 ]
  125 000001EE                 [                _type = _ZP
  127                          ]
  128 000001EE                 [                _type = _ZPI
  130                          ]
  131 000001EE                 [                _type = _IMM
  133                          ]
  470 000001EE EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  471 000001F2 EA4F 6325       mov              m6502_nz,m6502_a,asr#24
  125 000001F6                 fetch            4
   46 000001F6         ;//-----------------------------------------------------
                       ----------------
   47 000001F6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000001FA F100 0004       add              r0,r0,#4
   49 000001FE F8CA 00A0       str              r0,clocksh
   50 00000202         
   51 00000202 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000206         ;//-----------------------------------------------------
                       --------------------
   53 00000206 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000020A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000210         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000210 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000214 F8DA F088       ldr              pc,nexttimeout
  126 00000218         ;-------------------------------------------------------
                       ---------------------
  127 00000218         _0E                                  ;   ASL $nnnn
  128 00000218         ;-------------------------------------------------------
                       ---------------------
  129 00000218                 doABS
  242 00000218 00000004 
                       _type   SETA             _ABS
  243 00000218 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 0000021C F819 0B01       ldrb             r0,[m6502_pc],#1
  245 00000220 EA4C 2C00       orr              addy,addy,r0,lsl#8
  130 00000224                 opASL
  384 00000224                 readmem
  122 00000224                 [                _type = _ABS
  123 00000224                 readmemabs
   83 00000224 F40C 4160       and              r1,addy,#0xE000
   84 00000228 F20F 0E08       adr              lr,%F0
   85 0000022C         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 0000022C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1



ARM Macro Assembler    Page 22 


   87 00000230 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00000234         
   89 00000234         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00000234                 ]
  125 00000234                 [                _type = _ZP
  127                          ]
  128 00000234                 [                _type = _ZPI
  130                          ]
  131 00000234                 [                _type = _IMM
  133                          ]
  385 00000234 4400            add              r0,r0,r0
  386 00000236 EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  387 0000023A F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  388 0000023E                 writemem
  179 0000023E                 [                _type = _ABS
  180 0000023E                 writememabs
  153 0000023E F40C 4160       and              r1,addy,#0xe000
  154 00000242 F10A 0224       adr              r2,writemem_tbl
  155 00000246 F20F 0E0A       adr              lr,%F0
  156 0000024A         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 0000024A EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 0000024E F852 F001       ldr              pc,[r2,r1]
  159 00000252         
  160 00000252         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 00000252                 ]
  182 00000252                 [                _type = _ZP
  184                          ]
  185 00000252                 [                _type = _ZPI
  187                          ]
  131 00000252                 fetch_c          6
   62 00000252         ;//-----------------------------------------------------
                       ----------------
   63 00000252 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00000256 F100 0006       add              r0,r0,#6
   65 0000025A F8CA 00A0       str              r0,clocksh
   66 0000025E         
   67 0000025E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00000262         ;//-----------------------------------------------------
                       --------------------
   69 00000262 F578 68C0       sbcs             cycles,cycles,#6*256 
                                                            ;//CYCLE=256
   70 00000266 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 0000026C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 0000026C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00000270 F8DA F088       ldr              pc,nexttimeout
  132 00000274         ;-------------------------------------------------------
                       ---------------------  
  133 00000274         _10                                  ;   BPL *



ARM Macro Assembler    Page 23 


  134 00000274         ;-------------------------------------------------------
                       ---------------------
  135 00000274 F013 4F00       tst              m6502_nz,#0x80000000
  136 00000278 F919 0B01       ldrsb            r0,[m6502_pc],#1
  137 0000027C BF04 4481       addeq            m6502_pc,m6502_pc,r0
  138 00000280         ; subeq cycles,cycles,#3*CYCLE
  139 00000280 F5A8 7880       subeq            cycles,cycles,#256
  140 00000284                 fetch            2
   46 00000284         ;//-----------------------------------------------------
                       ----------------
   47 00000284 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000288 F100 0002       add              r0,r0,#2
   49 0000028C F8CA 00A0       str              r0,clocksh
   50 00000290         
   51 00000290 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000294         ;//-----------------------------------------------------
                       --------------------
   53 00000294 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000298 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000029E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000029E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000002A2 F8DA F088       ldr              pc,nexttimeout
  141 000002A6         ;-------------------------------------------------------
                       ---------------------
  142 000002A6         _11                                  ;   ORA ($nn),Y
  143 000002A6         ;-------------------------------------------------------
                       ---------------------
  144 000002A6                 doIIY
  292 000002A6 00000004 
                       _type   SETA             _ABS
  293 000002A6 F819 0B01       ldrb             r0,[m6502_pc],#1
  294 000002AA         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  295 000002AA         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  296 000002AA F810 C00B       ldrb             addy,[r0,cpu_zpage]
  297 000002AE 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  298 000002B0         
  299 000002B0         
  300 000002B0 7841            ldrb             r1,[r0,#1]
  301 000002B2 EA4C 2C01       orr              addy,addy,r1,lsl#8
  302 000002B6 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  303 000002BA         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
  145 000002BA                 opORA
  469 000002BA                 readmem
  122 000002BA                 [                _type = _ABS
  123 000002BA                 readmemabs
   83 000002BA F40C 4160       and              r1,addy,#0xE000
   84 000002BE F20F 0E0A       adr              lr,%F0



ARM Macro Assembler    Page 24 


   85 000002C2         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000002C2 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 000002C6 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 000002CA         
   89 000002CA         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 000002CA                 ]
  125 000002CA                 [                _type = _ZP
  127                          ]
  128 000002CA                 [                _type = _ZPI
  130                          ]
  131 000002CA                 [                _type = _IMM
  133                          ]
  470 000002CA EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  471 000002CE EA4F 6325       mov              m6502_nz,m6502_a,asr#24
  146 000002D2                 fetch            5
   46 000002D2         ;//-----------------------------------------------------
                       ----------------
   47 000002D2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000002D6 F100 0005       add              r0,r0,#5
   49 000002DA F8CA 00A0       str              r0,clocksh
   50 000002DE         
   51 000002DE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000002E2         ;//-----------------------------------------------------
                       --------------------
   53 000002E2 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000002E6 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000002EC         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000002EC F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000002F0 F8DA F088       ldr              pc,nexttimeout
  147 000002F4         ;-------------------------------------------------------
                       ---------------------
  148 000002F4         _15                                  ;   ORA $nn,X
  149 000002F4         ;-------------------------------------------------------
                       ---------------------
  150 000002F4                 doZIXf
  342 000002F4 00000003 
                       _type   SETA             _ZPI
  343 000002F4 F819 CB01       ldrb             addy,[m6502_pc],#1
  344 000002F8 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  151 000002FC                 opORA
  469 000002FC                 readmem
  122 000002FC                 [                _type = _ABS
  124                          ]
  125 000002FC                 [                _type = _ZP



ARM Macro Assembler    Page 25 


  127                          ]
  128 000002FC                 [                _type = _ZPI
  129 000002FC                 readmemzpi
   99 000002FC         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  100 000002FC EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  101 00000300 F81B 0000       ldrb             r0,[cpu_zpage,r0]
  102 00000304         
  130 00000304                 ]
  131 00000304                 [                _type = _IMM
  133                          ]
  470 00000304 EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  471 00000308 EA4F 6325       mov              m6502_nz,m6502_a,asr#24
  152 0000030C                 fetch            4
   46 0000030C         ;//-----------------------------------------------------
                       ----------------
   47 0000030C F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000310 F100 0004       add              r0,r0,#4
   49 00000314 F8CA 00A0       str              r0,clocksh
   50 00000318         
   51 00000318 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000031C         ;//-----------------------------------------------------
                       --------------------
   53 0000031C F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000320 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000326         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000326 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000032A F8DA F088       ldr              pc,nexttimeout
  153 0000032E         ;-------------------------------------------------------
                       ---------------------
  154 0000032E         _16                                  ;   ASL $nn,X
  155 0000032E         ;-------------------------------------------------------
                       ---------------------
  156 0000032E                 doZIXf
  342 0000032E 00000003 
                       _type   SETA             _ZPI
  343 0000032E F819 CB01       ldrb             addy,[m6502_pc],#1
  344 00000332 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  157 00000336                 opASL
  384 00000336                 readmem
  122 00000336                 [                _type = _ABS
  124                          ]
  125 00000336                 [                _type = _ZP
  127                          ]
  128 00000336                 [                _type = _ZPI
  129 00000336                 readmemzpi
   99 00000336         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  100 00000336 EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  101 0000033A F81B 0000       ldrb             r0,[cpu_zpage,r0]
  102 0000033E         
  130 0000033E                 ]



ARM Macro Assembler    Page 26 


  131 0000033E                 [                _type = _IMM
  133                          ]
  385 0000033E 4400            add              r0,r0,r0
  386 00000340 EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  387 00000344 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  388 00000348                 writemem
  179 00000348                 [                _type = _ABS
  181                          ]
  182 00000348                 [                _type = _ZP
  184                          ]
  185 00000348                 [                _type = _ZPI
  186 00000348                 writememzpi
  170 00000348         ;// strb r0,[cpu_zpage,addy,lsr#24]
  171 00000348 EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  172 0000034C F80B 0001       strb             r0,[cpu_zpage,r1]
  173 00000350         
  174 00000350         
  187 00000350                 ]
  158 00000350                 fetch_c          6
   62 00000350         ;//-----------------------------------------------------
                       ----------------
   63 00000350 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00000354 F100 0006       add              r0,r0,#6
   65 00000358 F8CA 00A0       str              r0,clocksh
   66 0000035C         
   67 0000035C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00000360         ;//-----------------------------------------------------
                       --------------------
   69 00000360 F578 68C0       sbcs             cycles,cycles,#6*256 
                                                            ;//CYCLE=256
   70 00000364 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 0000036A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 0000036A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 0000036E F8DA F088       ldr              pc,nexttimeout
  159 00000372         ;-------------------------------------------------------
                       ---------------------
  160 00000372         _18                                  ;   CLC
  161 00000372         ;-------------------------------------------------------
                       ---------------------
  162 00000372 F028 0801       bic              cycles,cycles,#CYC_C
  163 00000376                 fetch            2
   46 00000376         ;//-----------------------------------------------------
                       ----------------
   47 00000376 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000037A F100 0002       add              r0,r0,#2
   49 0000037E F8CA 00A0       str              r0,clocksh
   50 00000382         
   51 00000382 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000386         ;//-----------------------------------------------------
                       --------------------
   53 00000386 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò



ARM Macro Assembler    Page 27 


                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000038A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000390         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000390 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000394 F8DA F088       ldr              pc,nexttimeout
  164 00000398         ;-------------------------------------------------------
                       ---------------------
  165 00000398         _19                                  ;   ORA $nnnn,Y
  166 00000398         ;-------------------------------------------------------
                       ---------------------
  167 00000398                 doAIY
  260 00000398 00000004 
                       _type   SETA             _ABS
  261 00000398 F819 CB01       ldrb             addy,[m6502_pc],#1
  262 0000039C F819 0B01       ldrb             r0,[m6502_pc],#1
  263 000003A0 EA4C 2C00       orr              addy,addy,r0,lsl#8
  264 000003A4 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  265 000003A8         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
  168 000003A8                 opORA
  469 000003A8                 readmem
  122 000003A8                 [                _type = _ABS
  123 000003A8                 readmemabs
   83 000003A8 F40C 4160       and              r1,addy,#0xE000
   84 000003AC F20F 0E08       adr              lr,%F0
   85 000003B0         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000003B0 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 000003B4 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 000003B8         
   89 000003B8         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 000003B8                 ]
  125 000003B8                 [                _type = _ZP
  127                          ]
  128 000003B8                 [                _type = _ZPI
  130                          ]
  131 000003B8                 [                _type = _IMM
  133                          ]
  470 000003B8 EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  471 000003BC EA4F 6325       mov              m6502_nz,m6502_a,asr#24
  169 000003C0                 fetch            4
   46 000003C0         ;//-----------------------------------------------------
                       ----------------
   47 000003C0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000003C4 F100 0004       add              r0,r0,#4
   49 000003C8 F8CA 00A0       str              r0,clocksh
   50 000003CC         
   51 000003CC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·



ARM Macro Assembler    Page 28 


   52 000003D0         ;//-----------------------------------------------------
                       --------------------
   53 000003D0 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000003D4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000003DA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000003DA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000003DE F8DA F088       ldr              pc,nexttimeout
  170 000003E2         ;-------------------------------------------------------
                       ---------------------
  171 000003E2         _1D                                  ;   ORA $nnnn,X
  172 000003E2         ;-------------------------------------------------------
                       ---------------------
  173 000003E2                 doAIX
  250 000003E2 00000004 
                       _type   SETA             _ABS
  251 000003E2 F819 CB01       ldrb             addy,[m6502_pc],#1
  252 000003E6 F819 0B01       ldrb             r0,[m6502_pc],#1
  253 000003EA EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 000003EE EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 000003F2         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  174 000003F2                 opORA
  469 000003F2                 readmem
  122 000003F2                 [                _type = _ABS
  123 000003F2                 readmemabs
   83 000003F2 F40C 4160       and              r1,addy,#0xE000
   84 000003F6 F20F 0E0A       adr              lr,%F0
   85 000003FA         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000003FA EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 000003FE F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00000402         
   89 00000402         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00000402                 ]
  125 00000402                 [                _type = _ZP
  127                          ]
  128 00000402                 [                _type = _ZPI
  130                          ]
  131 00000402                 [                _type = _IMM
  133                          ]
  470 00000402 EA45 6500       orr              m6502_a,m6502_a,r0,lsl#24
  471 00000406 EA4F 6325       mov              m6502_nz,m6502_a,asr#24
  175 0000040A                 fetch            4
   46 0000040A         ;//-----------------------------------------------------
                       ----------------
   47 0000040A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000040E F100 0004       add              r0,r0,#4



ARM Macro Assembler    Page 29 


   49 00000412 F8CA 00A0       str              r0,clocksh
   50 00000416         
   51 00000416 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000041A         ;//-----------------------------------------------------
                       --------------------
   53 0000041A F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000041E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000424         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000424 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000428 F8DA F088       ldr              pc,nexttimeout
  176 0000042C         ;-------------------------------------------------------
                       ---------------------
  177 0000042C         _1E                                  ;   ASL $nnnn,X
  178 0000042C         ;-------------------------------------------------------
                       ---------------------
  179 0000042C                 doAIX
  250 0000042C 00000004 
                       _type   SETA             _ABS
  251 0000042C F819 CB01       ldrb             addy,[m6502_pc],#1
  252 00000430 F819 0B01       ldrb             r0,[m6502_pc],#1
  253 00000434 EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 00000438 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 0000043C         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  180 0000043C                 opASL
  384 0000043C                 readmem
  122 0000043C                 [                _type = _ABS
  123 0000043C                 readmemabs
   83 0000043C F40C 4160       and              r1,addy,#0xE000
   84 00000440 F20F 0E08       adr              lr,%F0
   85 00000444         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00000444 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00000448 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 0000044C         
   89 0000044C         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 0000044C                 ]
  125 0000044C                 [                _type = _ZP
  127                          ]
  128 0000044C                 [                _type = _ZPI
  130                          ]
  131 0000044C                 [                _type = _IMM
  133                          ]
  385 0000044C 4400            add              r0,r0,r0
  386 0000044E EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  387 00000452 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            



ARM Macro Assembler    Page 30 


  388 00000456                 writemem
  179 00000456                 [                _type = _ABS
  180 00000456                 writememabs
  153 00000456 F40C 4160       and              r1,addy,#0xe000
  154 0000045A F10A 0224       adr              r2,writemem_tbl
  155 0000045E F20F 0E0A       adr              lr,%F0
  156 00000462         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 00000462 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 00000466 F852 F001       ldr              pc,[r2,r1]
  159 0000046A         
  160 0000046A         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 0000046A                 ]
  182 0000046A                 [                _type = _ZP
  184                          ]
  185 0000046A                 [                _type = _ZPI
  187                          ]
  181 0000046A                 fetch_c          7
   62 0000046A         ;//-----------------------------------------------------
                       ----------------
   63 0000046A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 0000046E F100 0007       add              r0,r0,#7
   65 00000472 F8CA 00A0       str              r0,clocksh
   66 00000476         
   67 00000476 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 0000047A         ;//-----------------------------------------------------
                       --------------------
   69 0000047A F578 68E0       sbcs             cycles,cycles,#7*256 
                                                            ;//CYCLE=256
   70 0000047E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00000484         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00000484 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00000488 F8DA F088       ldr              pc,nexttimeout
  182 0000048C         ;-------------------------------------------------------
                       ---------------------
  183 0000048C         _20                                  ;   JSR $nnnn
  184 0000048C         ;-------------------------------------------------------
                       ---------------------
  185 0000048C F819 2B01       ldrb             r2,[m6502_pc],#1
  186 00000490 F8DA 1084       ldr              r1,lastbank
  187 00000494 EBA9 0001       sub              r0,m6502_pc,r1
  188 00000498 F899 1000       ldrb             r1,[m6502_pc]
  189 0000049C EA42 2901       orr              m6502_pc,r2,r1,lsl#8
  190 000004A0                 push16
  193 000004A0 EA4F 2110       mov              r1,r0,lsr#8
  194 000004A4 F8DA 2080       ldr              r2,m6502_s
  195 000004A8 F802 1901       strb             r1,[r2],#-1
  196 000004AC F442 7280       orr              r2,r2,#0x100
  197 000004B0 F802 0901       strb             r0,[r2],#-1
  198 000004B4 F88A 2080       strb             r2,m6502_s
  191 000004B8                 encodePC
   15 000004B8 F409 4160       and              r1,m6502_pc,#0xE000 ;//r9ºÍ0xe0
                                                            00°´Î»ÓëÔËËã
   16 000004BC F10A 0244       adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ



ARM Macro Assembler    Page 31 


                                                            Ö·¼ÓÔØµ½r2
   17 000004C0         ;// ldr r0,[r2,r1,lsr#11]    ;//¸Ä¹ý£¬¼Ó2ÐÐ 
   18 000004C0 EA4F 20D1       lsr              r0,r1,#11   ;//>>11Î»   r1/2048
                                                            
   19 000004C4 5810            ldr              r0,[r2,r0]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
   20 000004C6         
   21 000004C6 F8CA 0084       str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
   22 000004CA 4481            add              m6502_pc,m6502_pc,r0 
                                                            ;//m6502_pc+r0
  192 000004CC                 fetch            6
   46 000004CC         ;//-----------------------------------------------------
                       ----------------
   47 000004CC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000004D0 F100 0006       add              r0,r0,#6
   49 000004D4 F8CA 00A0       str              r0,clocksh
   50 000004D8         
   51 000004D8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000004DC         ;//-----------------------------------------------------
                       --------------------
   53 000004DC F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000004E0 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000004E6         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000004E6 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000004EA F8DA F088       ldr              pc,nexttimeout
  193 000004EE         ;-------------------------------------------------------
                       ---------------------
  194 000004EE         _21                                  ;   AND ($nn,X)
  195 000004EE         ;-------------------------------------------------------
                       ---------------------
  196 000004EE                 doIIX
  275 000004EE 00000004 
                       _type   SETA             _ABS
  276 000004EE F819 0B01       ldrb             r0,[m6502_pc],#1
  277 000004F2 EB06 6000       add              r0,m6502_x,r0,lsl#24
  278 000004F6         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  279 000004F6 EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  280 000004FA F81B C00C       ldrb             addy,[cpu_zpage,addy]
  281 000004FE         
  282 000004FE F100 7080       add              r0,r0,#0x01000000
  283 00000502         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  284 00000502 EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  285 00000506 F81B 1001       ldrb             r1,[cpu_zpage,r1]
  286 0000050A         
  287 0000050A EA4C 2C01       orr              addy,addy,r1,lsl#8
  197 0000050E                 opAND



ARM Macro Assembler    Page 32 


  377 0000050E                 readmem
  122 0000050E                 [                _type = _ABS
  123 0000050E                 readmemabs
   83 0000050E F40C 4160       and              r1,addy,#0xE000
   84 00000512 F20F 0E0A       adr              lr,%F0
   85 00000516         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00000516 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 0000051A F854 F001       ldr              pc,[m6502_rmem,r1]
   88 0000051E         
   89 0000051E         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 0000051E                 ]
  125 0000051E                 [                _type = _ZP
  127                          ]
  128 0000051E                 [                _type = _ZPI
  130                          ]
  131 0000051E                 [                _type = _IMM
  133                          ]
  378 0000051E EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  379 00000522 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  198 00000526                 fetch            6
   46 00000526         ;//-----------------------------------------------------
                       ----------------
   47 00000526 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000052A F100 0006       add              r0,r0,#6
   49 0000052E F8CA 00A0       str              r0,clocksh
   50 00000532         
   51 00000532 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000536         ;//-----------------------------------------------------
                       --------------------
   53 00000536 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000053A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000540         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000540 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000544 F8DA F088       ldr              pc,nexttimeout
  199 00000548         ;-------------------------------------------------------
                       ---------------------
  200 00000548         _24                                  ;   BIT $nn
  201 00000548         ;-------------------------------------------------------
                       ---------------------
  202 00000548                 doZ
  322 00000548 00000002 
                       _type   SETA             _ZP
  323 00000548 F819 CB01       ldrb             addy,[m6502_pc],#1
  203 0000054C                 opBIT



ARM Macro Assembler    Page 33 


  393 0000054C                 readmem
  122 0000054C                 [                _type = _ABS
  124                          ]
  125 0000054C                 [                _type = _ZP
  126 0000054C                 readmemzp
   94 0000054C F81B 000C       ldrb             r0,[cpu_zpage,addy]
  127 00000550                 ]
  128 00000550                 [                _type = _ZPI
  130                          ]
  131 00000550                 [                _type = _IMM
  133                          ]
  394 00000550 F028 0840       bic              cycles,cycles,#CYC_V ;reset V
  395 00000554 F010 0F40       tst              r0,#V
  396 00000558 BF18 F048 
              0840             orrne            cycles,cycles,#CYC_V ;V
  397 0000055E EA00 6315       and              m6502_nz,r0,m6502_a,lsr#24 ;Z
  398 00000562 EA43 6300       orr              m6502_nz,m6502_nz,r0,lsl#24 ;N
  204 00000566                 fetch            3
   46 00000566         ;//-----------------------------------------------------
                       ----------------
   47 00000566 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000056A F100 0003       add              r0,r0,#3
   49 0000056E F8CA 00A0       str              r0,clocksh
   50 00000572         
   51 00000572 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000576         ;//-----------------------------------------------------
                       --------------------
   53 00000576 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000057A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000580         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000580 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000584 F8DA F088       ldr              pc,nexttimeout
  205 00000588         ;-------------------------------------------------------
                       ---------------------
  206 00000588         _25                                  ;   AND $nn
  207 00000588         ;-------------------------------------------------------
                       ---------------------
  208 00000588                 doZ
  322 00000588 00000002 
                       _type   SETA             _ZP
  323 00000588 F819 CB01       ldrb             addy,[m6502_pc],#1
  209 0000058C                 opAND
  377 0000058C                 readmem
  122 0000058C                 [                _type = _ABS
  124                          ]
  125 0000058C                 [                _type = _ZP
  126 0000058C                 readmemzp
   94 0000058C F81B 000C       ldrb             r0,[cpu_zpage,addy]
  127 00000590                 ]
  128 00000590                 [                _type = _ZPI



ARM Macro Assembler    Page 34 


  130                          ]
  131 00000590                 [                _type = _IMM
  133                          ]
  378 00000590 EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  379 00000594 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  210 00000598                 fetch            3
   46 00000598         ;//-----------------------------------------------------
                       ----------------
   47 00000598 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000059C F100 0003       add              r0,r0,#3
   49 000005A0 F8CA 00A0       str              r0,clocksh
   50 000005A4         
   51 000005A4 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000005A8         ;//-----------------------------------------------------
                       --------------------
   53 000005A8 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000005AC BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000005B2         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000005B2 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000005B6 F8DA F088       ldr              pc,nexttimeout
  211 000005BA         ;-------------------------------------------------------
                       ---------------------
  212 000005BA         _26                                  ;   ROL $nn
  213 000005BA         ;-------------------------------------------------------
                       ---------------------
  214 000005BA                 doZ
  322 000005BA 00000002 
                       _type   SETA             _ZP
  323 000005BA F819 CB01       ldrb             addy,[m6502_pc],#1
  215 000005BE                 opROL
  476 000005BE                 readmem
  122 000005BE                 [                _type = _ABS
  124                          ]
  125 000005BE                 [                _type = _ZP
  126 000005BE                 readmemzp
   94 000005BE F81B 000C       ldrb             r0,[cpu_zpage,addy]
  127 000005C2                 ]
  128 000005C2                 [                _type = _ZPI
  130                          ]
  131 000005C2                 [                _type = _IMM
  133                          ]
  477 000005C2 EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  478 000005C6 EB40 0000       adc              r0,r0,r0
  479 000005CA EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  480 000005CE EB48 0808       adc              cycles,cycles,cycles ;Set C
  481 000005D2                 writemem
  179 000005D2                 [                _type = _ABS
  181                          ]
  182 000005D2                 [                _type = _ZP
  183 000005D2                 writememzp



ARM Macro Assembler    Page 35 


  165 000005D2 F80B 000C       strb             r0,[cpu_zpage,addy]
  184 000005D6                 ]
  185 000005D6                 [                _type = _ZPI
  187                          ]
  216 000005D6                 fetch            5
   46 000005D6         ;//-----------------------------------------------------
                       ----------------
   47 000005D6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000005DA F100 0005       add              r0,r0,#5
   49 000005DE F8CA 00A0       str              r0,clocksh
   50 000005E2         
   51 000005E2 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000005E6         ;//-----------------------------------------------------
                       --------------------
   53 000005E6 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000005EA BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000005F0         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000005F0 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000005F4 F8DA F088       ldr              pc,nexttimeout
  217 000005F8         ;-------------------------------------------------------
                       ---------------------
  218 000005F8         _28                                  ;   PLP
  219 000005F8         ;-------------------------------------------------------
                       ---------------------
  220 000005F8                 pop8             r0
  222 000005F8 F89A 2080       ldrb             r2,m6502_s
  223 000005FC F102 0201       add              r2,r2,#1
  224 00000600 F88A 2080       strb             r2,m6502_s
  225 00000604 F442 7280       orr              r2,r2,#0x100
  226 00000608 F91B 0002       ldrsb            r0,[cpu_zpage,r2] ;signed for P
                                                            LA & PLP
  227 0000060C         
  221 0000060C                 decodeP
   37 0000060C F028 084D       bic              cycles,cycles,#CYC_V+CYC_D+CYC_
I+CYC_C
   38 00000610 F000 014D       and              r1,r0,#V+D+I+C
   39 00000614 EA48 0801       orr              cycles,cycles,r1 ;//VDIC
   40 00000618 F020 03FD       bic              m6502_nz,r0,#0xFD 
                                                            ;//r0 is signed
   41 0000061C F083 0302       eor              m6502_nz,m6502_nz,#Z
  222 00000620                 fetch            4
   46 00000620         ;//-----------------------------------------------------
                       ----------------
   47 00000620 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000624 F100 0004       add              r0,r0,#4
   49 00000628 F8CA 00A0       str              r0,clocksh
   50 0000062C         
   51 0000062C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·



ARM Macro Assembler    Page 36 


   52 00000630         ;//-----------------------------------------------------
                       --------------------
   53 00000630 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000634 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000063A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000063A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000063E F8DA F088       ldr              pc,nexttimeout
  223 00000642         ;-------------------------------------------------------
                       ---------------------
  224 00000642         _29                                  ;   AND #$nn
  225 00000642         ;-------------------------------------------------------
                       ---------------------
  226 00000642                 doIMM
  270 00000642 00000001 
                       _type   SETA             _IMM
  227 00000642                 opAND
  377 00000642                 readmem
  122 00000642                 [                _type = _ABS
  124                          ]
  125 00000642                 [                _type = _ZP
  127                          ]
  128 00000642                 [                _type = _ZPI
  130                          ]
  131 00000642                 [                _type = _IMM
  132 00000642                 readmemimm
  112 00000642 F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  133 00000646                 ]
  378 00000646 EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  379 0000064A EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  228 0000064E                 fetch            2
   46 0000064E         ;//-----------------------------------------------------
                       ----------------
   47 0000064E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000652 F100 0002       add              r0,r0,#2
   49 00000656 F8CA 00A0       str              r0,clocksh
   50 0000065A         
   51 0000065A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000065E         ;//-----------------------------------------------------
                       --------------------
   53 0000065E F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000662 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000668         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000668 F851 F020       ldrpl            pc,[r1,r0,lsl#2]



ARM Macro Assembler    Page 37 


   57 0000066C F8DA F088       ldr              pc,nexttimeout
  229 00000670         ;-------------------------------------------------------
                       ---------------------
  230 00000670         _2A                                  ;   ROL
  231 00000670         ;-------------------------------------------------------
                       ---------------------
  232 00000670 EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  233 00000674 BF28 F445 
              0500             orrcs            m6502_a,m6502_a,#0x00800000
  234 0000067A 196D            adds             m6502_a,m6502_a,m6502_a
  235 0000067C EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  236 00000680 EB48 0808       adc              cycles,cycles,cycles ;Set C
  237 00000684                 fetch            2
   46 00000684         ;//-----------------------------------------------------
                       ----------------
   47 00000684 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000688 F100 0002       add              r0,r0,#2
   49 0000068C F8CA 00A0       str              r0,clocksh
   50 00000690         
   51 00000690 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000694         ;//-----------------------------------------------------
                       --------------------
   53 00000694 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000698 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000069E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000069E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000006A2 F8DA F088       ldr              pc,nexttimeout
  238 000006A6         ;-------------------------------------------------------
                       ---------------------
  239 000006A6         _2C                                  ;   BIT $nnnn
  240 000006A6         ;-------------------------------------------------------
                       ---------------------
  241 000006A6                 doABS
  242 000006A6 00000004 
                       _type   SETA             _ABS
  243 000006A6 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 000006AA F819 0B01       ldrb             r0,[m6502_pc],#1
  245 000006AE EA4C 2C00       orr              addy,addy,r0,lsl#8
  242 000006B2                 opBIT
  393 000006B2                 readmem
  122 000006B2                 [                _type = _ABS
  123 000006B2                 readmemabs
   83 000006B2 F40C 4160       and              r1,addy,#0xE000
   84 000006B6 F20F 0E0A       adr              lr,%F0
   85 000006BA         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000006BA EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 000006BE F854 F001       ldr              pc,[m6502_rmem,r1]
   88 000006C2         



ARM Macro Assembler    Page 38 


   89 000006C2         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 000006C2                 ]
  125 000006C2                 [                _type = _ZP
  127                          ]
  128 000006C2                 [                _type = _ZPI
  130                          ]
  131 000006C2                 [                _type = _IMM
  133                          ]
  394 000006C2 F028 0840       bic              cycles,cycles,#CYC_V ;reset V
  395 000006C6 F010 0F40       tst              r0,#V
  396 000006CA BF18 F048 
              0840             orrne            cycles,cycles,#CYC_V ;V
  397 000006D0 EA00 6315       and              m6502_nz,r0,m6502_a,lsr#24 ;Z
  398 000006D4 EA43 6300       orr              m6502_nz,m6502_nz,r0,lsl#24 ;N
  243 000006D8                 fetch            4
   46 000006D8         ;//-----------------------------------------------------
                       ----------------
   47 000006D8 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000006DC F100 0004       add              r0,r0,#4
   49 000006E0 F8CA 00A0       str              r0,clocksh
   50 000006E4         
   51 000006E4 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000006E8         ;//-----------------------------------------------------
                       --------------------
   53 000006E8 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000006EC BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000006F2         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000006F2 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000006F6 F8DA F088       ldr              pc,nexttimeout
  244 000006FA         ;-------------------------------------------------------
                       ---------------------
  245 000006FA         _2D                                  ;   AND $nnnn
  246 000006FA         ;-------------------------------------------------------
                       ---------------------
  247 000006FA                 doABS
  242 000006FA 00000004 
                       _type   SETA             _ABS
  243 000006FA F819 CB01       ldrb             addy,[m6502_pc],#1
  244 000006FE F819 0B01       ldrb             r0,[m6502_pc],#1
  245 00000702 EA4C 2C00       orr              addy,addy,r0,lsl#8
  248 00000706                 opAND
  377 00000706                 readmem
  122 00000706                 [                _type = _ABS
  123 00000706                 readmemabs
   83 00000706 F40C 4160       and              r1,addy,#0xE000
   84 0000070A F20F 0E0A       adr              lr,%F0



ARM Macro Assembler    Page 39 


   85 0000070E         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 0000070E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00000712 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00000716         
   89 00000716         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00000716                 ]
  125 00000716                 [                _type = _ZP
  127                          ]
  128 00000716                 [                _type = _ZPI
  130                          ]
  131 00000716                 [                _type = _IMM
  133                          ]
  378 00000716 EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  379 0000071A EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  249 0000071E                 fetch            4
   46 0000071E         ;//-----------------------------------------------------
                       ----------------
   47 0000071E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000722 F100 0004       add              r0,r0,#4
   49 00000726 F8CA 00A0       str              r0,clocksh
   50 0000072A         
   51 0000072A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000072E         ;//-----------------------------------------------------
                       --------------------
   53 0000072E F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000732 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000738         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000738 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000073C F8DA F088       ldr              pc,nexttimeout
  250 00000740         ;-------------------------------------------------------
                       ---------------------
  251 00000740         _2E                                  ;   ROL $nnnn
  252 00000740         ;-------------------------------------------------------
                       ---------------------
  253 00000740                 doABS
  242 00000740 00000004 
                       _type   SETA             _ABS
  243 00000740 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 00000744 F819 0B01       ldrb             r0,[m6502_pc],#1
  245 00000748 EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 0000074C                 opROL
  476 0000074C                 readmem
  122 0000074C                 [                _type = _ABS
  123 0000074C                 readmemabs



ARM Macro Assembler    Page 40 


   83 0000074C F40C 4160       and              r1,addy,#0xE000
   84 00000750 F20F 0E08       adr              lr,%F0
   85 00000754         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00000754 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00000758 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 0000075C         
   89 0000075C         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 0000075C                 ]
  125 0000075C                 [                _type = _ZP
  127                          ]
  128 0000075C                 [                _type = _ZPI
  130                          ]
  131 0000075C                 [                _type = _IMM
  133                          ]
  477 0000075C EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  478 00000760 EB40 0000       adc              r0,r0,r0
  479 00000764 EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  480 00000768 EB48 0808       adc              cycles,cycles,cycles ;Set C
  481 0000076C                 writemem
  179 0000076C                 [                _type = _ABS
  180 0000076C                 writememabs
  153 0000076C F40C 4160       and              r1,addy,#0xe000
  154 00000770 F10A 0224       adr              r2,writemem_tbl
  155 00000774 F20F 0E08       adr              lr,%F0
  156 00000778         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 00000778 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 0000077C F852 F001       ldr              pc,[r2,r1]
  159 00000780         
  160 00000780         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 00000780                 ]
  182 00000780                 [                _type = _ZP
  184                          ]
  185 00000780                 [                _type = _ZPI
  187                          ]
  255 00000780                 fetch            6
   46 00000780         ;//-----------------------------------------------------
                       ----------------
   47 00000780 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000784 F100 0006       add              r0,r0,#6
   49 00000788 F8CA 00A0       str              r0,clocksh
   50 0000078C         
   51 0000078C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000790         ;//-----------------------------------------------------
                       --------------------
   53 00000790 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000794 BF5C F819 



ARM Macro Assembler    Page 41 


              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000079A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000079A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000079E F8DA F088       ldr              pc,nexttimeout
  256 000007A2         ;-------------------------------------------------------
                       ---------------------
  257 000007A2         _30                                  ;   BMI *
  258 000007A2         ;-------------------------------------------------------
                       ---------------------
  259 000007A2 F013 4F00       tst              m6502_nz,#0x80000000
  260 000007A6 F919 0B01       ldrsb            r0,[m6502_pc],#1
  261 000007AA BF1C 4481       addne            m6502_pc,m6502_pc,r0
  262 000007AE         ; subne cycles,cycles,#3*CYCLE
  263 000007AE F5A8 7880       subne            cycles,cycles,#256
  264 000007B2                 fetch            2
   46 000007B2         ;//-----------------------------------------------------
                       ----------------
   47 000007B2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000007B6 F100 0002       add              r0,r0,#2
   49 000007BA F8CA 00A0       str              r0,clocksh
   50 000007BE         
   51 000007BE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000007C2         ;//-----------------------------------------------------
                       --------------------
   53 000007C2 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000007C6 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000007CC         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000007CC F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000007D0 F8DA F088       ldr              pc,nexttimeout
  265 000007D4         ;-------------------------------------------------------
                       ---------------------
  266 000007D4         _31                                  ;   AND ($nn),Y
  267 000007D4         ;-------------------------------------------------------
                       ---------------------
  268 000007D4                 doIIY
  292 000007D4 00000004 
                       _type   SETA             _ABS
  293 000007D4 F819 0B01       ldrb             r0,[m6502_pc],#1
  294 000007D8         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  295 000007D8         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  296 000007D8 F810 C00B       ldrb             addy,[r0,cpu_zpage]
  297 000007DC 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  298 000007DE         



ARM Macro Assembler    Page 42 


  299 000007DE         
  300 000007DE 7841            ldrb             r1,[r0,#1]
  301 000007E0 EA4C 2C01       orr              addy,addy,r1,lsl#8
  302 000007E4 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  303 000007E8         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
  269 000007E8                 opAND
  377 000007E8                 readmem
  122 000007E8                 [                _type = _ABS
  123 000007E8                 readmemabs
   83 000007E8 F40C 4160       and              r1,addy,#0xE000
   84 000007EC F20F 0E08       adr              lr,%F0
   85 000007F0         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000007F0 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 000007F4 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 000007F8         
   89 000007F8         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 000007F8                 ]
  125 000007F8                 [                _type = _ZP
  127                          ]
  128 000007F8                 [                _type = _ZPI
  130                          ]
  131 000007F8                 [                _type = _IMM
  133                          ]
  378 000007F8 EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  379 000007FC EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  270 00000800                 fetch            5
   46 00000800         ;//-----------------------------------------------------
                       ----------------
   47 00000800 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000804 F100 0005       add              r0,r0,#5
   49 00000808 F8CA 00A0       str              r0,clocksh
   50 0000080C         
   51 0000080C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000810         ;//-----------------------------------------------------
                       --------------------
   53 00000810 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000814 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000081A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000081A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000081E F8DA F088       ldr              pc,nexttimeout
  271 00000822         ;-------------------------------------------------------
                       ---------------------
  272 00000822         _35                                  ;   AND $nn,X
  273 00000822         ;-------------------------------------------------------



ARM Macro Assembler    Page 43 


                       ---------------------
  274 00000822                 doZIXf
  342 00000822 00000003 
                       _type   SETA             _ZPI
  343 00000822 F819 CB01       ldrb             addy,[m6502_pc],#1
  344 00000826 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  275 0000082A                 opAND
  377 0000082A                 readmem
  122 0000082A                 [                _type = _ABS
  124                          ]
  125 0000082A                 [                _type = _ZP
  127                          ]
  128 0000082A                 [                _type = _ZPI
  129 0000082A                 readmemzpi
   99 0000082A         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  100 0000082A EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  101 0000082E F81B 0000       ldrb             r0,[cpu_zpage,r0]
  102 00000832         
  130 00000832                 ]
  131 00000832                 [                _type = _IMM
  133                          ]
  378 00000832 EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  379 00000836 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  276 0000083A                 fetch            4
   46 0000083A         ;//-----------------------------------------------------
                       ----------------
   47 0000083A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000083E F100 0004       add              r0,r0,#4
   49 00000842 F8CA 00A0       str              r0,clocksh
   50 00000846         
   51 00000846 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000084A         ;//-----------------------------------------------------
                       --------------------
   53 0000084A F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000084E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000854         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000854 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000858 F8DA F088       ldr              pc,nexttimeout
  277 0000085C         ;-------------------------------------------------------
                       ---------------------
  278 0000085C         _36                                  ;   ROL $nn,X
  279 0000085C         ;-------------------------------------------------------
                       ---------------------
  280 0000085C                 doZIXf
  342 0000085C 00000003 
                       _type   SETA             _ZPI
  343 0000085C F819 CB01       ldrb             addy,[m6502_pc],#1
  344 00000860 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  281 00000864                 opROL
  476 00000864                 readmem



ARM Macro Assembler    Page 44 


  122 00000864                 [                _type = _ABS
  124                          ]
  125 00000864                 [                _type = _ZP
  127                          ]
  128 00000864                 [                _type = _ZPI
  129 00000864                 readmemzpi
   99 00000864         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  100 00000864 EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  101 00000868 F81B 0000       ldrb             r0,[cpu_zpage,r0]
  102 0000086C         
  130 0000086C                 ]
  131 0000086C                 [                _type = _IMM
  133                          ]
  477 0000086C EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  478 00000870 EB40 0000       adc              r0,r0,r0
  479 00000874 EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  480 00000878 EB48 0808       adc              cycles,cycles,cycles ;Set C
  481 0000087C                 writemem
  179 0000087C                 [                _type = _ABS
  181                          ]
  182 0000087C                 [                _type = _ZP
  184                          ]
  185 0000087C                 [                _type = _ZPI
  186 0000087C                 writememzpi
  170 0000087C         ;// strb r0,[cpu_zpage,addy,lsr#24]
  171 0000087C EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  172 00000880 F80B 0001       strb             r0,[cpu_zpage,r1]
  173 00000884         
  174 00000884         
  187 00000884                 ]
  282 00000884                 fetch            6
   46 00000884         ;//-----------------------------------------------------
                       ----------------
   47 00000884 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000888 F100 0006       add              r0,r0,#6
   49 0000088C F8CA 00A0       str              r0,clocksh
   50 00000890         
   51 00000890 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000894         ;//-----------------------------------------------------
                       --------------------
   53 00000894 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000898 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000089E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000089E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000008A2 F8DA F088       ldr              pc,nexttimeout
  283 000008A6         ;-------------------------------------------------------
                       ---------------------
  284 000008A6         _38                                  ;   SEC
  285 000008A6         ;-------------------------------------------------------



ARM Macro Assembler    Page 45 


                       ---------------------
  286 000008A6 F048 0801       orr              cycles,cycles,#CYC_C
  287 000008AA                 fetch            2
   46 000008AA         ;//-----------------------------------------------------
                       ----------------
   47 000008AA F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000008AE F100 0002       add              r0,r0,#2
   49 000008B2 F8CA 00A0       str              r0,clocksh
   50 000008B6         
   51 000008B6 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000008BA         ;//-----------------------------------------------------
                       --------------------
   53 000008BA F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000008BE BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000008C4         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000008C4 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000008C8 F8DA F088       ldr              pc,nexttimeout
  288 000008CC         ;-------------------------------------------------------
                       ---------------------
  289 000008CC         _39                                  ;   AND $nnnn,Y
  290 000008CC         ;-------------------------------------------------------
                       ---------------------
  291 000008CC                 doAIY
  260 000008CC 00000004 
                       _type   SETA             _ABS
  261 000008CC F819 CB01       ldrb             addy,[m6502_pc],#1
  262 000008D0 F819 0B01       ldrb             r0,[m6502_pc],#1
  263 000008D4 EA4C 2C00       orr              addy,addy,r0,lsl#8
  264 000008D8 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  265 000008DC         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
  292 000008DC                 opAND
  377 000008DC                 readmem
  122 000008DC                 [                _type = _ABS
  123 000008DC                 readmemabs
   83 000008DC F40C 4160       and              r1,addy,#0xE000
   84 000008E0 F20F 0E08       adr              lr,%F0
   85 000008E4         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000008E4 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 000008E8 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 000008EC         
   89 000008EC         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 000008EC                 ]
  125 000008EC                 [                _type = _ZP
  127                          ]



ARM Macro Assembler    Page 46 


  128 000008EC                 [                _type = _ZPI
  130                          ]
  131 000008EC                 [                _type = _IMM
  133                          ]
  378 000008EC EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  379 000008F0 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  293 000008F4                 fetch            4
   46 000008F4         ;//-----------------------------------------------------
                       ----------------
   47 000008F4 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000008F8 F100 0004       add              r0,r0,#4
   49 000008FC F8CA 00A0       str              r0,clocksh
   50 00000900         
   51 00000900 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000904         ;//-----------------------------------------------------
                       --------------------
   53 00000904 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000908 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000090E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000090E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000912 F8DA F088       ldr              pc,nexttimeout
  294 00000916         ;-------------------------------------------------------
                       ---------------------
  295 00000916         _3D                                  ;   AND $nnnn,X
  296 00000916         ;-------------------------------------------------------
                       ---------------------
  297 00000916                 doAIX
  250 00000916 00000004 
                       _type   SETA             _ABS
  251 00000916 F819 CB01       ldrb             addy,[m6502_pc],#1
  252 0000091A F819 0B01       ldrb             r0,[m6502_pc],#1
  253 0000091E EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 00000922 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 00000926         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  298 00000926                 opAND
  377 00000926                 readmem
  122 00000926                 [                _type = _ABS
  123 00000926                 readmemabs
   83 00000926 F40C 4160       and              r1,addy,#0xE000
   84 0000092A F20F 0E0A       adr              lr,%F0
   85 0000092E         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 0000092E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00000932 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00000936         
   89 00000936         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i



ARM Macro Assembler    Page 47 


                                                            nstructions
  124 00000936                 ]
  125 00000936                 [                _type = _ZP
  127                          ]
  128 00000936                 [                _type = _ZPI
  130                          ]
  131 00000936                 [                _type = _IMM
  133                          ]
  378 00000936 EA05 6500       and              m6502_a,m6502_a,r0,lsl#24
  379 0000093A EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  299 0000093E                 fetch            4
   46 0000093E         ;//-----------------------------------------------------
                       ----------------
   47 0000093E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000942 F100 0004       add              r0,r0,#4
   49 00000946 F8CA 00A0       str              r0,clocksh
   50 0000094A         
   51 0000094A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000094E         ;//-----------------------------------------------------
                       --------------------
   53 0000094E F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000952 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000958         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000958 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000095C F8DA F088       ldr              pc,nexttimeout
  300 00000960         ;-------------------------------------------------------
                       ---------------------
  301 00000960         _3E                                  ;   ROL $nnnn,X
  302 00000960         ;-------------------------------------------------------
                       ---------------------
  303 00000960                 doAIX
  250 00000960 00000004 
                       _type   SETA             _ABS
  251 00000960 F819 CB01       ldrb             addy,[m6502_pc],#1
  252 00000964 F819 0B01       ldrb             r0,[m6502_pc],#1
  253 00000968 EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 0000096C EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 00000970         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  304 00000970                 opROL
  476 00000970                 readmem
  122 00000970                 [                _type = _ABS
  123 00000970                 readmemabs
   83 00000970 F40C 4160       and              r1,addy,#0xE000
   84 00000974 F20F 0E08       adr              lr,%F0
   85 00000978         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00000978 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 0000097C F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00000980         



ARM Macro Assembler    Page 48 


   89 00000980         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00000980                 ]
  125 00000980                 [                _type = _ZP
  127                          ]
  128 00000980                 [                _type = _ZPI
  130                          ]
  131 00000980                 [                _type = _IMM
  133                          ]
  477 00000980 EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  478 00000984 EB40 0000       adc              r0,r0,r0
  479 00000988 EA50 6300       orrs             m6502_nz,r0,r0,lsl#24 ;NZ
  480 0000098C EB48 0808       adc              cycles,cycles,cycles ;Set C
  481 00000990                 writemem
  179 00000990                 [                _type = _ABS
  180 00000990                 writememabs
  153 00000990 F40C 4160       and              r1,addy,#0xe000
  154 00000994 F10A 0224       adr              r2,writemem_tbl
  155 00000998 F20F 0E08       adr              lr,%F0
  156 0000099C         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 0000099C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 000009A0 F852 F001       ldr              pc,[r2,r1]
  159 000009A4         
  160 000009A4         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 000009A4                 ]
  182 000009A4                 [                _type = _ZP
  184                          ]
  185 000009A4                 [                _type = _ZPI
  187                          ]
  305 000009A4                 fetch            7
   46 000009A4         ;//-----------------------------------------------------
                       ----------------
   47 000009A4 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000009A8 F100 0007       add              r0,r0,#7
   49 000009AC F8CA 00A0       str              r0,clocksh
   50 000009B0         
   51 000009B0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000009B4         ;//-----------------------------------------------------
                       --------------------
   53 000009B4 F5B8 68E0       subs             cycles,cycles,#7*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000009B8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000009BE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000009BE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000009C2 F8DA F088       ldr              pc,nexttimeout



ARM Macro Assembler    Page 49 


  306 000009C6         ;-------------------------------------------------------
                       ---------------------
  307 000009C6         _40                                  ;   RTI
  308 000009C6         ;-------------------------------------------------------
                       ---------------------
  309 000009C6                 pop8             r0          ;pop 6502 flags and
                                                             decode
  222 000009C6 F89A 2080       ldrb             r2,m6502_s
  223 000009CA F102 0201       add              r2,r2,#1
  224 000009CE F88A 2080       strb             r2,m6502_s
  225 000009D2 F442 7280       orr              r2,r2,#0x100
  226 000009D6 F91B 0002       ldrsb            r0,[cpu_zpage,r2] ;signed for P
                                                            LA & PLP
  227 000009DA         
  310 000009DA                 decodeP
   37 000009DA F028 084D       bic              cycles,cycles,#CYC_V+CYC_D+CYC_
I+CYC_C
   38 000009DE F000 014D       and              r1,r0,#V+D+I+C
   39 000009E2 EA48 0801       orr              cycles,cycles,r1 ;//VDIC
   40 000009E6 F020 03FD       bic              m6502_nz,r0,#0xFD 
                                                            ;//r0 is signed
   41 000009EA F083 0302       eor              m6502_nz,m6502_nz,#Z
  311 000009EE                 pop16                        ;pop the return add
                                                            ress
  210 000009EE F89A 2080       ldrb             r2,m6502_s
  211 000009F2 F102 0202       add              r2,r2,#2
  212 000009F6 F88A 2080       strb             r2,m6502_s
  213 000009FA F8DA 2080       ldr              r2,m6502_s
  214 000009FE F812 0901       ldrb             r0,[r2],#-1
  215 00000A02 F442 7280       orr              r2,r2,#0x100
  216 00000A06 F892 9000       ldrb             m6502_pc,[r2]
  217 00000A0A EA49 2900       orr              m6502_pc,m6502_pc,r0,lsl#8
  312 00000A0E                 encodePC
   15 00000A0E F409 4160       and              r1,m6502_pc,#0xE000 ;//r9ºÍ0xe0
                                                            00°´Î»ÓëÔËËã
   16 00000A12 F10A 0244       adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ
                                                            Ö·¼ÓÔØµ½r2
   17 00000A16         ;// ldr r0,[r2,r1,lsr#11]    ;//¸Ä¹ý£¬¼Ó2ÐÐ 
   18 00000A16 EA4F 20D1       lsr              r0,r1,#11   ;//>>11Î»   r1/2048
                                                            
   19 00000A1A 5810            ldr              r0,[r2,r0]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
   20 00000A1C         
   21 00000A1C F8CA 0084       str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
   22 00000A20 4481            add              m6502_pc,m6502_pc,r0 
                                                            ;//m6502_pc+r0
  313 00000A22                 fetch            6
   46 00000A22         ;//-----------------------------------------------------
                       ----------------
   47 00000A22 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000A26 F100 0006       add              r0,r0,#6
   49 00000A2A F8CA 00A0       str              r0,clocksh
   50 00000A2E         
   51 00000A2E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000A32         ;//-----------------------------------------------------
                       --------------------



ARM Macro Assembler    Page 50 


   53 00000A32 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000A36 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000A3C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000A3C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000A40 F8DA F088       ldr              pc,nexttimeout
  314 00000A44         ;-------------------------------------------------------
                       ---------------------
  315 00000A44         _41                                  ;   EOR ($nn,X)
  316 00000A44         ;-------------------------------------------------------
                       ---------------------
  317 00000A44                 doIIX
  275 00000A44 00000004 
                       _type   SETA             _ABS
  276 00000A44 F819 0B01       ldrb             r0,[m6502_pc],#1
  277 00000A48 EB06 6000       add              r0,m6502_x,r0,lsl#24
  278 00000A4C         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  279 00000A4C EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  280 00000A50 F81B C00C       ldrb             addy,[cpu_zpage,addy]
  281 00000A54         
  282 00000A54 F100 7080       add              r0,r0,#0x01000000
  283 00000A58         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  284 00000A58 EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  285 00000A5C F81B 1001       ldrb             r1,[cpu_zpage,r1]
  286 00000A60         
  287 00000A60 EA4C 2C01       orr              addy,addy,r1,lsl#8
  318 00000A64                 opEOR
  419 00000A64                 readmem
  122 00000A64                 [                _type = _ABS
  123 00000A64                 readmemabs
   83 00000A64 F40C 4160       and              r1,addy,#0xE000
   84 00000A68 F20F 0E08       adr              lr,%F0
   85 00000A6C         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00000A6C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00000A70 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00000A74         
   89 00000A74         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00000A74                 ]
  125 00000A74                 [                _type = _ZP
  127                          ]
  128 00000A74                 [                _type = _ZPI
  130                          ]
  131 00000A74                 [                _type = _IMM
  133                          ]



ARM Macro Assembler    Page 51 


  420 00000A74 EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24
  421 00000A78 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  319 00000A7C                 fetch            6
   46 00000A7C         ;//-----------------------------------------------------
                       ----------------
   47 00000A7C F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000A80 F100 0006       add              r0,r0,#6
   49 00000A84 F8CA 00A0       str              r0,clocksh
   50 00000A88         
   51 00000A88 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000A8C         ;//-----------------------------------------------------
                       --------------------
   53 00000A8C F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000A90 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000A96         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000A96 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000A9A F8DA F088       ldr              pc,nexttimeout
  320 00000A9E         ;-------------------------------------------------------
                       ---------------------
  321 00000A9E         _45                                  ;   EOR $nn
  322 00000A9E         ;-------------------------------------------------------
                       ---------------------
  323 00000A9E                 doZ
  322 00000A9E 00000002 
                       _type   SETA             _ZP
  323 00000A9E F819 CB01       ldrb             addy,[m6502_pc],#1
  324 00000AA2                 opEOR
  419 00000AA2                 readmem
  122 00000AA2                 [                _type = _ABS
  124                          ]
  125 00000AA2                 [                _type = _ZP
  126 00000AA2                 readmemzp
   94 00000AA2 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  127 00000AA6                 ]
  128 00000AA6                 [                _type = _ZPI
  130                          ]
  131 00000AA6                 [                _type = _IMM
  133                          ]
  420 00000AA6 EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24
  421 00000AAA EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  325 00000AAE                 fetch            3
   46 00000AAE         ;//-----------------------------------------------------
                       ----------------
   47 00000AAE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000AB2 F100 0003       add              r0,r0,#3
   49 00000AB6 F8CA 00A0       str              r0,clocksh
   50 00000ABA         
   51 00000ABA F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·



ARM Macro Assembler    Page 52 


   52 00000ABE         ;//-----------------------------------------------------
                       --------------------
   53 00000ABE F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000AC2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000AC8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000AC8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000ACC F8DA F088       ldr              pc,nexttimeout
  326 00000AD0         ;-------------------------------------------------------
                       ---------------------
  327 00000AD0         _46                                  ;   LSR $nn
  328 00000AD0         ;-------------------------------------------------------
                       ---------------------
  329 00000AD0                 doZ
  322 00000AD0 00000002 
                       _type   SETA             _ZP
  323 00000AD0 F819 CB01       ldrb             addy,[m6502_pc],#1
  330 00000AD4                 opLSR
  440 00000AD4                 [                _type = _ABS
  446                          ]
  447 00000AD4                 [                _type = _ZP
  448 00000AD4 F81B 300C       ldrb             m6502_nz,[cpu_zpage,addy]
  449 00000AD8 085B            movs             m6502_nz,m6502_nz,lsr#1 
                                                            ;Z, (N=0)
  450 00000ADA F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  451 00000ADE F80B 300C       strb             m6502_nz,[cpu_zpage,addy]
  452 00000AE2                 ]
  453 00000AE2                 [                _type = _ZPI
  464                          ]
  331 00000AE2                 fetch_c          5
   62 00000AE2         ;//-----------------------------------------------------
                       ----------------
   63 00000AE2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00000AE6 F100 0005       add              r0,r0,#5
   65 00000AEA F8CA 00A0       str              r0,clocksh
   66 00000AEE         
   67 00000AEE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00000AF2         ;//-----------------------------------------------------
                       --------------------
   69 00000AF2 F578 68A0       sbcs             cycles,cycles,#5*256 
                                                            ;//CYCLE=256
   70 00000AF6 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00000AFC         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00000AFC F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00000B00 F8DA F088       ldr              pc,nexttimeout
  332 00000B04         ;-------------------------------------------------------
                       ---------------------
  333 00000B04         _48                                  ;   PHA
  334 00000B04         ;-------------------------------------------------------



ARM Macro Assembler    Page 53 


                       ---------------------
  335 00000B04 EA4F 6015       mov              r0,m6502_a,lsr#24
  336 00000B08                 push8            r0
  203 00000B08 F8DA 2080       ldr              r2,m6502_s
  204 00000B0C F802 0901       strb             r0,[r2],#-1
  205 00000B10 F88A 2080       strb             r2,m6502_s
  337 00000B14                 fetch            3
   46 00000B14         ;//-----------------------------------------------------
                       ----------------
   47 00000B14 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000B18 F100 0003       add              r0,r0,#3
   49 00000B1C F8CA 00A0       str              r0,clocksh
   50 00000B20         
   51 00000B20 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000B24         ;//-----------------------------------------------------
                       --------------------
   53 00000B24 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000B28 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000B2E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000B2E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000B32 F8DA F088       ldr              pc,nexttimeout
  338 00000B36         ;-------------------------------------------------------
                       ---------------------
  339 00000B36         _49                                  ;   EOR #$nn
  340 00000B36         ;-------------------------------------------------------
                       ---------------------
  341 00000B36                 doIMM
  270 00000B36 00000001 
                       _type   SETA             _IMM
  342 00000B36                 opEOR
  419 00000B36                 readmem
  122 00000B36                 [                _type = _ABS
  124                          ]
  125 00000B36                 [                _type = _ZP
  127                          ]
  128 00000B36                 [                _type = _ZPI
  130                          ]
  131 00000B36                 [                _type = _IMM
  132 00000B36                 readmemimm
  112 00000B36 F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  133 00000B3A                 ]
  420 00000B3A EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24
  421 00000B3E EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  343 00000B42                 fetch            2
   46 00000B42         ;//-----------------------------------------------------
                       ----------------
   47 00000B42 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000B46 F100 0002       add              r0,r0,#2
   49 00000B4A F8CA 00A0       str              r0,clocksh



ARM Macro Assembler    Page 54 


   50 00000B4E         
   51 00000B4E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000B52         ;//-----------------------------------------------------
                       --------------------
   53 00000B52 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000B56 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000B5C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000B5C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000B60 F8DA F088       ldr              pc,nexttimeout
  344 00000B64         ;-------------------------------------------------------
                       ---------------------
  345 00000B64         _4A                                  ;   LSR
  346 00000B64         ;-------------------------------------------------------
                       ---------------------
  347 00000B64 0E6B            movs             m6502_nz,m6502_a,lsr#25 ;Z, N=0
                                                            
  348 00000B66 EA4F 6503       mov              m6502_a,m6502_nz,lsl#24 ;result
                                                             without garbage
  349 00000B6A F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  350 00000B6E                 fetch_c          2
   62 00000B6E         ;//-----------------------------------------------------
                       ----------------
   63 00000B6E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00000B72 F100 0002       add              r0,r0,#2
   65 00000B76 F8CA 00A0       str              r0,clocksh
   66 00000B7A         
   67 00000B7A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00000B7E         ;//-----------------------------------------------------
                       --------------------
   69 00000B7E F578 7800       sbcs             cycles,cycles,#2*256 
                                                            ;//CYCLE=256
   70 00000B82 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00000B88         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00000B88 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00000B8C F8DA F088       ldr              pc,nexttimeout
  351 00000B90         ;-------------------------------------------------------
                       ---------------------
  352 00000B90         _4C                                  ;   JMP $nnnn
  353 00000B90         ;-------------------------------------------------------
                       ---------------------
  354 00000B90 F819 0B01       ldrb             r0,[m6502_pc],#1
  355 00000B94 F899 1000       ldrb             r1,[m6502_pc]
  356 00000B98 EA40 2901       orr              m6502_pc,r0,r1,lsl#8
  357 00000B9C                 encodePC
   15 00000B9C F409 4160       and              r1,m6502_pc,#0xE000 ;//r9ºÍ0xe0
                                                            00°´Î»ÓëÔËËã
   16 00000BA0 F10A 0244       adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ



ARM Macro Assembler    Page 55 


                                                            Ö·¼ÓÔØµ½r2
   17 00000BA4         ;// ldr r0,[r2,r1,lsr#11]    ;//¸Ä¹ý£¬¼Ó2ÐÐ 
   18 00000BA4 EA4F 20D1       lsr              r0,r1,#11   ;//>>11Î»   r1/2048
                                                            
   19 00000BA8 5810            ldr              r0,[r2,r0]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
   20 00000BAA         
   21 00000BAA F8CA 0084       str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
   22 00000BAE 4481            add              m6502_pc,m6502_pc,r0 
                                                            ;//m6502_pc+r0
  358 00000BB0                 fetch            3
   46 00000BB0         ;//-----------------------------------------------------
                       ----------------
   47 00000BB0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000BB4 F100 0003       add              r0,r0,#3
   49 00000BB8 F8CA 00A0       str              r0,clocksh
   50 00000BBC         
   51 00000BBC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000BC0         ;//-----------------------------------------------------
                       --------------------
   53 00000BC0 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000BC4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000BCA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000BCA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000BCE F8DA F088       ldr              pc,nexttimeout
  359 00000BD2         ;-------------------------------------------------------
                       ---------------------
  360 00000BD2         _4D                                  ;   EOR $nnnn
  361 00000BD2         ;-------------------------------------------------------
                       ---------------------
  362 00000BD2                 doABS
  242 00000BD2 00000004 
                       _type   SETA             _ABS
  243 00000BD2 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 00000BD6 F819 0B01       ldrb             r0,[m6502_pc],#1
  245 00000BDA EA4C 2C00       orr              addy,addy,r0,lsl#8
  363 00000BDE                 opEOR
  419 00000BDE                 readmem
  122 00000BDE                 [                _type = _ABS
  123 00000BDE                 readmemabs
   83 00000BDE F40C 4160       and              r1,addy,#0xE000
   84 00000BE2 F20F 0E0A       adr              lr,%F0
   85 00000BE6         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00000BE6 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00000BEA F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00000BEE         
   89 00000BEE         0                                    ;//out: r0=val (bit



ARM Macro Assembler    Page 56 


                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00000BEE                 ]
  125 00000BEE                 [                _type = _ZP
  127                          ]
  128 00000BEE                 [                _type = _ZPI
  130                          ]
  131 00000BEE                 [                _type = _IMM
  133                          ]
  420 00000BEE EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24
  421 00000BF2 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  364 00000BF6                 fetch            4
   46 00000BF6         ;//-----------------------------------------------------
                       ----------------
   47 00000BF6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000BFA F100 0004       add              r0,r0,#4
   49 00000BFE F8CA 00A0       str              r0,clocksh
   50 00000C02         
   51 00000C02 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000C06         ;//-----------------------------------------------------
                       --------------------
   53 00000C06 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000C0A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000C10         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000C10 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000C14 F8DA F088       ldr              pc,nexttimeout
  365 00000C18         ;-------------------------------------------------------
                       ---------------------
  366 00000C18         _4E                                  ;   LSR $nnnn
  367 00000C18         ;-------------------------------------------------------
                       ---------------------
  368 00000C18                 doABS
  242 00000C18 00000004 
                       _type   SETA             _ABS
  243 00000C18 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 00000C1C F819 0B01       ldrb             r0,[m6502_pc],#1
  245 00000C20 EA4C 2C00       orr              addy,addy,r0,lsl#8
  369 00000C24                 opLSR
  440 00000C24                 [                _type = _ABS
  441 00000C24                 readmemabs
   83 00000C24 F40C 4160       and              r1,addy,#0xE000
   84 00000C28 F20F 0E08       adr              lr,%F0
   85 00000C2C         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00000C2C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00000C30 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00000C34         



ARM Macro Assembler    Page 57 


   89 00000C34         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  442 00000C34 0840            movs             r0,r0,lsr#1
  443 00000C36 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  444 00000C3A 4603            mov              m6502_nz,r0 ;Z, (N=0)
  445 00000C3C                 writememabs
  153 00000C3C F40C 4160       and              r1,addy,#0xe000
  154 00000C40 F10A 0224       adr              r2,writemem_tbl
  155 00000C44 F20F 0E08       adr              lr,%F0
  156 00000C48         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 00000C48 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 00000C4C F852 F001       ldr              pc,[r2,r1]
  159 00000C50         
  160 00000C50         0                                    ;out: r0,r1,r2,addy
                                                            =?
  446 00000C50                 ]
  447 00000C50                 [                _type = _ZP
  452                          ]
  453 00000C50                 [                _type = _ZPI
  464                          ]
  370 00000C50                 fetch_c          6
   62 00000C50         ;//-----------------------------------------------------
                       ----------------
   63 00000C50 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00000C54 F100 0006       add              r0,r0,#6
   65 00000C58 F8CA 00A0       str              r0,clocksh
   66 00000C5C         
   67 00000C5C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00000C60         ;//-----------------------------------------------------
                       --------------------
   69 00000C60 F578 68C0       sbcs             cycles,cycles,#6*256 
                                                            ;//CYCLE=256
   70 00000C64 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00000C6A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00000C6A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00000C6E F8DA F088       ldr              pc,nexttimeout
  371 00000C72         ;-------------------------------------------------------
                       ---------------------
  372 00000C72         _50                                  ;   BVC *
  373 00000C72         ;-------------------------------------------------------
                       ---------------------
  374 00000C72 F018 0F40       tst              cycles,#CYC_V
  375 00000C76 F919 0B01       ldrsb            r0,[m6502_pc],#1
  376 00000C7A BF04 4481       addeq            m6502_pc,m6502_pc,r0
  377 00000C7E         ; subeq cycles,cycles,#3*CYCLE
  378 00000C7E F5A8 7880       subeq            cycles,cycles,#256
  379 00000C82                 fetch            2
   46 00000C82         ;//-----------------------------------------------------
                       ----------------
   47 00000C82 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö



ARM Macro Assembler    Page 58 


                                                            ÓÊý
   48 00000C86 F100 0002       add              r0,r0,#2
   49 00000C8A F8CA 00A0       str              r0,clocksh
   50 00000C8E         
   51 00000C8E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000C92         ;//-----------------------------------------------------
                       --------------------
   53 00000C92 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000C96 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000C9C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000C9C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000CA0 F8DA F088       ldr              pc,nexttimeout
  380 00000CA4         ;-------------------------------------------------------
                       ---------------------
  381 00000CA4         _51                                  ;   EOR ($nn),Y
  382 00000CA4         ;-------------------------------------------------------
                       ---------------------
  383 00000CA4                 doIIY
  292 00000CA4 00000004 
                       _type   SETA             _ABS
  293 00000CA4 F819 0B01       ldrb             r0,[m6502_pc],#1
  294 00000CA8         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  295 00000CA8         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  296 00000CA8 F810 C00B       ldrb             addy,[r0,cpu_zpage]
  297 00000CAC 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  298 00000CAE         
  299 00000CAE         
  300 00000CAE 7841            ldrb             r1,[r0,#1]
  301 00000CB0 EA4C 2C01       orr              addy,addy,r1,lsl#8
  302 00000CB4 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  303 00000CB8         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
  384 00000CB8                 opEOR
  419 00000CB8                 readmem
  122 00000CB8                 [                _type = _ABS
  123 00000CB8                 readmemabs
   83 00000CB8 F40C 4160       and              r1,addy,#0xE000
   84 00000CBC F20F 0E08       adr              lr,%F0
   85 00000CC0         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00000CC0 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00000CC4 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00000CC8         
   89 00000CC8         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions



ARM Macro Assembler    Page 59 


  124 00000CC8                 ]
  125 00000CC8                 [                _type = _ZP
  127                          ]
  128 00000CC8                 [                _type = _ZPI
  130                          ]
  131 00000CC8                 [                _type = _IMM
  133                          ]
  420 00000CC8 EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24
  421 00000CCC EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  385 00000CD0                 fetch            5
   46 00000CD0         ;//-----------------------------------------------------
                       ----------------
   47 00000CD0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000CD4 F100 0005       add              r0,r0,#5
   49 00000CD8 F8CA 00A0       str              r0,clocksh
   50 00000CDC         
   51 00000CDC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000CE0         ;//-----------------------------------------------------
                       --------------------
   53 00000CE0 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000CE4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000CEA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000CEA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000CEE F8DA F088       ldr              pc,nexttimeout
  386 00000CF2         ;-------------------------------------------------------
                       ---------------------
  387 00000CF2         _55                                  ;   EOR $nn,X
  388 00000CF2         ;-------------------------------------------------------
                       ---------------------
  389 00000CF2                 doZIXf
  342 00000CF2 00000003 
                       _type   SETA             _ZPI
  343 00000CF2 F819 CB01       ldrb             addy,[m6502_pc],#1
  344 00000CF6 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  390 00000CFA                 opEOR
  419 00000CFA                 readmem
  122 00000CFA                 [                _type = _ABS
  124                          ]
  125 00000CFA                 [                _type = _ZP
  127                          ]
  128 00000CFA                 [                _type = _ZPI
  129 00000CFA                 readmemzpi
   99 00000CFA         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  100 00000CFA EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  101 00000CFE F81B 0000       ldrb             r0,[cpu_zpage,r0]
  102 00000D02         
  130 00000D02                 ]
  131 00000D02                 [                _type = _IMM
  133                          ]
  420 00000D02 EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24



ARM Macro Assembler    Page 60 


  421 00000D06 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  391 00000D0A                 fetch            4
   46 00000D0A         ;//-----------------------------------------------------
                       ----------------
   47 00000D0A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000D0E F100 0004       add              r0,r0,#4
   49 00000D12 F8CA 00A0       str              r0,clocksh
   50 00000D16         
   51 00000D16 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000D1A         ;//-----------------------------------------------------
                       --------------------
   53 00000D1A F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000D1E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000D24         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000D24 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000D28 F8DA F088       ldr              pc,nexttimeout
  392 00000D2C         ;-------------------------------------------------------
                       ---------------------
  393 00000D2C         _56                                  ;   LSR $nn,X
  394 00000D2C         ;-------------------------------------------------------
                       ---------------------
  395 00000D2C                 doZIXf
  342 00000D2C 00000003 
                       _type   SETA             _ZPI
  343 00000D2C F819 CB01       ldrb             addy,[m6502_pc],#1
  344 00000D30 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  396 00000D34                 opLSR
  440 00000D34                 [                _type = _ABS
  446                          ]
  447 00000D34                 [                _type = _ZP
  452                          ]
  453 00000D34                 [                _type = _ZPI
  454 00000D34         ;//  ldrb m6502_nz,[cpu_zpage,addy,lsr#24]
  455 00000D34 EA4F 631C       lsr              m6502_nz,addy,#24 
                                                            ;//¸Ä¹ý£¬¼Ó2ÐÐ
  456 00000D38 F81B 3003       ldrb             m6502_nz,[cpu_zpage,m6502_nz]
  457 00000D3C         
  458 00000D3C 085B            movs             m6502_nz,m6502_nz,lsr#1 
                                                            ;Z, (N=0)
  459 00000D3E F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  460 00000D42         ;//  strb m6502_nz,[cpu_zpage,addy,lsr#24]
  461 00000D42 EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ
  462 00000D46 F80B 3001       strb             m6502_nz,[cpu_zpage,r1]
  463 00000D4A         
  464 00000D4A                 ]
  397 00000D4A                 fetch_c          6
   62 00000D4A         ;//-----------------------------------------------------
                       ----------------
   63 00000D4A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö



ARM Macro Assembler    Page 61 


                                                            ÓÊý
   64 00000D4E F100 0006       add              r0,r0,#6
   65 00000D52 F8CA 00A0       str              r0,clocksh
   66 00000D56         
   67 00000D56 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00000D5A         ;//-----------------------------------------------------
                       --------------------
   69 00000D5A F578 68C0       sbcs             cycles,cycles,#6*256 
                                                            ;//CYCLE=256
   70 00000D5E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00000D64         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00000D64 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00000D68 F8DA F088       ldr              pc,nexttimeout
  398 00000D6C         ;-------------------------------------------------------
                       ---------------------
  399 00000D6C         _58                                  ;   CLI
  400 00000D6C         ;-------------------------------------------------------
                       ---------------------
  401 00000D6C F028 0804       bic              cycles,cycles,#CYC_I
  402 00000D70                 fetch            2
   46 00000D70         ;//-----------------------------------------------------
                       ----------------
   47 00000D70 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000D74 F100 0002       add              r0,r0,#2
   49 00000D78 F8CA 00A0       str              r0,clocksh
   50 00000D7C         
   51 00000D7C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000D80         ;//-----------------------------------------------------
                       --------------------
   53 00000D80 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000D84 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000D8A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000D8A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000D8E F8DA F088       ldr              pc,nexttimeout
  403 00000D92         ;-------------------------------------------------------
                       ---------------------
  404 00000D92         _59                                  ;   EOR $nnnn,Y
  405 00000D92         ;-------------------------------------------------------
                       ---------------------
  406 00000D92                 doAIY
  260 00000D92 00000004 
                       _type   SETA             _ABS
  261 00000D92 F819 CB01       ldrb             addy,[m6502_pc],#1
  262 00000D96 F819 0B01       ldrb             r0,[m6502_pc],#1
  263 00000D9A EA4C 2C00       orr              addy,addy,r0,lsl#8
  264 00000D9E EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  265 00000DA2         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
  407 00000DA2                 opEOR



ARM Macro Assembler    Page 62 


  419 00000DA2                 readmem
  122 00000DA2                 [                _type = _ABS
  123 00000DA2                 readmemabs
   83 00000DA2 F40C 4160       and              r1,addy,#0xE000
   84 00000DA6 F20F 0E0A       adr              lr,%F0
   85 00000DAA         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00000DAA EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00000DAE F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00000DB2         
   89 00000DB2         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00000DB2                 ]
  125 00000DB2                 [                _type = _ZP
  127                          ]
  128 00000DB2                 [                _type = _ZPI
  130                          ]
  131 00000DB2                 [                _type = _IMM
  133                          ]
  420 00000DB2 EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24
  421 00000DB6 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  408 00000DBA                 fetch            4
   46 00000DBA         ;//-----------------------------------------------------
                       ----------------
   47 00000DBA F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000DBE F100 0004       add              r0,r0,#4
   49 00000DC2 F8CA 00A0       str              r0,clocksh
   50 00000DC6         
   51 00000DC6 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000DCA         ;//-----------------------------------------------------
                       --------------------
   53 00000DCA F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000DCE BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000DD4         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000DD4 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000DD8 F8DA F088       ldr              pc,nexttimeout
  409 00000DDC         ;-------------------------------------------------------
                       ---------------------
  410 00000DDC         _5D                                  ;   EOR $nnnn,X
  411 00000DDC         ;-------------------------------------------------------
                       ---------------------
  412 00000DDC                 doAIX
  250 00000DDC 00000004 
                       _type   SETA             _ABS
  251 00000DDC F819 CB01       ldrb             addy,[m6502_pc],#1
  252 00000DE0 F819 0B01       ldrb             r0,[m6502_pc],#1



ARM Macro Assembler    Page 63 


  253 00000DE4 EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 00000DE8 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 00000DEC         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  413 00000DEC                 opEOR
  419 00000DEC                 readmem
  122 00000DEC                 [                _type = _ABS
  123 00000DEC                 readmemabs
   83 00000DEC F40C 4160       and              r1,addy,#0xE000
   84 00000DF0 F20F 0E08       adr              lr,%F0
   85 00000DF4         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00000DF4 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00000DF8 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00000DFC         
   89 00000DFC         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00000DFC                 ]
  125 00000DFC                 [                _type = _ZP
  127                          ]
  128 00000DFC                 [                _type = _ZPI
  130                          ]
  131 00000DFC                 [                _type = _IMM
  133                          ]
  420 00000DFC EA85 6500       eor              m6502_a,m6502_a,r0,lsl#24
  421 00000E00 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  414 00000E04                 fetch            4
   46 00000E04         ;//-----------------------------------------------------
                       ----------------
   47 00000E04 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000E08 F100 0004       add              r0,r0,#4
   49 00000E0C F8CA 00A0       str              r0,clocksh
   50 00000E10         
   51 00000E10 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000E14         ;//-----------------------------------------------------
                       --------------------
   53 00000E14 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000E18 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000E1E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000E1E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000E22 F8DA F088       ldr              pc,nexttimeout
  415 00000E26         ;-------------------------------------------------------
                       ---------------------
  416 00000E26         _5E                                  ;   LSR $nnnn,X
  417 00000E26         ;-------------------------------------------------------
                       ---------------------
  418 00000E26                 doAIX



ARM Macro Assembler    Page 64 


  250 00000E26 00000004 
                       _type   SETA             _ABS
  251 00000E26 F819 CB01       ldrb             addy,[m6502_pc],#1
  252 00000E2A F819 0B01       ldrb             r0,[m6502_pc],#1
  253 00000E2E EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 00000E32 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 00000E36         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  419 00000E36                 opLSR
  440 00000E36                 [                _type = _ABS
  441 00000E36                 readmemabs
   83 00000E36 F40C 4160       and              r1,addy,#0xE000
   84 00000E3A F20F 0E0A       adr              lr,%F0
   85 00000E3E         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00000E3E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00000E42 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00000E46         
   89 00000E46         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  442 00000E46 0840            movs             r0,r0,lsr#1
  443 00000E48 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  444 00000E4C 4603            mov              m6502_nz,r0 ;Z, (N=0)
  445 00000E4E                 writememabs
  153 00000E4E F40C 4160       and              r1,addy,#0xe000
  154 00000E52 F10A 0224       adr              r2,writemem_tbl
  155 00000E56 F20F 0E0A       adr              lr,%F0
  156 00000E5A         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 00000E5A EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 00000E5E F852 F001       ldr              pc,[r2,r1]
  159 00000E62         
  160 00000E62         0                                    ;out: r0,r1,r2,addy
                                                            =?
  446 00000E62                 ]
  447 00000E62                 [                _type = _ZP
  452                          ]
  453 00000E62                 [                _type = _ZPI
  464                          ]
  420 00000E62                 fetch_c          7
   62 00000E62         ;//-----------------------------------------------------
                       ----------------
   63 00000E62 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00000E66 F100 0007       add              r0,r0,#7
   65 00000E6A F8CA 00A0       str              r0,clocksh
   66 00000E6E         
   67 00000E6E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00000E72         ;//-----------------------------------------------------
                       --------------------
   69 00000E72 F578 68E0       sbcs             cycles,cycles,#7*256 
                                                            ;//CYCLE=256
   70 00000E76 BF5C F819 



ARM Macro Assembler    Page 65 


              0B01             ldrplb           r0,[m6502_pc],#1
   71 00000E7C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00000E7C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00000E80 F8DA F088       ldr              pc,nexttimeout
  421 00000E84         ;-------------------------------------------------------
                       ---------------------
  422 00000E84         _60                                  ;   RTS
  423 00000E84         ;-------------------------------------------------------
                       ---------------------
  424 00000E84                 pop16
  210 00000E84 F89A 2080       ldrb             r2,m6502_s
  211 00000E88 F102 0202       add              r2,r2,#2
  212 00000E8C F88A 2080       strb             r2,m6502_s
  213 00000E90 F8DA 2080       ldr              r2,m6502_s
  214 00000E94 F812 0901       ldrb             r0,[r2],#-1
  215 00000E98 F442 7280       orr              r2,r2,#0x100
  216 00000E9C F892 9000       ldrb             m6502_pc,[r2]
  217 00000EA0 EA49 2900       orr              m6502_pc,m6502_pc,r0,lsl#8
  425 00000EA4 F109 0901       add              m6502_pc,m6502_pc,#1
  426 00000EA8                 encodePC
   15 00000EA8 F409 4160       and              r1,m6502_pc,#0xE000 ;//r9ºÍ0xe0
                                                            00°´Î»ÓëÔËËã
   16 00000EAC F10A 0244       adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ
                                                            Ö·¼ÓÔØµ½r2
   17 00000EB0         ;// ldr r0,[r2,r1,lsr#11]    ;//¸Ä¹ý£¬¼Ó2ÐÐ 
   18 00000EB0 EA4F 20D1       lsr              r0,r1,#11   ;//>>11Î»   r1/2048
                                                            
   19 00000EB4 5810            ldr              r0,[r2,r0]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
   20 00000EB6         
   21 00000EB6 F8CA 0084       str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
   22 00000EBA 4481            add              m6502_pc,m6502_pc,r0 
                                                            ;//m6502_pc+r0
  427 00000EBC                 fetch            6
   46 00000EBC         ;//-----------------------------------------------------
                       ----------------
   47 00000EBC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000EC0 F100 0006       add              r0,r0,#6
   49 00000EC4 F8CA 00A0       str              r0,clocksh
   50 00000EC8         
   51 00000EC8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000ECC         ;//-----------------------------------------------------
                       --------------------
   53 00000ECC F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000ED0 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000ED6         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000ED6 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000EDA F8DA F088       ldr              pc,nexttimeout
  428 00000EDE         ;-------------------------------------------------------



ARM Macro Assembler    Page 66 


                       ---------------------
  429 00000EDE         _61                                  ;   ADC ($nn,X)
  430 00000EDE         ;-------------------------------------------------------
                       ---------------------
  431 00000EDE                 doIIX
  275 00000EDE 00000004 
                       _type   SETA             _ABS
  276 00000EDE F819 0B01       ldrb             r0,[m6502_pc],#1
  277 00000EE2 EB06 6000       add              r0,m6502_x,r0,lsl#24
  278 00000EE6         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  279 00000EE6 EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  280 00000EEA F81B C00C       ldrb             addy,[cpu_zpage,addy]
  281 00000EEE         
  282 00000EEE F100 7080       add              r0,r0,#0x01000000
  283 00000EF2         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  284 00000EF2 EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  285 00000EF6 F81B 1001       ldrb             r1,[cpu_zpage,r1]
  286 00000EFA         
  287 00000EFA EA4C 2C01       orr              addy,addy,r1,lsl#8
  432 00000EFE                 opADC
  366 00000EFE                 readmem
  122 00000EFE                 [                _type = _ABS
  123 00000EFE                 readmemabs
   83 00000EFE F40C 4160       and              r1,addy,#0xE000
   84 00000F02 F20F 0E0A       adr              lr,%F0
   85 00000F06         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00000F06 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00000F0A F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00000F0E         
   89 00000F0E         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00000F0E                 ]
  125 00000F0E                 [                _type = _ZP
  127                          ]
  128 00000F0E                 [                _type = _ZPI
  130                          ]
  131 00000F0E                 [                _type = _IMM
  133                          ]
  367 00000F0E EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  368 00000F12 BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  369 00000F18 EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  370 00000F1C EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  371 00000F20 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  372 00000F24 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  433 00000F2A                 fetch_c          6
   62 00000F2A         ;//-----------------------------------------------------
                       ----------------
   63 00000F2A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö



ARM Macro Assembler    Page 67 


                                                            ÓÊý
   64 00000F2E F100 0006       add              r0,r0,#6
   65 00000F32 F8CA 00A0       str              r0,clocksh
   66 00000F36         
   67 00000F36 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00000F3A         ;//-----------------------------------------------------
                       --------------------
   69 00000F3A F578 68C0       sbcs             cycles,cycles,#6*256 
                                                            ;//CYCLE=256
   70 00000F3E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00000F44         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00000F44 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00000F48 F8DA F088       ldr              pc,nexttimeout
  434 00000F4C         ;-------------------------------------------------------
                       ---------------------
  435 00000F4C         _65                                  ;   ADC $nn
  436 00000F4C         ;-------------------------------------------------------
                       ---------------------
  437 00000F4C                 doZ
  322 00000F4C 00000002 
                       _type   SETA             _ZP
  323 00000F4C F819 CB01       ldrb             addy,[m6502_pc],#1
  438 00000F50                 opADC
  366 00000F50                 readmem
  122 00000F50                 [                _type = _ABS
  124                          ]
  125 00000F50                 [                _type = _ZP
  126 00000F50                 readmemzp
   94 00000F50 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  127 00000F54                 ]
  128 00000F54                 [                _type = _ZPI
  130                          ]
  131 00000F54                 [                _type = _IMM
  133                          ]
  367 00000F54 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  368 00000F58 BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  369 00000F5E EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  370 00000F62 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  371 00000F66 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  372 00000F6A BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  439 00000F70                 fetch_c          3
   62 00000F70         ;//-----------------------------------------------------
                       ----------------
   63 00000F70 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00000F74 F100 0003       add              r0,r0,#3
   65 00000F78 F8CA 00A0       str              r0,clocksh
   66 00000F7C         
   67 00000F7C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00000F80         ;//-----------------------------------------------------
                       --------------------
   69 00000F80 F578 7840       sbcs             cycles,cycles,#3*256 
                                                            ;//CYCLE=256



ARM Macro Assembler    Page 68 


   70 00000F84 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00000F8A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00000F8A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00000F8E F8DA F088       ldr              pc,nexttimeout
  440 00000F92         ;-------------------------------------------------------
                       ---------------------
  441 00000F92         _66                                  ;   ROR $nn
  442 00000F92         ;-------------------------------------------------------
                       ---------------------
  443 00000F92                 doZ
  322 00000F92 00000002 
                       _type   SETA             _ZP
  323 00000F92 F819 CB01       ldrb             addy,[m6502_pc],#1
  444 00000F96                 opROR
  486 00000F96                 readmem
  122 00000F96                 [                _type = _ABS
  124                          ]
  125 00000F96                 [                _type = _ZP
  126 00000F96                 readmemzp
   94 00000F96 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  127 00000F9A                 ]
  128 00000F9A                 [                _type = _ZPI
  130                          ]
  131 00000F9A                 [                _type = _IMM
  133                          ]
  487 00000F9A EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  488 00000F9E BF28 F440 
              7080             orrcs            r0,r0,#0x100
  489 00000FA4 0840            movs             r0,r0,lsr#1
  490 00000FA6 EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  491 00000FAA EB48 0808       adc              cycles,cycles,cycles ;Set C
  492 00000FAE                 writemem
  179 00000FAE                 [                _type = _ABS
  181                          ]
  182 00000FAE                 [                _type = _ZP
  183 00000FAE                 writememzp
  165 00000FAE F80B 000C       strb             r0,[cpu_zpage,addy]
  184 00000FB2                 ]
  185 00000FB2                 [                _type = _ZPI
  187                          ]
  445 00000FB2                 fetch            5
   46 00000FB2         ;//-----------------------------------------------------
                       ----------------
   47 00000FB2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000FB6 F100 0005       add              r0,r0,#5
   49 00000FBA F8CA 00A0       str              r0,clocksh
   50 00000FBE         
   51 00000FBE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000FC2         ;//-----------------------------------------------------
                       --------------------
   53 00000FC2 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000FC6 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ



ARM Macro Assembler    Page 69 


                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000FCC         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000FCC F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000FD0 F8DA F088       ldr              pc,nexttimeout
  446 00000FD4         ;-------------------------------------------------------
                       ---------------------
  447 00000FD4         _68                                  ;   PLA
  448 00000FD4         ;-------------------------------------------------------
                       ---------------------
  449 00000FD4                 pop8             m6502_nz
  222 00000FD4 F89A 2080       ldrb             r2,m6502_s
  223 00000FD8 F102 0201       add              r2,r2,#1
  224 00000FDC F88A 2080       strb             r2,m6502_s
  225 00000FE0 F442 7280       orr              r2,r2,#0x100
  226 00000FE4 F91B 3002       ldrsb            m6502_nz,[cpu_zpage,r2] ;signed
                                                             for PLA & PLP
  227 00000FE8         
  450 00000FE8 EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
  451 00000FEC                 fetch            4
   46 00000FEC         ;//-----------------------------------------------------
                       ----------------
   47 00000FEC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000FF0 F100 0004       add              r0,r0,#4
   49 00000FF4 F8CA 00A0       str              r0,clocksh
   50 00000FF8         
   51 00000FF8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000FFC         ;//-----------------------------------------------------
                       --------------------
   53 00000FFC F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001000 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001006         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001006 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000100A F8DA F088       ldr              pc,nexttimeout
  452 0000100E         ;-------------------------------------------------------
                       ---------------------
  453 0000100E         _69                                  ;   ADC #$nn
  454 0000100E         ;-------------------------------------------------------
                       ---------------------
  455 0000100E                 doIMM
  270 0000100E 00000001 
                       _type   SETA             _IMM
  456 0000100E                 opADC
  366 0000100E                 readmem
  122 0000100E                 [                _type = _ABS
  124                          ]
  125 0000100E                 [                _type = _ZP
  127                          ]
  128 0000100E                 [                _type = _ZPI



ARM Macro Assembler    Page 70 


  130                          ]
  131 0000100E                 [                _type = _IMM
  132 0000100E                 readmemimm
  112 0000100E F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  133 00001012                 ]
  367 00001012 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  368 00001016 BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  369 0000101C EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  370 00001020 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  371 00001024 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  372 00001028 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  457 0000102E                 fetch_c          2
   62 0000102E         ;//-----------------------------------------------------
                       ----------------
   63 0000102E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00001032 F100 0002       add              r0,r0,#2
   65 00001036 F8CA 00A0       str              r0,clocksh
   66 0000103A         
   67 0000103A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 0000103E         ;//-----------------------------------------------------
                       --------------------
   69 0000103E F578 7800       sbcs             cycles,cycles,#2*256 
                                                            ;//CYCLE=256
   70 00001042 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00001048         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00001048 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 0000104C F8DA F088       ldr              pc,nexttimeout
  458 00001050         ;-------------------------------------------------------
                       ---------------------
  459 00001050         _6A                                  ;   ROR
  460 00001050         ;-------------------------------------------------------
                       ---------------------
  461 00001050 EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  462 00001054 EA4F 0535       mov              m6502_a,m6502_a,rrx
  463 00001058 162B            movs             m6502_nz,m6502_a,asr#24 ;NZ
  464 0000105A F005 457F       and              m6502_a,m6502_a,#0xff000000
  465 0000105E EB48 0808       adc              cycles,cycles,cycles ;Set C
  466 00001062                 fetch            2
   46 00001062         ;//-----------------------------------------------------
                       ----------------
   47 00001062 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001066 F100 0002       add              r0,r0,#2
   49 0000106A F8CA 00A0       str              r0,clocksh
   50 0000106E         
   51 0000106E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001072         ;//-----------------------------------------------------
                       --------------------
   53 00001072 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001076 BF5C F819 



ARM Macro Assembler    Page 71 


              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000107C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000107C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001080 F8DA F088       ldr              pc,nexttimeout
  467 00001084         ;-------------------------------------------------------
                       ---------------------
  468 00001084         _6C                                  ;   JMP ($nnnn) JMP
                                                             ($data16) ¼ä½ÓÑ°Ö·
                                                             ******************
                                                            ***************
  469 00001084         ;-------------------------------------------------------
                       ---------------------  
  470 00001084                 doABS
  242 00001084 00000004 
                       _type   SETA             _ABS
  243 00001084 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 00001088 F819 0B01       ldrb             r0,[m6502_pc],#1
  245 0000108C EA4C 2C00       orr              addy,addy,r0,lsl#8
  471 00001090 F10A 0144       adr              r1,memmap_tbl
  472 00001094 F40C 4260       and              r2,addy,#0xE000 ;    
  473 00001098         ; ldr r1,[r1,r2,lsr#11]      ;>>11 addr&0x7FF
  474 00001098 EA4F 20D2       lsr              r0,r2,#11
  475 0000109C 5809            ldr              r1,[r1,r0]  ;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ
                                                            «ÒÆÁ¿¼Óµ½Rn ÖÐ,Æä½á
                                                            ¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´
                                                            ¢µØÖ·
  476 0000109E         
  477 0000109E F811 900C       ldrb             m6502_pc,[r1,addy] ;//ÈôÊ¹ÓÃºó×
                                                            º"!",Ôò½á¹ûÐ´»Øµ½Rn
                                                            ÖÐ
  478 000010A2 4461            add              r1,r1,addy
  479 000010A4         
  480 000010A4 7848            ldrb             r0,[r1,#1]
  481 000010A6 EA49 2900       orr              m6502_pc,m6502_pc,r0,lsl#8 ;m65
                                                            02_pc=r9Ê¹ÓÃORR Ö¸Á
                                                            î½«½üR9µÄ¸ß8 Î»Êý¾Ý
                                                            ÒÆÈëµ½R0µÍ8Î»
  482 000010AA                 encodePC
   15 000010AA F409 4160       and              r1,m6502_pc,#0xE000 ;//r9ºÍ0xe0
                                                            00°´Î»ÓëÔËËã
   16 000010AE F10A 0244       adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ
                                                            Ö·¼ÓÔØµ½r2
   17 000010B2         ;// ldr r0,[r2,r1,lsr#11]    ;//¸Ä¹ý£¬¼Ó2ÐÐ 
   18 000010B2 EA4F 20D1       lsr              r0,r1,#11   ;//>>11Î»   r1/2048
                                                            
   19 000010B6 5810            ldr              r0,[r2,r0]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
   20 000010B8         
   21 000010B8 F8CA 0084       str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
   22 000010BC 4481            add              m6502_pc,m6502_pc,r0 
                                                            ;//m6502_pc+r0
  483 000010BE                 fetch            5
   46 000010BE         ;//-----------------------------------------------------
                       ----------------



ARM Macro Assembler    Page 72 


   47 000010BE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000010C2 F100 0005       add              r0,r0,#5
   49 000010C6 F8CA 00A0       str              r0,clocksh
   50 000010CA         
   51 000010CA F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000010CE         ;//-----------------------------------------------------
                       --------------------
   53 000010CE F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000010D2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000010D8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000010D8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000010DC F8DA F088       ldr              pc,nexttimeout
  484 000010E0         ;-------------------------------------------------------
                       ---------------------
  485 000010E0         _6D                                  ;   ADC $nnnn
  486 000010E0         ;-------------------------------------------------------
                       ---------------------
  487 000010E0                 doABS
  242 000010E0 00000004 
                       _type   SETA             _ABS
  243 000010E0 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 000010E4 F819 0B01       ldrb             r0,[m6502_pc],#1
  245 000010E8 EA4C 2C00       orr              addy,addy,r0,lsl#8
  488 000010EC                 opADC
  366 000010EC                 readmem
  122 000010EC                 [                _type = _ABS
  123 000010EC                 readmemabs
   83 000010EC F40C 4160       and              r1,addy,#0xE000
   84 000010F0 F20F 0E08       adr              lr,%F0
   85 000010F4         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000010F4 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 000010F8 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 000010FC         
   89 000010FC         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 000010FC                 ]
  125 000010FC                 [                _type = _ZP
  127                          ]
  128 000010FC                 [                _type = _ZPI
  130                          ]
  131 000010FC                 [                _type = _IMM
  133                          ]
  367 000010FC EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  368 00001100 BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100



ARM Macro Assembler    Page 73 


  369 00001106 EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  370 0000110A EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  371 0000110E F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  372 00001112 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  489 00001118                 fetch_c          4
   62 00001118         ;//-----------------------------------------------------
                       ----------------
   63 00001118 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 0000111C F100 0004       add              r0,r0,#4
   65 00001120 F8CA 00A0       str              r0,clocksh
   66 00001124         
   67 00001124 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00001128         ;//-----------------------------------------------------
                       --------------------
   69 00001128 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   70 0000112C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00001132         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00001132 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00001136 F8DA F088       ldr              pc,nexttimeout
  490 0000113A         ;-------------------------------------------------------
                       ---------------------
  491 0000113A         _6E                                  ;   ROR $nnnn
  492 0000113A         ;-------------------------------------------------------
                       ---------------------
  493 0000113A                 doABS
  242 0000113A 00000004 
                       _type   SETA             _ABS
  243 0000113A F819 CB01       ldrb             addy,[m6502_pc],#1
  244 0000113E F819 0B01       ldrb             r0,[m6502_pc],#1
  245 00001142 EA4C 2C00       orr              addy,addy,r0,lsl#8
  494 00001146                 opROR
  486 00001146                 readmem
  122 00001146                 [                _type = _ABS
  123 00001146                 readmemabs
   83 00001146 F40C 4160       and              r1,addy,#0xE000
   84 0000114A F20F 0E0A       adr              lr,%F0
   85 0000114E         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 0000114E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001152 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001156         
   89 00001156         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00001156                 ]
  125 00001156                 [                _type = _ZP
  127                          ]
  128 00001156                 [                _type = _ZPI
  130                          ]
  131 00001156                 [                _type = _IMM



ARM Macro Assembler    Page 74 


  133                          ]
  487 00001156 EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  488 0000115A BF28 F440 
              7080             orrcs            r0,r0,#0x100
  489 00001160 0840            movs             r0,r0,lsr#1
  490 00001162 EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  491 00001166 EB48 0808       adc              cycles,cycles,cycles ;Set C
  492 0000116A                 writemem
  179 0000116A                 [                _type = _ABS
  180 0000116A                 writememabs
  153 0000116A F40C 4160       and              r1,addy,#0xe000
  154 0000116E F10A 0224       adr              r2,writemem_tbl
  155 00001172 F20F 0E0A       adr              lr,%F0
  156 00001176         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 00001176 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 0000117A F852 F001       ldr              pc,[r2,r1]
  159 0000117E         
  160 0000117E         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 0000117E                 ]
  182 0000117E                 [                _type = _ZP
  184                          ]
  185 0000117E                 [                _type = _ZPI
  187                          ]
  495 0000117E                 fetch            6
   46 0000117E         ;//-----------------------------------------------------
                       ----------------
   47 0000117E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001182 F100 0006       add              r0,r0,#6
   49 00001186 F8CA 00A0       str              r0,clocksh
   50 0000118A         
   51 0000118A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000118E         ;//-----------------------------------------------------
                       --------------------
   53 0000118E F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001192 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001198         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001198 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000119C F8DA F088       ldr              pc,nexttimeout
  496 000011A0         ;-------------------------------------------------------
                       ---------------------
  497 000011A0         _70                                  ;   BVS *
  498 000011A0         ;-------------------------------------------------------
                       ---------------------
  499 000011A0 F018 0F40       tst              cycles,#CYC_V
  500 000011A4 F919 0B01       ldrsb            r0,[m6502_pc],#1
  501 000011A8 BF1C 4481       addne            m6502_pc,m6502_pc,r0
  502 000011AC         ; subne cycles,cycles,#3*CYCLE



ARM Macro Assembler    Page 75 


  503 000011AC F5A8 7880       subne            cycles,cycles,#256
  504 000011B0                 fetch            2
   46 000011B0         ;//-----------------------------------------------------
                       ----------------
   47 000011B0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000011B4 F100 0002       add              r0,r0,#2
   49 000011B8 F8CA 00A0       str              r0,clocksh
   50 000011BC         
   51 000011BC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000011C0         ;//-----------------------------------------------------
                       --------------------
   53 000011C0 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000011C4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000011CA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000011CA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000011CE F8DA F088       ldr              pc,nexttimeout
  505 000011D2         ;-------------------------------------------------------
                       ---------------------
  506 000011D2         _71                                  ;   ADC ($nn),Y
  507 000011D2         ;-------------------------------------------------------
                       ---------------------
  508 000011D2                 doIIY
  292 000011D2 00000004 
                       _type   SETA             _ABS
  293 000011D2 F819 0B01       ldrb             r0,[m6502_pc],#1
  294 000011D6         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  295 000011D6         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  296 000011D6 F810 C00B       ldrb             addy,[r0,cpu_zpage]
  297 000011DA 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  298 000011DC         
  299 000011DC         
  300 000011DC 7841            ldrb             r1,[r0,#1]
  301 000011DE EA4C 2C01       orr              addy,addy,r1,lsl#8
  302 000011E2 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  303 000011E6         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
  509 000011E6                 opADC
  366 000011E6                 readmem
  122 000011E6                 [                _type = _ABS
  123 000011E6                 readmemabs
   83 000011E6 F40C 4160       and              r1,addy,#0xE000
   84 000011EA F20F 0E0A       adr              lr,%F0
   85 000011EE         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000011EE EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 000011F2 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 000011F6         



ARM Macro Assembler    Page 76 


   89 000011F6         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 000011F6                 ]
  125 000011F6                 [                _type = _ZP
  127                          ]
  128 000011F6                 [                _type = _ZPI
  130                          ]
  131 000011F6                 [                _type = _IMM
  133                          ]
  367 000011F6 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  368 000011FA BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  369 00001200 EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  370 00001204 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  371 00001208 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  372 0000120C BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  510 00001212                 fetch_c          5
   62 00001212         ;//-----------------------------------------------------
                       ----------------
   63 00001212 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00001216 F100 0005       add              r0,r0,#5
   65 0000121A F8CA 00A0       str              r0,clocksh
   66 0000121E         
   67 0000121E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00001222         ;//-----------------------------------------------------
                       --------------------
   69 00001222 F578 68A0       sbcs             cycles,cycles,#5*256 
                                                            ;//CYCLE=256
   70 00001226 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 0000122C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 0000122C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00001230 F8DA F088       ldr              pc,nexttimeout
  511 00001234         ;-------------------------------------------------------
                       ---------------------
  512 00001234         _75                                  ;   ADC $nn,X
  513 00001234         ;-------------------------------------------------------
                       ---------------------
  514 00001234                 doZIXf
  342 00001234 00000003 
                       _type   SETA             _ZPI
  343 00001234 F819 CB01       ldrb             addy,[m6502_pc],#1
  344 00001238 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  515 0000123C                 opADC
  366 0000123C                 readmem
  122 0000123C                 [                _type = _ABS
  124                          ]
  125 0000123C                 [                _type = _ZP
  127                          ]
  128 0000123C                 [                _type = _ZPI
  129 0000123C                 readmemzpi
   99 0000123C         ;// ldrb r0,[cpu_zpage,addy,lsr#24]



ARM Macro Assembler    Page 77 


  100 0000123C EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  101 00001240 F81B 0000       ldrb             r0,[cpu_zpage,r0]
  102 00001244         
  130 00001244                 ]
  131 00001244                 [                _type = _IMM
  133                          ]
  367 00001244 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  368 00001248 BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  369 0000124E EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  370 00001252 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  371 00001256 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  372 0000125A BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  516 00001260                 fetch_c          4
   62 00001260         ;//-----------------------------------------------------
                       ----------------
   63 00001260 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00001264 F100 0004       add              r0,r0,#4
   65 00001268 F8CA 00A0       str              r0,clocksh
   66 0000126C         
   67 0000126C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00001270         ;//-----------------------------------------------------
                       --------------------
   69 00001270 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   70 00001274 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 0000127A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 0000127A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 0000127E F8DA F088       ldr              pc,nexttimeout
  517 00001282         ;-------------------------------------------------------
                       ---------------------
  518 00001282         _76                                  ;   ROR $nn,X
  519 00001282         ;-------------------------------------------------------
                       ---------------------
  520 00001282                 doZIXf
  342 00001282 00000003 
                       _type   SETA             _ZPI
  343 00001282 F819 CB01       ldrb             addy,[m6502_pc],#1
  344 00001286 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  521 0000128A                 opROR
  486 0000128A                 readmem
  122 0000128A                 [                _type = _ABS
  124                          ]
  125 0000128A                 [                _type = _ZP
  127                          ]
  128 0000128A                 [                _type = _ZPI
  129 0000128A                 readmemzpi
   99 0000128A         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  100 0000128A EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  101 0000128E F81B 0000       ldrb             r0,[cpu_zpage,r0]
  102 00001292         
  130 00001292                 ]
  131 00001292                 [                _type = _IMM
  133                          ]



ARM Macro Assembler    Page 78 


  487 00001292 EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  488 00001296 BF28 F440 
              7080             orrcs            r0,r0,#0x100
  489 0000129C 0840            movs             r0,r0,lsr#1
  490 0000129E EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  491 000012A2 EB48 0808       adc              cycles,cycles,cycles ;Set C
  492 000012A6                 writemem
  179 000012A6                 [                _type = _ABS
  181                          ]
  182 000012A6                 [                _type = _ZP
  184                          ]
  185 000012A6                 [                _type = _ZPI
  186 000012A6                 writememzpi
  170 000012A6         ;// strb r0,[cpu_zpage,addy,lsr#24]
  171 000012A6 EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  172 000012AA F80B 0001       strb             r0,[cpu_zpage,r1]
  173 000012AE         
  174 000012AE         
  187 000012AE                 ]
  522 000012AE                 fetch            6
   46 000012AE         ;//-----------------------------------------------------
                       ----------------
   47 000012AE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000012B2 F100 0006       add              r0,r0,#6
   49 000012B6 F8CA 00A0       str              r0,clocksh
   50 000012BA         
   51 000012BA F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000012BE         ;//-----------------------------------------------------
                       --------------------
   53 000012BE F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000012C2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000012C8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000012C8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000012CC F8DA F088       ldr              pc,nexttimeout
  523 000012D0         ;-------------------------------------------------------
                       ---------------------
  524 000012D0         _78                                  ;   SEI
  525 000012D0         ;-------------------------------------------------------
                       ---------------------
  526 000012D0 F048 0804       orr              cycles,cycles,#CYC_I
  527 000012D4                 fetch            2
   46 000012D4         ;//-----------------------------------------------------
                       ----------------
   47 000012D4 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000012D8 F100 0002       add              r0,r0,#2
   49 000012DC F8CA 00A0       str              r0,clocksh
   50 000012E0         
   51 000012E0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ



ARM Macro Assembler    Page 79 


                                                            Ö·
   52 000012E4         ;//-----------------------------------------------------
                       --------------------
   53 000012E4 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000012E8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000012EE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000012EE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000012F2 F8DA F088       ldr              pc,nexttimeout
  528 000012F6         ;-------------------------------------------------------
                       ---------------------
  529 000012F6         _79                                  ;   ADC $nnnn,Y
  530 000012F6         ;-------------------------------------------------------
                       ---------------------
  531 000012F6                 doAIY
  260 000012F6 00000004 
                       _type   SETA             _ABS
  261 000012F6 F819 CB01       ldrb             addy,[m6502_pc],#1
  262 000012FA F819 0B01       ldrb             r0,[m6502_pc],#1
  263 000012FE EA4C 2C00       orr              addy,addy,r0,lsl#8
  264 00001302 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  265 00001306         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
  532 00001306                 opADC
  366 00001306                 readmem
  122 00001306                 [                _type = _ABS
  123 00001306                 readmemabs
   83 00001306 F40C 4160       and              r1,addy,#0xE000
   84 0000130A F20F 0E0A       adr              lr,%F0
   85 0000130E         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 0000130E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001312 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001316         
   89 00001316         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00001316                 ]
  125 00001316                 [                _type = _ZP
  127                          ]
  128 00001316                 [                _type = _ZPI
  130                          ]
  131 00001316                 [                _type = _IMM
  133                          ]
  367 00001316 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  368 0000131A BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  369 00001320 EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  370 00001324 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  371 00001328 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V



ARM Macro Assembler    Page 80 


  372 0000132C BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  533 00001332                 fetch_c          4
   62 00001332         ;//-----------------------------------------------------
                       ----------------
   63 00001332 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00001336 F100 0004       add              r0,r0,#4
   65 0000133A F8CA 00A0       str              r0,clocksh
   66 0000133E         
   67 0000133E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00001342         ;//-----------------------------------------------------
                       --------------------
   69 00001342 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   70 00001346 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 0000134C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 0000134C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00001350 F8DA F088       ldr              pc,nexttimeout
  534 00001354         ;-------------------------------------------------------
                       ---------------------
  535 00001354         _7D                                  ;   ADC $nnnn,X
  536 00001354         ;-------------------------------------------------------
                       ---------------------
  537 00001354                 doAIX
  250 00001354 00000004 
                       _type   SETA             _ABS
  251 00001354 F819 CB01       ldrb             addy,[m6502_pc],#1
  252 00001358 F819 0B01       ldrb             r0,[m6502_pc],#1
  253 0000135C EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 00001360 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 00001364         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  538 00001364                 opADC
  366 00001364                 readmem
  122 00001364                 [                _type = _ABS
  123 00001364                 readmemabs
   83 00001364 F40C 4160       and              r1,addy,#0xE000
   84 00001368 F20F 0E08       adr              lr,%F0
   85 0000136C         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 0000136C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001370 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001374         
   89 00001374         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00001374                 ]
  125 00001374                 [                _type = _ZP
  127                          ]
  128 00001374                 [                _type = _ZPI
  130                          ]
  131 00001374                 [                _type = _IMM
  133                          ]
  367 00001374 EA5F 0158       movs             r1,cycles,lsr#1 ;get C



ARM Macro Assembler    Page 81 


  368 00001378 BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  369 0000137E EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  370 00001382 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  371 00001386 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  372 0000138A BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  539 00001390                 fetch_c          4
   62 00001390         ;//-----------------------------------------------------
                       ----------------
   63 00001390 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00001394 F100 0004       add              r0,r0,#4
   65 00001398 F8CA 00A0       str              r0,clocksh
   66 0000139C         
   67 0000139C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 000013A0         ;//-----------------------------------------------------
                       --------------------
   69 000013A0 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   70 000013A4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 000013AA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 000013AA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 000013AE F8DA F088       ldr              pc,nexttimeout
  540 000013B2         ;-------------------------------------------------------
                       ---------------------
  541 000013B2         _7E                                  ;   ROR $nnnn,X
  542 000013B2         ;-------------------------------------------------------
                       ---------------------
  543 000013B2                 doAIX
  250 000013B2 00000004 
                       _type   SETA             _ABS
  251 000013B2 F819 CB01       ldrb             addy,[m6502_pc],#1
  252 000013B6 F819 0B01       ldrb             r0,[m6502_pc],#1
  253 000013BA EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 000013BE EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 000013C2         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  544 000013C2                 opROR
  486 000013C2                 readmem
  122 000013C2                 [                _type = _ABS
  123 000013C2                 readmemabs
   83 000013C2 F40C 4160       and              r1,addy,#0xE000
   84 000013C6 F20F 0E0A       adr              lr,%F0
   85 000013CA         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000013CA EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 000013CE F854 F001       ldr              pc,[m6502_rmem,r1]
   88 000013D2         
   89 000013D2         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 000013D2                 ]
  125 000013D2                 [                _type = _ZP



ARM Macro Assembler    Page 82 


  127                          ]
  128 000013D2                 [                _type = _ZPI
  130                          ]
  131 000013D2                 [                _type = _IMM
  133                          ]
  487 000013D2 EA5F 0858       movs             cycles,cycles,lsr#1 ;get C
  488 000013D6 BF28 F440 
              7080             orrcs            r0,r0,#0x100
  489 000013DC 0840            movs             r0,r0,lsr#1
  490 000013DE EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  491 000013E2 EB48 0808       adc              cycles,cycles,cycles ;Set C
  492 000013E6                 writemem
  179 000013E6                 [                _type = _ABS
  180 000013E6                 writememabs
  153 000013E6 F40C 4160       and              r1,addy,#0xe000
  154 000013EA F10A 0224       adr              r2,writemem_tbl
  155 000013EE F20F 0E0A       adr              lr,%F0
  156 000013F2         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 000013F2 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 000013F6 F852 F001       ldr              pc,[r2,r1]
  159 000013FA         
  160 000013FA         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 000013FA                 ]
  182 000013FA                 [                _type = _ZP
  184                          ]
  185 000013FA                 [                _type = _ZPI
  187                          ]
  545 000013FA                 fetch            7
   46 000013FA         ;//-----------------------------------------------------
                       ----------------
   47 000013FA F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000013FE F100 0007       add              r0,r0,#7
   49 00001402 F8CA 00A0       str              r0,clocksh
   50 00001406         
   51 00001406 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000140A         ;//-----------------------------------------------------
                       --------------------
   53 0000140A F5B8 68E0       subs             cycles,cycles,#7*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000140E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001414         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001414 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001418 F8DA F088       ldr              pc,nexttimeout
  546 0000141C         ;-------------------------------------------------------
                       ---------------------
  547 0000141C         _81                                  ;   STA ($nn,X)
  548 0000141C         ;-------------------------------------------------------
                       ---------------------



ARM Macro Assembler    Page 83 


  549 0000141C                 doIIX
  275 0000141C 00000004 
                       _type   SETA             _ABS
  276 0000141C F819 0B01       ldrb             r0,[m6502_pc],#1
  277 00001420 EB06 6000       add              r0,m6502_x,r0,lsl#24
  278 00001424         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  279 00001424 EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  280 00001428 F81B C00C       ldrb             addy,[cpu_zpage,addy]
  281 0000142C         
  282 0000142C F100 7080       add              r0,r0,#0x01000000
  283 00001430         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  284 00001430 EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  285 00001434 F81B 1001       ldrb             r1,[cpu_zpage,r1]
  286 00001438         
  287 00001438 EA4C 2C01       orr              addy,addy,r1,lsl#8
  550 0000143C                 opSTORE          m6502_a
  508 0000143C EA4F 6015       mov              r0,m6502_a,lsr#24
  509 00001440                 writemem
  179 00001440                 [                _type = _ABS
  180 00001440                 writememabs
  153 00001440 F40C 4160       and              r1,addy,#0xe000
  154 00001444 F10A 0224       adr              r2,writemem_tbl
  155 00001448 F20F 0E08       adr              lr,%F0
  156 0000144C         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 0000144C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 00001450 F852 F001       ldr              pc,[r2,r1]
  159 00001454         
  160 00001454         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 00001454                 ]
  182 00001454                 [                _type = _ZP
  184                          ]
  185 00001454                 [                _type = _ZPI
  187                          ]
  551 00001454                 fetch            6
   46 00001454         ;//-----------------------------------------------------
                       ----------------
   47 00001454 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001458 F100 0006       add              r0,r0,#6
   49 0000145C F8CA 00A0       str              r0,clocksh
   50 00001460         
   51 00001460 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001464         ;//-----------------------------------------------------
                       --------------------
   53 00001464 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001468 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000146E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0



ARM Macro Assembler    Page 84 


                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000146E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001472 F8DA F088       ldr              pc,nexttimeout
  552 00001476         ;-------------------------------------------------------
                       ---------------------
  553 00001476         _84                                  ;   STY $nn
  554 00001476         ;-------------------------------------------------------
                       ---------------------
  555 00001476                 doZ
  322 00001476 00000002 
                       _type   SETA             _ZP
  323 00001476 F819 CB01       ldrb             addy,[m6502_pc],#1
  556 0000147A                 opSTORE          m6502_y
  508 0000147A EA4F 6017       mov              r0,m6502_y,lsr#24
  509 0000147E                 writemem
  179 0000147E                 [                _type = _ABS
  181                          ]
  182 0000147E                 [                _type = _ZP
  183 0000147E                 writememzp
  165 0000147E F80B 000C       strb             r0,[cpu_zpage,addy]
  184 00001482                 ]
  185 00001482                 [                _type = _ZPI
  187                          ]
  557 00001482                 fetch            3
   46 00001482         ;//-----------------------------------------------------
                       ----------------
   47 00001482 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001486 F100 0003       add              r0,r0,#3
   49 0000148A F8CA 00A0       str              r0,clocksh
   50 0000148E         
   51 0000148E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001492         ;//-----------------------------------------------------
                       --------------------
   53 00001492 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001496 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000149C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000149C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000014A0 F8DA F088       ldr              pc,nexttimeout
  558 000014A4         ;-------------------------------------------------------
                       ---------------------
  559 000014A4         _85                                  ;   STA $nn
  560 000014A4         ;-------------------------------------------------------
                       ---------------------
  561 000014A4                 doZ
  322 000014A4 00000002 
                       _type   SETA             _ZP
  323 000014A4 F819 CB01       ldrb             addy,[m6502_pc],#1
  562 000014A8                 opSTORE          m6502_a
  508 000014A8 EA4F 6015       mov              r0,m6502_a,lsr#24



ARM Macro Assembler    Page 85 


  509 000014AC                 writemem
  179 000014AC                 [                _type = _ABS
  181                          ]
  182 000014AC                 [                _type = _ZP
  183 000014AC                 writememzp
  165 000014AC F80B 000C       strb             r0,[cpu_zpage,addy]
  184 000014B0                 ]
  185 000014B0                 [                _type = _ZPI
  187                          ]
  563 000014B0                 fetch            3
   46 000014B0         ;//-----------------------------------------------------
                       ----------------
   47 000014B0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000014B4 F100 0003       add              r0,r0,#3
   49 000014B8 F8CA 00A0       str              r0,clocksh
   50 000014BC         
   51 000014BC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000014C0         ;//-----------------------------------------------------
                       --------------------
   53 000014C0 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000014C4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000014CA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000014CA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000014CE F8DA F088       ldr              pc,nexttimeout
  564 000014D2         ;-------------------------------------------------------
                       ---------------------
  565 000014D2         _86                                  ;   STX $nn
  566 000014D2         ;-------------------------------------------------------
                       ---------------------
  567 000014D2                 doZ
  322 000014D2 00000002 
                       _type   SETA             _ZP
  323 000014D2 F819 CB01       ldrb             addy,[m6502_pc],#1
  568 000014D6                 opSTORE          m6502_x
  508 000014D6 EA4F 6016       mov              r0,m6502_x,lsr#24
  509 000014DA                 writemem
  179 000014DA                 [                _type = _ABS
  181                          ]
  182 000014DA                 [                _type = _ZP
  183 000014DA                 writememzp
  165 000014DA F80B 000C       strb             r0,[cpu_zpage,addy]
  184 000014DE                 ]
  185 000014DE                 [                _type = _ZPI
  187                          ]
  569 000014DE                 fetch            3
   46 000014DE         ;//-----------------------------------------------------
                       ----------------
   47 000014DE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000014E2 F100 0003       add              r0,r0,#3



ARM Macro Assembler    Page 86 


   49 000014E6 F8CA 00A0       str              r0,clocksh
   50 000014EA         
   51 000014EA F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000014EE         ;//-----------------------------------------------------
                       --------------------
   53 000014EE F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000014F2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000014F8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000014F8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000014FC F8DA F088       ldr              pc,nexttimeout
  570 00001500         ;-------------------------------------------------------
                       ---------------------
  571 00001500         _88                                  ;   DEY
  572 00001500         ;-------------------------------------------------------
                       ---------------------
  573 00001500 F1A7 7780       sub              m6502_y,m6502_y,#0x01000000
  574 00001504 EA4F 6327       mov              m6502_nz,m6502_y,asr#24
  575 00001508                 fetch            2
   46 00001508         ;//-----------------------------------------------------
                       ----------------
   47 00001508 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000150C F100 0002       add              r0,r0,#2
   49 00001510 F8CA 00A0       str              r0,clocksh
   50 00001514         
   51 00001514 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001518         ;//-----------------------------------------------------
                       --------------------
   53 00001518 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000151C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001522         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001522 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001526 F8DA F088       ldr              pc,nexttimeout
  576 0000152A         ;-------------------------------------------------------
                       ---------------------
  577 0000152A         _8A                                  ;   TXA
  578 0000152A         ;-------------------------------------------------------
                       ---------------------
  579 0000152A 4635            mov              m6502_a,m6502_x
  580 0000152C EA4F 6326       mov              m6502_nz,m6502_x,asr#24
  581 00001530                 fetch            2
   46 00001530         ;//-----------------------------------------------------
                       ----------------



ARM Macro Assembler    Page 87 


   47 00001530 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001534 F100 0002       add              r0,r0,#2
   49 00001538 F8CA 00A0       str              r0,clocksh
   50 0000153C         
   51 0000153C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001540         ;//-----------------------------------------------------
                       --------------------
   53 00001540 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001544 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000154A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000154A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000154E F8DA F088       ldr              pc,nexttimeout
  582 00001552         ;-------------------------------------------------------
                       ---------------------
  583 00001552         _8C                                  ;   STY $nnnn
  584 00001552         ;-------------------------------------------------------
                       ---------------------
  585 00001552                 doABS
  242 00001552 00000004 
                       _type   SETA             _ABS
  243 00001552 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 00001556 F819 0B01       ldrb             r0,[m6502_pc],#1
  245 0000155A EA4C 2C00       orr              addy,addy,r0,lsl#8
  586 0000155E                 opSTORE          m6502_y
  508 0000155E EA4F 6017       mov              r0,m6502_y,lsr#24
  509 00001562                 writemem
  179 00001562                 [                _type = _ABS
  180 00001562                 writememabs
  153 00001562 F40C 4160       and              r1,addy,#0xe000
  154 00001566 F10A 0224       adr              r2,writemem_tbl
  155 0000156A F20F 0E0A       adr              lr,%F0
  156 0000156E         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 0000156E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 00001572 F852 F001       ldr              pc,[r2,r1]
  159 00001576         
  160 00001576         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 00001576                 ]
  182 00001576                 [                _type = _ZP
  184                          ]
  185 00001576                 [                _type = _ZPI
  187                          ]
  587 00001576                 fetch            4
   46 00001576         ;//-----------------------------------------------------
                       ----------------
   47 00001576 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000157A F100 0004       add              r0,r0,#4



ARM Macro Assembler    Page 88 


   49 0000157E F8CA 00A0       str              r0,clocksh
   50 00001582         
   51 00001582 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001586         ;//-----------------------------------------------------
                       --------------------
   53 00001586 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000158A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001590         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001590 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001594 F8DA F088       ldr              pc,nexttimeout
  588 00001598         ;-------------------------------------------------------
                       ---------------------
  589 00001598         _8D                                  ;   STA $nnnn
  590 00001598         ;-------------------------------------------------------
                       ---------------------
  591 00001598                 doABS
  242 00001598 00000004 
                       _type   SETA             _ABS
  243 00001598 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 0000159C F819 0B01       ldrb             r0,[m6502_pc],#1
  245 000015A0 EA4C 2C00       orr              addy,addy,r0,lsl#8
  592 000015A4                 opSTORE          m6502_a
  508 000015A4 EA4F 6015       mov              r0,m6502_a,lsr#24
  509 000015A8                 writemem
  179 000015A8                 [                _type = _ABS
  180 000015A8                 writememabs
  153 000015A8 F40C 4160       and              r1,addy,#0xe000
  154 000015AC F10A 0224       adr              r2,writemem_tbl
  155 000015B0 F20F 0E08       adr              lr,%F0
  156 000015B4         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 000015B4 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 000015B8 F852 F001       ldr              pc,[r2,r1]
  159 000015BC         
  160 000015BC         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 000015BC                 ]
  182 000015BC                 [                _type = _ZP
  184                          ]
  185 000015BC                 [                _type = _ZPI
  187                          ]
  593 000015BC                 fetch            4
   46 000015BC         ;//-----------------------------------------------------
                       ----------------
   47 000015BC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000015C0 F100 0004       add              r0,r0,#4
   49 000015C4 F8CA 00A0       str              r0,clocksh
   50 000015C8         
   51 000015C8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ



ARM Macro Assembler    Page 89 


                                                            Ö·
   52 000015CC         ;//-----------------------------------------------------
                       --------------------
   53 000015CC F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000015D0 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000015D6         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000015D6 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000015DA F8DA F088       ldr              pc,nexttimeout
  594 000015DE         ;-------------------------------------------------------
                       ---------------------
  595 000015DE         _8E                                  ;   STX $nnnn
  596 000015DE         ;-------------------------------------------------------
                       ---------------------
  597 000015DE                 doABS
  242 000015DE 00000004 
                       _type   SETA             _ABS
  243 000015DE F819 CB01       ldrb             addy,[m6502_pc],#1
  244 000015E2 F819 0B01       ldrb             r0,[m6502_pc],#1
  245 000015E6 EA4C 2C00       orr              addy,addy,r0,lsl#8
  598 000015EA                 opSTORE          m6502_x
  508 000015EA EA4F 6016       mov              r0,m6502_x,lsr#24
  509 000015EE                 writemem
  179 000015EE                 [                _type = _ABS
  180 000015EE                 writememabs
  153 000015EE F40C 4160       and              r1,addy,#0xe000
  154 000015F2 F10A 0224       adr              r2,writemem_tbl
  155 000015F6 F20F 0E0A       adr              lr,%F0
  156 000015FA         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 000015FA EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 000015FE F852 F001       ldr              pc,[r2,r1]
  159 00001602         
  160 00001602         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 00001602                 ]
  182 00001602                 [                _type = _ZP
  184                          ]
  185 00001602                 [                _type = _ZPI
  187                          ]
  599 00001602                 fetch            4
   46 00001602         ;//-----------------------------------------------------
                       ----------------
   47 00001602 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001606 F100 0004       add              r0,r0,#4
   49 0000160A F8CA 00A0       str              r0,clocksh
   50 0000160E         
   51 0000160E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001612         ;//-----------------------------------------------------
                       --------------------



ARM Macro Assembler    Page 90 


   53 00001612 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001616 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000161C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000161C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001620 F8DA F088       ldr              pc,nexttimeout
  600 00001624         ;-------------------------------------------------------
                       ---------------------
  601 00001624         _90                                  ;   BCC *
  602 00001624         ;-------------------------------------------------------
                       ---------------------
  603 00001624 F018 0F01       tst              cycles,#CYC_C ;Test Carry
  604 00001628 F919 0B01       ldrsb            r0,[m6502_pc],#1
  605 0000162C BF04 4481       addeq            m6502_pc,m6502_pc,r0
  606 00001630         ; subeq cycles,cycles,#3*CYCLE
  607 00001630 F5A8 7880       subeq            cycles,cycles,#256
  608 00001634                 fetch            2
   46 00001634         ;//-----------------------------------------------------
                       ----------------
   47 00001634 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001638 F100 0002       add              r0,r0,#2
   49 0000163C F8CA 00A0       str              r0,clocksh
   50 00001640         
   51 00001640 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001644         ;//-----------------------------------------------------
                       --------------------
   53 00001644 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001648 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000164E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000164E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001652 F8DA F088       ldr              pc,nexttimeout
  609 00001656         ;-------------------------------------------------------
                       ---------------------
  610 00001656         _91                                  ;   STA ($nn),Y
  611 00001656         ;-------------------------------------------------------
                       ---------------------
  612 00001656                 doIIY
  292 00001656 00000004 
                       _type   SETA             _ABS
  293 00001656 F819 0B01       ldrb             r0,[m6502_pc],#1
  294 0000165A         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  295 0000165A         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  296 0000165A F810 C00B       ldrb             addy,[r0,cpu_zpage]



ARM Macro Assembler    Page 91 


  297 0000165E 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  298 00001660         
  299 00001660         
  300 00001660 7841            ldrb             r1,[r0,#1]
  301 00001662 EA4C 2C01       orr              addy,addy,r1,lsl#8
  302 00001666 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  303 0000166A         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
  613 0000166A                 opSTORE          m6502_a
  508 0000166A EA4F 6015       mov              r0,m6502_a,lsr#24
  509 0000166E                 writemem
  179 0000166E                 [                _type = _ABS
  180 0000166E                 writememabs
  153 0000166E F40C 4160       and              r1,addy,#0xe000
  154 00001672 F10A 0224       adr              r2,writemem_tbl
  155 00001676 F20F 0E0A       adr              lr,%F0
  156 0000167A         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 0000167A EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 0000167E F852 F001       ldr              pc,[r2,r1]
  159 00001682         
  160 00001682         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 00001682                 ]
  182 00001682                 [                _type = _ZP
  184                          ]
  185 00001682                 [                _type = _ZPI
  187                          ]
  614 00001682                 fetch            6
   46 00001682         ;//-----------------------------------------------------
                       ----------------
   47 00001682 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001686 F100 0006       add              r0,r0,#6
   49 0000168A F8CA 00A0       str              r0,clocksh
   50 0000168E         
   51 0000168E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001692         ;//-----------------------------------------------------
                       --------------------
   53 00001692 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001696 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000169C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000169C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000016A0 F8DA F088       ldr              pc,nexttimeout
  615 000016A4         ;-------------------------------------------------------
                       ---------------------
  616 000016A4         _94                                  ;   STY $nn,X
  617 000016A4         ;-------------------------------------------------------
                       ---------------------



ARM Macro Assembler    Page 92 


  618 000016A4                 doZIXf
  342 000016A4 00000003 
                       _type   SETA             _ZPI
  343 000016A4 F819 CB01       ldrb             addy,[m6502_pc],#1
  344 000016A8 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  619 000016AC                 opSTORE          m6502_y
  508 000016AC EA4F 6017       mov              r0,m6502_y,lsr#24
  509 000016B0                 writemem
  179 000016B0                 [                _type = _ABS
  181                          ]
  182 000016B0                 [                _type = _ZP
  184                          ]
  185 000016B0                 [                _type = _ZPI
  186 000016B0                 writememzpi
  170 000016B0         ;// strb r0,[cpu_zpage,addy,lsr#24]
  171 000016B0 EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  172 000016B4 F80B 0001       strb             r0,[cpu_zpage,r1]
  173 000016B8         
  174 000016B8         
  187 000016B8                 ]
  620 000016B8                 fetch            4
   46 000016B8         ;//-----------------------------------------------------
                       ----------------
   47 000016B8 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000016BC F100 0004       add              r0,r0,#4
   49 000016C0 F8CA 00A0       str              r0,clocksh
   50 000016C4         
   51 000016C4 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000016C8         ;//-----------------------------------------------------
                       --------------------
   53 000016C8 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000016CC BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000016D2         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000016D2 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000016D6 F8DA F088       ldr              pc,nexttimeout
  621 000016DA         ;-------------------------------------------------------
                       ---------------------
  622 000016DA         _95                                  ;   STA $nn,X
  623 000016DA         ;-------------------------------------------------------
                       ---------------------
  624 000016DA                 doZIXf
  342 000016DA 00000003 
                       _type   SETA             _ZPI
  343 000016DA F819 CB01       ldrb             addy,[m6502_pc],#1
  344 000016DE EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  625 000016E2                 opSTORE          m6502_a
  508 000016E2 EA4F 6015       mov              r0,m6502_a,lsr#24
  509 000016E6                 writemem
  179 000016E6                 [                _type = _ABS



ARM Macro Assembler    Page 93 


  181                          ]
  182 000016E6                 [                _type = _ZP
  184                          ]
  185 000016E6                 [                _type = _ZPI
  186 000016E6                 writememzpi
  170 000016E6         ;// strb r0,[cpu_zpage,addy,lsr#24]
  171 000016E6 EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  172 000016EA F80B 0001       strb             r0,[cpu_zpage,r1]
  173 000016EE         
  174 000016EE         
  187 000016EE                 ]
  626 000016EE                 fetch            4
   46 000016EE         ;//-----------------------------------------------------
                       ----------------
   47 000016EE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000016F2 F100 0004       add              r0,r0,#4
   49 000016F6 F8CA 00A0       str              r0,clocksh
   50 000016FA         
   51 000016FA F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000016FE         ;//-----------------------------------------------------
                       --------------------
   53 000016FE F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001702 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001708         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001708 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000170C F8DA F088       ldr              pc,nexttimeout
  627 00001710         ;-------------------------------------------------------
                       ---------------------
  628 00001710         _96                                  ;   STX $nn,Y
  629 00001710         ;-------------------------------------------------------
                       ---------------------
  630 00001710                 doZIYf
  357 00001710 00000003 
                       _type   SETA             _ZPI
  358 00001710 F819 CB01       ldrb             addy,[m6502_pc],#1
  359 00001714 EB07 6C0C       add              addy,m6502_y,addy,lsl#24
  631 00001718                 opSTORE          m6502_x
  508 00001718 EA4F 6016       mov              r0,m6502_x,lsr#24
  509 0000171C                 writemem
  179 0000171C                 [                _type = _ABS
  181                          ]
  182 0000171C                 [                _type = _ZP
  184                          ]
  185 0000171C                 [                _type = _ZPI
  186 0000171C                 writememzpi
  170 0000171C         ;// strb r0,[cpu_zpage,addy,lsr#24]
  171 0000171C EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  172 00001720 F80B 0001       strb             r0,[cpu_zpage,r1]



ARM Macro Assembler    Page 94 


  173 00001724         
  174 00001724         
  187 00001724                 ]
  632 00001724                 fetch            4
   46 00001724         ;//-----------------------------------------------------
                       ----------------
   47 00001724 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001728 F100 0004       add              r0,r0,#4
   49 0000172C F8CA 00A0       str              r0,clocksh
   50 00001730         
   51 00001730 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001734         ;//-----------------------------------------------------
                       --------------------
   53 00001734 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001738 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000173E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000173E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001742 F8DA F088       ldr              pc,nexttimeout
  633 00001746         ;-------------------------------------------------------
                       ---------------------
  634 00001746         _98                                  ;   TYA
  635 00001746         ;-------------------------------------------------------
                       ---------------------
  636 00001746 463D            mov              m6502_a,m6502_y
  637 00001748 EA4F 6327       mov              m6502_nz,m6502_y,asr#24
  638 0000174C                 fetch            2
   46 0000174C         ;//-----------------------------------------------------
                       ----------------
   47 0000174C F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001750 F100 0002       add              r0,r0,#2
   49 00001754 F8CA 00A0       str              r0,clocksh
   50 00001758         
   51 00001758 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000175C         ;//-----------------------------------------------------
                       --------------------
   53 0000175C F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001760 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001766         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001766 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000176A F8DA F088       ldr              pc,nexttimeout
  639 0000176E         ;-------------------------------------------------------



ARM Macro Assembler    Page 95 


                       ---------------------
  640 0000176E         _99                                  ;   STA $nnnn,Y
  641 0000176E         ;-------------------------------------------------------
                       ---------------------
  642 0000176E                 doAIY
  260 0000176E 00000004 
                       _type   SETA             _ABS
  261 0000176E F819 CB01       ldrb             addy,[m6502_pc],#1
  262 00001772 F819 0B01       ldrb             r0,[m6502_pc],#1
  263 00001776 EA4C 2C00       orr              addy,addy,r0,lsl#8
  264 0000177A EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  265 0000177E         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
  643 0000177E                 opSTORE          m6502_a
  508 0000177E EA4F 6015       mov              r0,m6502_a,lsr#24
  509 00001782                 writemem
  179 00001782                 [                _type = _ABS
  180 00001782                 writememabs
  153 00001782 F40C 4160       and              r1,addy,#0xe000
  154 00001786 F10A 0224       adr              r2,writemem_tbl
  155 0000178A F20F 0E0A       adr              lr,%F0
  156 0000178E         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 0000178E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 00001792 F852 F001       ldr              pc,[r2,r1]
  159 00001796         
  160 00001796         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 00001796                 ]
  182 00001796                 [                _type = _ZP
  184                          ]
  185 00001796                 [                _type = _ZPI
  187                          ]
  644 00001796                 fetch            5
   46 00001796         ;//-----------------------------------------------------
                       ----------------
   47 00001796 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000179A F100 0005       add              r0,r0,#5
   49 0000179E F8CA 00A0       str              r0,clocksh
   50 000017A2         
   51 000017A2 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000017A6         ;//-----------------------------------------------------
                       --------------------
   53 000017A6 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000017AA BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000017B0         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000017B0 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000017B4 F8DA F088       ldr              pc,nexttimeout
  645 000017B8         ;-------------------------------------------------------
                       ---------------------



ARM Macro Assembler    Page 96 


  646 000017B8         _9A                                  ;   TXS
  647 000017B8         ;-------------------------------------------------------
                       ---------------------
  648 000017B8 EA4F 6016       mov              r0,m6502_x,lsr#24
  649 000017BC F88A 0080       strb             r0,m6502_s
  650 000017C0                 fetch            2
   46 000017C0         ;//-----------------------------------------------------
                       ----------------
   47 000017C0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000017C4 F100 0002       add              r0,r0,#2
   49 000017C8 F8CA 00A0       str              r0,clocksh
   50 000017CC         
   51 000017CC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000017D0         ;//-----------------------------------------------------
                       --------------------
   53 000017D0 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000017D4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000017DA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000017DA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000017DE F8DA F088       ldr              pc,nexttimeout
  651 000017E2         ;-------------------------------------------------------
                       ---------------------
  652 000017E2         _9D                                  ;   STA $nnnn,X
  653 000017E2         ;-------------------------------------------------------
                       ---------------------
  654 000017E2                 doAIX
  250 000017E2 00000004 
                       _type   SETA             _ABS
  251 000017E2 F819 CB01       ldrb             addy,[m6502_pc],#1
  252 000017E6 F819 0B01       ldrb             r0,[m6502_pc],#1
  253 000017EA EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 000017EE EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 000017F2         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  655 000017F2                 opSTORE          m6502_a
  508 000017F2 EA4F 6015       mov              r0,m6502_a,lsr#24
  509 000017F6                 writemem
  179 000017F6                 [                _type = _ABS
  180 000017F6                 writememabs
  153 000017F6 F40C 4160       and              r1,addy,#0xe000
  154 000017FA F10A 0224       adr              r2,writemem_tbl
  155 000017FE F20F 0E0A       adr              lr,%F0
  156 00001802         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 00001802 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 00001806 F852 F001       ldr              pc,[r2,r1]
  159 0000180A         
  160 0000180A         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 0000180A                 ]



ARM Macro Assembler    Page 97 


  182 0000180A                 [                _type = _ZP
  184                          ]
  185 0000180A                 [                _type = _ZPI
  187                          ]
  656 0000180A                 fetch            5
   46 0000180A         ;//-----------------------------------------------------
                       ----------------
   47 0000180A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000180E F100 0005       add              r0,r0,#5
   49 00001812 F8CA 00A0       str              r0,clocksh
   50 00001816         
   51 00001816 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000181A         ;//-----------------------------------------------------
                       --------------------
   53 0000181A F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000181E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001824         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001824 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001828 F8DA F088       ldr              pc,nexttimeout
  657 0000182C         ;-------------------------------------------------------
                       ---------------------
  658 0000182C         _A0                                  ;   LDY #$nn
  659 0000182C         ;-------------------------------------------------------
                       ---------------------
  660 0000182C                 doIMM
  270 0000182C 00000001 
                       _type   SETA             _IMM
  661 0000182C                 opLOAD           m6502_y
  434 0000182C                 readmems
  138 0000182C                 [                _type = _ABS
  141                          ]
  142 0000182C                 [                _type = _ZP
  144                          ]
  145 0000182C                 [                _type = _IMM
  146 0000182C                 readmemimms
  117 0000182C F919 3B01       ldrsb            m6502_nz,[m6502_pc],#1
  147 00001830                 ]
  435 00001830 EA4F 6703       mov              m6502_y,m6502_nz,lsl#24
  662 00001834                 fetch            2
   46 00001834         ;//-----------------------------------------------------
                       ----------------
   47 00001834 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001838 F100 0002       add              r0,r0,#2
   49 0000183C F8CA 00A0       str              r0,clocksh
   50 00001840         
   51 00001840 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001844         ;//-----------------------------------------------------
                       --------------------



ARM Macro Assembler    Page 98 


   53 00001844 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001848 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000184E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000184E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001852 F8DA F088       ldr              pc,nexttimeout
  663 00001856         ;-------------------------------------------------------
                       ---------------------
  664 00001856         _A1                                  ;   LDA ($nn,X)
  665 00001856         ;-------------------------------------------------------
                       ---------------------
  666 00001856                 doIIX
  275 00001856 00000004 
                       _type   SETA             _ABS
  276 00001856 F819 0B01       ldrb             r0,[m6502_pc],#1
  277 0000185A EB06 6000       add              r0,m6502_x,r0,lsl#24
  278 0000185E         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  279 0000185E EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  280 00001862 F81B C00C       ldrb             addy,[cpu_zpage,addy]
  281 00001866         
  282 00001866 F100 7080       add              r0,r0,#0x01000000
  283 0000186A         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  284 0000186A EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  285 0000186E F81B 1001       ldrb             r1,[cpu_zpage,r1]
  286 00001872         
  287 00001872 EA4C 2C01       orr              addy,addy,r1,lsl#8
  667 00001876                 opLOAD           m6502_a
  434 00001876                 readmems
  138 00001876                 [                _type = _ABS
  139 00001876                 readmemabs
   83 00001876 F40C 4160       and              r1,addy,#0xE000
   84 0000187A F20F 0E0A       adr              lr,%F0
   85 0000187E         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 0000187E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001882 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001886         
   89 00001886         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  140 00001886 EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  141 0000188A                 ]
  142 0000188A                 [                _type = _ZP
  144                          ]
  145 0000188A                 [                _type = _IMM
  147                          ]
  435 0000188A EA4F 6503       mov              m6502_a,m6502_nz,lsl#24



ARM Macro Assembler    Page 99 


  668 0000188E                 fetch            6
   46 0000188E         ;//-----------------------------------------------------
                       ----------------
   47 0000188E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001892 F100 0006       add              r0,r0,#6
   49 00001896 F8CA 00A0       str              r0,clocksh
   50 0000189A         
   51 0000189A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000189E         ;//-----------------------------------------------------
                       --------------------
   53 0000189E F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000018A2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000018A8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000018A8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000018AC F8DA F088       ldr              pc,nexttimeout
  669 000018B0         ;-------------------------------------------------------
                       ---------------------
  670 000018B0         _A2                                  ;   LDX #$nn
  671 000018B0         ;-------------------------------------------------------
                       ---------------------
  672 000018B0                 doIMM
  270 000018B0 00000001 
                       _type   SETA             _IMM
  673 000018B0                 opLOAD           m6502_x
  434 000018B0                 readmems
  138 000018B0                 [                _type = _ABS
  141                          ]
  142 000018B0                 [                _type = _ZP
  144                          ]
  145 000018B0                 [                _type = _IMM
  146 000018B0                 readmemimms
  117 000018B0 F919 3B01       ldrsb            m6502_nz,[m6502_pc],#1
  147 000018B4                 ]
  435 000018B4 EA4F 6603       mov              m6502_x,m6502_nz,lsl#24
  674 000018B8                 fetch            2
   46 000018B8         ;//-----------------------------------------------------
                       ----------------
   47 000018B8 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000018BC F100 0002       add              r0,r0,#2
   49 000018C0 F8CA 00A0       str              r0,clocksh
   50 000018C4         
   51 000018C4 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000018C8         ;//-----------------------------------------------------
                       --------------------
   53 000018C8 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000018CC BF5C F819 



ARM Macro Assembler    Page 100 


              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000018D2         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000018D2 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000018D6 F8DA F088       ldr              pc,nexttimeout
  675 000018DA         ;-------------------------------------------------------
                       ---------------------
  676 000018DA         _A4                                  ;   LDY $nn
  677 000018DA         ;-------------------------------------------------------
                       ---------------------
  678 000018DA                 doZ
  322 000018DA 00000002 
                       _type   SETA             _ZP
  323 000018DA F819 CB01       ldrb             addy,[m6502_pc],#1
  679 000018DE                 opLOAD           m6502_y
  434 000018DE                 readmems
  138 000018DE                 [                _type = _ABS
  141                          ]
  142 000018DE                 [                _type = _ZP
  143 000018DE                 readmemzps
  107 000018DE F91B 300C       ldrsb            m6502_nz,[cpu_zpage,addy] ;RAM
  144 000018E2                 ]
  145 000018E2                 [                _type = _IMM
  147                          ]
  435 000018E2 EA4F 6703       mov              m6502_y,m6502_nz,lsl#24
  680 000018E6                 fetch            3
   46 000018E6         ;//-----------------------------------------------------
                       ----------------
   47 000018E6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000018EA F100 0003       add              r0,r0,#3
   49 000018EE F8CA 00A0       str              r0,clocksh
   50 000018F2         
   51 000018F2 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000018F6         ;//-----------------------------------------------------
                       --------------------
   53 000018F6 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000018FA BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001900         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001900 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001904 F8DA F088       ldr              pc,nexttimeout
  681 00001908         ;-------------------------------------------------------
                       ---------------------
  682 00001908         _A5                                  ;   LDA $nn
  683 00001908         ;-------------------------------------------------------
                       ---------------------
  684 00001908                 doZ
  322 00001908 00000002 



ARM Macro Assembler    Page 101 


                       _type   SETA             _ZP
  323 00001908 F819 CB01       ldrb             addy,[m6502_pc],#1
  685 0000190C                 opLOAD           m6502_a
  434 0000190C                 readmems
  138 0000190C                 [                _type = _ABS
  141                          ]
  142 0000190C                 [                _type = _ZP
  143 0000190C                 readmemzps
  107 0000190C F91B 300C       ldrsb            m6502_nz,[cpu_zpage,addy] ;RAM
  144 00001910                 ]
  145 00001910                 [                _type = _IMM
  147                          ]
  435 00001910 EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
  686 00001914                 fetch            3
   46 00001914         ;//-----------------------------------------------------
                       ----------------
   47 00001914 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001918 F100 0003       add              r0,r0,#3
   49 0000191C F8CA 00A0       str              r0,clocksh
   50 00001920         
   51 00001920 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001924         ;//-----------------------------------------------------
                       --------------------
   53 00001924 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001928 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000192E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000192E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001932 F8DA F088       ldr              pc,nexttimeout
  687 00001936         ;-------------------------------------------------------
                       ---------------------
  688 00001936         _A6                                  ;   LDX $nn
  689 00001936         ;-------------------------------------------------------
                       ---------------------
  690 00001936                 doZ
  322 00001936 00000002 
                       _type   SETA             _ZP
  323 00001936 F819 CB01       ldrb             addy,[m6502_pc],#1
  691 0000193A                 opLOAD           m6502_x
  434 0000193A                 readmems
  138 0000193A                 [                _type = _ABS
  141                          ]
  142 0000193A                 [                _type = _ZP
  143 0000193A                 readmemzps
  107 0000193A F91B 300C       ldrsb            m6502_nz,[cpu_zpage,addy] ;RAM
  144 0000193E                 ]
  145 0000193E                 [                _type = _IMM
  147                          ]
  435 0000193E EA4F 6603       mov              m6502_x,m6502_nz,lsl#24
  692 00001942                 fetch            3
   46 00001942         ;//-----------------------------------------------------



ARM Macro Assembler    Page 102 


                       ----------------
   47 00001942 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001946 F100 0003       add              r0,r0,#3
   49 0000194A F8CA 00A0       str              r0,clocksh
   50 0000194E         
   51 0000194E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001952         ;//-----------------------------------------------------
                       --------------------
   53 00001952 F5B8 7840       subs             cycles,cycles,#3*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001956 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000195C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000195C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001960 F8DA F088       ldr              pc,nexttimeout
  693 00001964         ;-------------------------------------------------------
                       ---------------------
  694 00001964         _A8                                  ;   TAY
  695 00001964         ;-------------------------------------------------------
                       ---------------------
  696 00001964 462F            mov              m6502_y,m6502_a
  697 00001966 EA4F 6327       mov              m6502_nz,m6502_y,asr#24
  698 0000196A                 fetch            2
   46 0000196A         ;//-----------------------------------------------------
                       ----------------
   47 0000196A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000196E F100 0002       add              r0,r0,#2
   49 00001972 F8CA 00A0       str              r0,clocksh
   50 00001976         
   51 00001976 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000197A         ;//-----------------------------------------------------
                       --------------------
   53 0000197A F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000197E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001984         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001984 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001988 F8DA F088       ldr              pc,nexttimeout
  699 0000198C         ;-------------------------------------------------------
                       ---------------------
  700 0000198C         _A9                                  ;   LDA #$nn
  701 0000198C         ;-------------------------------------------------------
                       ---------------------
  702 0000198C                 doIMM



ARM Macro Assembler    Page 103 


  270 0000198C 00000001 
                       _type   SETA             _IMM
  703 0000198C                 opLOAD           m6502_a
  434 0000198C                 readmems
  138 0000198C                 [                _type = _ABS
  141                          ]
  142 0000198C                 [                _type = _ZP
  144                          ]
  145 0000198C                 [                _type = _IMM
  146 0000198C                 readmemimms
  117 0000198C F919 3B01       ldrsb            m6502_nz,[m6502_pc],#1
  147 00001990                 ]
  435 00001990 EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
  704 00001994                 fetch            2
   46 00001994         ;//-----------------------------------------------------
                       ----------------
   47 00001994 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001998 F100 0002       add              r0,r0,#2
   49 0000199C F8CA 00A0       str              r0,clocksh
   50 000019A0         
   51 000019A0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000019A4         ;//-----------------------------------------------------
                       --------------------
   53 000019A4 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000019A8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000019AE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000019AE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000019B2 F8DA F088       ldr              pc,nexttimeout
  705 000019B6         ;-------------------------------------------------------
                       ---------------------
  706 000019B6         _AA                                  ;   TAX
  707 000019B6         ;-------------------------------------------------------
                       ---------------------
  708 000019B6 462E            mov              m6502_x,m6502_a
  709 000019B8 EA4F 6326       mov              m6502_nz,m6502_x,asr#24
  710 000019BC                 fetch            2
   46 000019BC         ;//-----------------------------------------------------
                       ----------------
   47 000019BC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000019C0 F100 0002       add              r0,r0,#2
   49 000019C4 F8CA 00A0       str              r0,clocksh
   50 000019C8         
   51 000019C8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000019CC         ;//-----------------------------------------------------
                       --------------------
   53 000019CC F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  



ARM Macro Assembler    Page 104 


   54 000019D0 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000019D6         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000019D6 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000019DA F8DA F088       ldr              pc,nexttimeout
  711 000019DE         ;-------------------------------------------------------
                       ---------------------
  712 000019DE         _AC                                  ;   LDY $nnnn
  713 000019DE         ;-------------------------------------------------------
                       ---------------------
  714 000019DE                 doABS
  242 000019DE 00000004 
                       _type   SETA             _ABS
  243 000019DE F819 CB01       ldrb             addy,[m6502_pc],#1
  244 000019E2 F819 0B01       ldrb             r0,[m6502_pc],#1
  245 000019E6 EA4C 2C00       orr              addy,addy,r0,lsl#8
  715 000019EA                 opLOAD           m6502_y
  434 000019EA                 readmems
  138 000019EA                 [                _type = _ABS
  139 000019EA                 readmemabs
   83 000019EA F40C 4160       and              r1,addy,#0xE000
   84 000019EE F20F 0E0A       adr              lr,%F0
   85 000019F2         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000019F2 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 000019F6 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 000019FA         
   89 000019FA         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  140 000019FA EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  141 000019FE                 ]
  142 000019FE                 [                _type = _ZP
  144                          ]
  145 000019FE                 [                _type = _IMM
  147                          ]
  435 000019FE EA4F 6703       mov              m6502_y,m6502_nz,lsl#24
  716 00001A02                 fetch            4
   46 00001A02         ;//-----------------------------------------------------
                       ----------------
   47 00001A02 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001A06 F100 0004       add              r0,r0,#4
   49 00001A0A F8CA 00A0       str              r0,clocksh
   50 00001A0E         
   51 00001A0E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001A12         ;//-----------------------------------------------------
                       --------------------
   53 00001A12 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  



ARM Macro Assembler    Page 105 


   54 00001A16 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001A1C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001A1C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001A20 F8DA F088       ldr              pc,nexttimeout
  717 00001A24         ;-------------------------------------------------------
                       ---------------------
  718 00001A24         _AD                                  ;   LDA $nnnn
  719 00001A24         ;-------------------------------------------------------
                       ---------------------
  720 00001A24                 doABS
  242 00001A24 00000004 
                       _type   SETA             _ABS
  243 00001A24 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 00001A28 F819 0B01       ldrb             r0,[m6502_pc],#1
  245 00001A2C EA4C 2C00       orr              addy,addy,r0,lsl#8
  721 00001A30                 opLOAD           m6502_a
  434 00001A30                 readmems
  138 00001A30                 [                _type = _ABS
  139 00001A30                 readmemabs
   83 00001A30 F40C 4160       and              r1,addy,#0xE000
   84 00001A34 F20F 0E08       adr              lr,%F0
   85 00001A38         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00001A38 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001A3C F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001A40         
   89 00001A40         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  140 00001A40 EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  141 00001A44                 ]
  142 00001A44                 [                _type = _ZP
  144                          ]
  145 00001A44                 [                _type = _IMM
  147                          ]
  435 00001A44 EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
  722 00001A48                 fetch            4
   46 00001A48         ;//-----------------------------------------------------
                       ----------------
   47 00001A48 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001A4C F100 0004       add              r0,r0,#4
   49 00001A50 F8CA 00A0       str              r0,clocksh
   50 00001A54         
   51 00001A54 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001A58         ;//-----------------------------------------------------
                       --------------------
   53 00001A58 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  



ARM Macro Assembler    Page 106 


   54 00001A5C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001A62         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001A62 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001A66 F8DA F088       ldr              pc,nexttimeout
  723 00001A6A         ;-------------------------------------------------------
                       ---------------------
  724 00001A6A         _AE                                  ;   LDX $nnnn
  725 00001A6A         ;-------------------------------------------------------
                       ---------------------
  726 00001A6A                 doABS
  242 00001A6A 00000004 
                       _type   SETA             _ABS
  243 00001A6A F819 CB01       ldrb             addy,[m6502_pc],#1
  244 00001A6E F819 0B01       ldrb             r0,[m6502_pc],#1
  245 00001A72 EA4C 2C00       orr              addy,addy,r0,lsl#8
  727 00001A76                 opLOAD           m6502_x
  434 00001A76                 readmems
  138 00001A76                 [                _type = _ABS
  139 00001A76                 readmemabs
   83 00001A76 F40C 4160       and              r1,addy,#0xE000
   84 00001A7A F20F 0E0A       adr              lr,%F0
   85 00001A7E         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00001A7E EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001A82 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001A86         
   89 00001A86         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  140 00001A86 EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  141 00001A8A                 ]
  142 00001A8A                 [                _type = _ZP
  144                          ]
  145 00001A8A                 [                _type = _IMM
  147                          ]
  435 00001A8A EA4F 6603       mov              m6502_x,m6502_nz,lsl#24
  728 00001A8E                 fetch            4
   46 00001A8E         ;//-----------------------------------------------------
                       ----------------
   47 00001A8E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001A92 F100 0004       add              r0,r0,#4
   49 00001A96 F8CA 00A0       str              r0,clocksh
   50 00001A9A         
   51 00001A9A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001A9E         ;//-----------------------------------------------------
                       --------------------
   53 00001A9E F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  



ARM Macro Assembler    Page 107 


   54 00001AA2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001AA8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001AA8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001AAC F8DA F088       ldr              pc,nexttimeout
  729 00001AB0         ;-------------------------------------------------------
                       ---------------------
  730 00001AB0         _B0                                  ;   BCS *
  731 00001AB0         ;-------------------------------------------------------
                       ---------------------
  732 00001AB0 F018 0F01       tst              cycles,#CYC_C ;Test Carry
  733 00001AB4 F919 0B01       ldrsb            r0,[m6502_pc],#1
  734 00001AB8 BF1C 4481       addne            m6502_pc,m6502_pc,r0
  735 00001ABC         ; subne cycles,cycles,#3*CYCLE
  736 00001ABC F5A8 7880       subne            cycles,cycles,#256
  737 00001AC0                 fetch            2
   46 00001AC0         ;//-----------------------------------------------------
                       ----------------
   47 00001AC0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001AC4 F100 0002       add              r0,r0,#2
   49 00001AC8 F8CA 00A0       str              r0,clocksh
   50 00001ACC         
   51 00001ACC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001AD0         ;//-----------------------------------------------------
                       --------------------
   53 00001AD0 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001AD4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001ADA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001ADA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001ADE F8DA F088       ldr              pc,nexttimeout
  738 00001AE2         ;-------------------------------------------------------
                       ---------------------
  739 00001AE2         _B1                                  ;   LDA ($nn),Y
  740 00001AE2         ;-------------------------------------------------------
                       ---------------------
  741 00001AE2                 doIIY
  292 00001AE2 00000004 
                       _type   SETA             _ABS
  293 00001AE2 F819 0B01       ldrb             r0,[m6502_pc],#1
  294 00001AE6         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  295 00001AE6         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  296 00001AE6 F810 C00B       ldrb             addy,[r0,cpu_zpage]
  297 00001AEA 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////



ARM Macro Assembler    Page 108 


  298 00001AEC         
  299 00001AEC         
  300 00001AEC 7841            ldrb             r1,[r0,#1]
  301 00001AEE EA4C 2C01       orr              addy,addy,r1,lsl#8
  302 00001AF2 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  303 00001AF6         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
  742 00001AF6                 opLOAD           m6502_a
  434 00001AF6                 readmems
  138 00001AF6                 [                _type = _ABS
  139 00001AF6                 readmemabs
   83 00001AF6 F40C 4160       and              r1,addy,#0xE000
   84 00001AFA F20F 0E0A       adr              lr,%F0
   85 00001AFE         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00001AFE EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001B02 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001B06         
   89 00001B06         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  140 00001B06 EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  141 00001B0A                 ]
  142 00001B0A                 [                _type = _ZP
  144                          ]
  145 00001B0A                 [                _type = _IMM
  147                          ]
  435 00001B0A EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
  743 00001B0E                 fetch            5
   46 00001B0E         ;//-----------------------------------------------------
                       ----------------
   47 00001B0E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001B12 F100 0005       add              r0,r0,#5
   49 00001B16 F8CA 00A0       str              r0,clocksh
   50 00001B1A         
   51 00001B1A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001B1E         ;//-----------------------------------------------------
                       --------------------
   53 00001B1E F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001B22 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001B28         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001B28 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001B2C F8DA F088       ldr              pc,nexttimeout
  744 00001B30         ;-------------------------------------------------------
                       ---------------------
  745 00001B30         _B4                                  ;   LDY $nn,X
  746 00001B30         ;-------------------------------------------------------
                       ---------------------



ARM Macro Assembler    Page 109 


  747 00001B30                 doZIX
  334 00001B30 00000002 
                       _type   SETA             _ZP
  335 00001B30 F819 CB01       ldrb             addy,[m6502_pc],#1
  336 00001B34 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  337 00001B38 F00C 0CFF       and              addy,addy,#0xff 
                                                            ;Rygar needs this
  748 00001B3C                 opLOAD           m6502_y
  434 00001B3C                 readmems
  138 00001B3C                 [                _type = _ABS
  141                          ]
  142 00001B3C                 [                _type = _ZP
  143 00001B3C                 readmemzps
  107 00001B3C F91B 300C       ldrsb            m6502_nz,[cpu_zpage,addy] ;RAM
  144 00001B40                 ]
  145 00001B40                 [                _type = _IMM
  147                          ]
  435 00001B40 EA4F 6703       mov              m6502_y,m6502_nz,lsl#24
  749 00001B44                 fetch            4
   46 00001B44         ;//-----------------------------------------------------
                       ----------------
   47 00001B44 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001B48 F100 0004       add              r0,r0,#4
   49 00001B4C F8CA 00A0       str              r0,clocksh
   50 00001B50         
   51 00001B50 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001B54         ;//-----------------------------------------------------
                       --------------------
   53 00001B54 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001B58 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001B5E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001B5E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001B62 F8DA F088       ldr              pc,nexttimeout
  750 00001B66         ;-------------------------------------------------------
                       ---------------------
  751 00001B66         _B5                                  ;   LDA $nn,X
  752 00001B66         ;-------------------------------------------------------
                       ---------------------
  753 00001B66                 doZIX
  334 00001B66 00000002 
                       _type   SETA             _ZP
  335 00001B66 F819 CB01       ldrb             addy,[m6502_pc],#1
  336 00001B6A EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  337 00001B6E F00C 0CFF       and              addy,addy,#0xff 
                                                            ;Rygar needs this
  754 00001B72                 opLOAD           m6502_a
  434 00001B72                 readmems
  138 00001B72                 [                _type = _ABS
  141                          ]
  142 00001B72                 [                _type = _ZP



ARM Macro Assembler    Page 110 


  143 00001B72                 readmemzps
  107 00001B72 F91B 300C       ldrsb            m6502_nz,[cpu_zpage,addy] ;RAM
  144 00001B76                 ]
  145 00001B76                 [                _type = _IMM
  147                          ]
  435 00001B76 EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
  755 00001B7A                 fetch            4
   46 00001B7A         ;//-----------------------------------------------------
                       ----------------
   47 00001B7A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001B7E F100 0004       add              r0,r0,#4
   49 00001B82 F8CA 00A0       str              r0,clocksh
   50 00001B86         
   51 00001B86 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001B8A         ;//-----------------------------------------------------
                       --------------------
   53 00001B8A F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001B8E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001B94         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001B94 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001B98 F8DA F088       ldr              pc,nexttimeout
  756 00001B9C         ;-------------------------------------------------------
                       ---------------------
  757 00001B9C         _B6                                  ;   LDX $nn,Y
  758 00001B9C         ;-------------------------------------------------------
                       ---------------------
  759 00001B9C                 doZIY
  349 00001B9C 00000002 
                       _type   SETA             _ZP
  350 00001B9C F819 CB01       ldrb             addy,[m6502_pc],#1
  351 00001BA0 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  352 00001BA4 F00C 0CFF       and              addy,addy,#0xff
  760 00001BA8                 opLOAD           m6502_x
  434 00001BA8                 readmems
  138 00001BA8                 [                _type = _ABS
  141                          ]
  142 00001BA8                 [                _type = _ZP
  143 00001BA8                 readmemzps
  107 00001BA8 F91B 300C       ldrsb            m6502_nz,[cpu_zpage,addy] ;RAM
  144 00001BAC                 ]
  145 00001BAC                 [                _type = _IMM
  147                          ]
  435 00001BAC EA4F 6603       mov              m6502_x,m6502_nz,lsl#24
  761 00001BB0                 fetch            4
   46 00001BB0         ;//-----------------------------------------------------
                       ----------------
   47 00001BB0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001BB4 F100 0004       add              r0,r0,#4
   49 00001BB8 F8CA 00A0       str              r0,clocksh



ARM Macro Assembler    Page 111 


   50 00001BBC         
   51 00001BBC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001BC0         ;//-----------------------------------------------------
                       --------------------
   53 00001BC0 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001BC4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001BCA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001BCA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001BCE F8DA F088       ldr              pc,nexttimeout
  762 00001BD2         ;-------------------------------------------------------
                       ---------------------
  763 00001BD2         _B8                                  ;   CLV
  764 00001BD2         ;-------------------------------------------------------
                       ---------------------
  765 00001BD2 F028 0840       bic              cycles,cycles,#CYC_V
  766 00001BD6                 fetch            2
   46 00001BD6         ;//-----------------------------------------------------
                       ----------------
   47 00001BD6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001BDA F100 0002       add              r0,r0,#2
   49 00001BDE F8CA 00A0       str              r0,clocksh
   50 00001BE2         
   51 00001BE2 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001BE6         ;//-----------------------------------------------------
                       --------------------
   53 00001BE6 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001BEA BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001BF0         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001BF0 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001BF4 F8DA F088       ldr              pc,nexttimeout
  767 00001BF8         ;-------------------------------------------------------
                       ---------------------
  768 00001BF8         _B9                                  ;   LDA $nnnn,Y
  769 00001BF8         ;-------------------------------------------------------
                       ---------------------
  770 00001BF8                 doAIY
  260 00001BF8 00000004 
                       _type   SETA             _ABS
  261 00001BF8 F819 CB01       ldrb             addy,[m6502_pc],#1
  262 00001BFC F819 0B01       ldrb             r0,[m6502_pc],#1
  263 00001C00 EA4C 2C00       orr              addy,addy,r0,lsl#8
  264 00001C04 EB0C 6C17       add              addy,addy,m6502_y,lsr#24



ARM Macro Assembler    Page 112 


  265 00001C08         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
  771 00001C08                 opLOAD           m6502_a
  434 00001C08                 readmems
  138 00001C08                 [                _type = _ABS
  139 00001C08                 readmemabs
   83 00001C08 F40C 4160       and              r1,addy,#0xE000
   84 00001C0C F20F 0E08       adr              lr,%F0
   85 00001C10         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00001C10 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001C14 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001C18         
   89 00001C18         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  140 00001C18 EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  141 00001C1C                 ]
  142 00001C1C                 [                _type = _ZP
  144                          ]
  145 00001C1C                 [                _type = _IMM
  147                          ]
  435 00001C1C EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
  772 00001C20                 fetch            4
   46 00001C20         ;//-----------------------------------------------------
                       ----------------
   47 00001C20 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001C24 F100 0004       add              r0,r0,#4
   49 00001C28 F8CA 00A0       str              r0,clocksh
   50 00001C2C         
   51 00001C2C F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001C30         ;//-----------------------------------------------------
                       --------------------
   53 00001C30 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001C34 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001C3A         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001C3A F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001C3E F8DA F088       ldr              pc,nexttimeout
  773 00001C42         ;-------------------------------------------------------
                       ---------------------
  774 00001C42         _BA                                  ;   TSX
  775 00001C42         ;-------------------------------------------------------
                       ---------------------
  776 00001C42 F89A 6080       ldrb             m6502_x,m6502_s
  777 00001C46 EA4F 6606       mov              m6502_x,m6502_x,lsl#24
  778 00001C4A EA4F 6326       mov              m6502_nz,m6502_x,asr#24
  779 00001C4E                 fetch            2
   46 00001C4E         ;//-----------------------------------------------------



ARM Macro Assembler    Page 113 


                       ----------------
   47 00001C4E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001C52 F100 0002       add              r0,r0,#2
   49 00001C56 F8CA 00A0       str              r0,clocksh
   50 00001C5A         
   51 00001C5A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001C5E         ;//-----------------------------------------------------
                       --------------------
   53 00001C5E F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001C62 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001C68         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001C68 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001C6C F8DA F088       ldr              pc,nexttimeout
  780 00001C70         ;-------------------------------------------------------
                       ---------------------
  781 00001C70         _BC                                  ;   LDY $nnnn,X
  782 00001C70         ;-------------------------------------------------------
                       ---------------------
  783 00001C70                 doAIX
  250 00001C70 00000004 
                       _type   SETA             _ABS
  251 00001C70 F819 CB01       ldrb             addy,[m6502_pc],#1
  252 00001C74 F819 0B01       ldrb             r0,[m6502_pc],#1
  253 00001C78 EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 00001C7C EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 00001C80         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  784 00001C80                 opLOAD           m6502_y
  434 00001C80                 readmems
  138 00001C80                 [                _type = _ABS
  139 00001C80                 readmemabs
   83 00001C80 F40C 4160       and              r1,addy,#0xE000
   84 00001C84 F20F 0E08       adr              lr,%F0
   85 00001C88         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00001C88 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001C8C F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001C90         
   89 00001C90         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  140 00001C90 EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  141 00001C94                 ]
  142 00001C94                 [                _type = _ZP
  144                          ]
  145 00001C94                 [                _type = _IMM
  147                          ]
  435 00001C94 EA4F 6703       mov              m6502_y,m6502_nz,lsl#24



ARM Macro Assembler    Page 114 


  785 00001C98                 fetch            4
   46 00001C98         ;//-----------------------------------------------------
                       ----------------
   47 00001C98 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001C9C F100 0004       add              r0,r0,#4
   49 00001CA0 F8CA 00A0       str              r0,clocksh
   50 00001CA4         
   51 00001CA4 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001CA8         ;//-----------------------------------------------------
                       --------------------
   53 00001CA8 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001CAC BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001CB2         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001CB2 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001CB6 F8DA F088       ldr              pc,nexttimeout
  786 00001CBA         ;-------------------------------------------------------
                       ---------------------
  787 00001CBA         _BD                                  ;   LDA $nnnn,X
  788 00001CBA         ;-------------------------------------------------------
                       ---------------------
  789 00001CBA                 doAIX
  250 00001CBA 00000004 
                       _type   SETA             _ABS
  251 00001CBA F819 CB01       ldrb             addy,[m6502_pc],#1
  252 00001CBE F819 0B01       ldrb             r0,[m6502_pc],#1
  253 00001CC2 EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 00001CC6 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 00001CCA         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  790 00001CCA                 opLOAD           m6502_a
  434 00001CCA                 readmems
  138 00001CCA                 [                _type = _ABS
  139 00001CCA                 readmemabs
   83 00001CCA F40C 4160       and              r1,addy,#0xE000
   84 00001CCE F20F 0E0A       adr              lr,%F0
   85 00001CD2         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00001CD2 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001CD6 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001CDA         
   89 00001CDA         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  140 00001CDA EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  141 00001CDE                 ]
  142 00001CDE                 [                _type = _ZP
  144                          ]
  145 00001CDE                 [                _type = _IMM



ARM Macro Assembler    Page 115 


  147                          ]
  435 00001CDE EA4F 6503       mov              m6502_a,m6502_nz,lsl#24
  791 00001CE2                 fetch            4
   46 00001CE2         ;//-----------------------------------------------------
                       ----------------
   47 00001CE2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001CE6 F100 0004       add              r0,r0,#4
   49 00001CEA F8CA 00A0       str              r0,clocksh
   50 00001CEE         
   51 00001CEE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001CF2         ;//-----------------------------------------------------
                       --------------------
   53 00001CF2 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001CF6 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001CFC         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001CFC F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001D00 F8DA F088       ldr              pc,nexttimeout
  792 00001D04         ;-------------------------------------------------------
                       ---------------------
  793 00001D04         _BE                                  ;   LDX $nnnn,Y
  794 00001D04         ;-------------------------------------------------------
                       ---------------------
  795 00001D04                 doAIY
  260 00001D04 00000004 
                       _type   SETA             _ABS
  261 00001D04 F819 CB01       ldrb             addy,[m6502_pc],#1
  262 00001D08 F819 0B01       ldrb             r0,[m6502_pc],#1
  263 00001D0C EA4C 2C00       orr              addy,addy,r0,lsl#8
  264 00001D10 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  265 00001D14         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
  796 00001D14                 opLOAD           m6502_x
  434 00001D14                 readmems
  138 00001D14                 [                _type = _ABS
  139 00001D14                 readmemabs
   83 00001D14 F40C 4160       and              r1,addy,#0xE000
   84 00001D18 F20F 0E08       adr              lr,%F0
   85 00001D1C         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00001D1C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001D20 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001D24         
   89 00001D24         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  140 00001D24 EA40 6300       orr              m6502_nz,r0,r0,lsl#24
  141 00001D28                 ]
  142 00001D28                 [                _type = _ZP



ARM Macro Assembler    Page 116 


  144                          ]
  145 00001D28                 [                _type = _IMM
  147                          ]
  435 00001D28 EA4F 6603       mov              m6502_x,m6502_nz,lsl#24
  797 00001D2C                 fetch            4
   46 00001D2C         ;//-----------------------------------------------------
                       ----------------
   47 00001D2C F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001D30 F100 0004       add              r0,r0,#4
   49 00001D34 F8CA 00A0       str              r0,clocksh
   50 00001D38         
   51 00001D38 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001D3C         ;//-----------------------------------------------------
                       --------------------
   53 00001D3C F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001D40 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001D46         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001D46 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001D4A F8DA F088       ldr              pc,nexttimeout
  798 00001D4E         ;-------------------------------------------------------
                       ---------------------
  799 00001D4E         _C0                                  ;   CPY #$nn
  800 00001D4E         ;-------------------------------------------------------
                       ---------------------
  801 00001D4E                 doIMM
  270 00001D4E 00000001 
                       _type   SETA             _IMM
  802 00001D4E                 opCOMP           m6502_y
  403 00001D4E                 readmem
  122 00001D4E                 [                _type = _ABS
  124                          ]
  125 00001D4E                 [                _type = _ZP
  127                          ]
  128 00001D4E                 [                _type = _ZPI
  130                          ]
  131 00001D4E                 [                _type = _IMM
  132 00001D4E                 readmemimm
  112 00001D4E F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  133 00001D52                 ]
  404 00001D52 EBB7 6300       subs             m6502_nz,m6502_y,r0,lsl#24
  405 00001D56 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 00001D5A F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  803 00001D5E                 fetch_c          2
   62 00001D5E         ;//-----------------------------------------------------
                       ----------------
   63 00001D5E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00001D62 F100 0002       add              r0,r0,#2
   65 00001D66 F8CA 00A0       str              r0,clocksh



ARM Macro Assembler    Page 117 


   66 00001D6A         
   67 00001D6A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00001D6E         ;//-----------------------------------------------------
                       --------------------
   69 00001D6E F578 7800       sbcs             cycles,cycles,#2*256 
                                                            ;//CYCLE=256
   70 00001D72 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00001D78         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00001D78 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00001D7C F8DA F088       ldr              pc,nexttimeout
  804 00001D80         ;-------------------------------------------------------
                       ---------------------
  805 00001D80         _C1                                  ;   CMP ($nn,X)
  806 00001D80         ;-------------------------------------------------------
                       ---------------------
  807 00001D80                 doIIX
  275 00001D80 00000004 
                       _type   SETA             _ABS
  276 00001D80 F819 0B01       ldrb             r0,[m6502_pc],#1
  277 00001D84 EB06 6000       add              r0,m6502_x,r0,lsl#24
  278 00001D88         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  279 00001D88 EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  280 00001D8C F81B C00C       ldrb             addy,[cpu_zpage,addy]
  281 00001D90         
  282 00001D90 F100 7080       add              r0,r0,#0x01000000
  283 00001D94         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  284 00001D94 EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  285 00001D98 F81B 1001       ldrb             r1,[cpu_zpage,r1]
  286 00001D9C         
  287 00001D9C EA4C 2C01       orr              addy,addy,r1,lsl#8
  808 00001DA0                 opCOMP           m6502_a
  403 00001DA0                 readmem
  122 00001DA0                 [                _type = _ABS
  123 00001DA0                 readmemabs
   83 00001DA0 F40C 4160       and              r1,addy,#0xE000
   84 00001DA4 F20F 0E08       adr              lr,%F0
   85 00001DA8         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00001DA8 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001DAC F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001DB0         
   89 00001DB0         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00001DB0                 ]
  125 00001DB0                 [                _type = _ZP
  127                          ]
  128 00001DB0                 [                _type = _ZPI
  130                          ]
  131 00001DB0                 [                _type = _IMM
  133                          ]



ARM Macro Assembler    Page 118 


  404 00001DB0 EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  405 00001DB4 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 00001DB8 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  809 00001DBC                 fetch_c          6
   62 00001DBC         ;//-----------------------------------------------------
                       ----------------
   63 00001DBC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00001DC0 F100 0006       add              r0,r0,#6
   65 00001DC4 F8CA 00A0       str              r0,clocksh
   66 00001DC8         
   67 00001DC8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00001DCC         ;//-----------------------------------------------------
                       --------------------
   69 00001DCC F578 68C0       sbcs             cycles,cycles,#6*256 
                                                            ;//CYCLE=256
   70 00001DD0 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00001DD6         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00001DD6 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00001DDA F8DA F088       ldr              pc,nexttimeout
  810 00001DDE         ;-------------------------------------------------------
                       ---------------------
  811 00001DDE         _C4                                  ;   CPY $nn
  812 00001DDE         ;-------------------------------------------------------
                       ---------------------
  813 00001DDE                 doZ
  322 00001DDE 00000002 
                       _type   SETA             _ZP
  323 00001DDE F819 CB01       ldrb             addy,[m6502_pc],#1
  814 00001DE2                 opCOMP           m6502_y
  403 00001DE2                 readmem
  122 00001DE2                 [                _type = _ABS
  124                          ]
  125 00001DE2                 [                _type = _ZP
  126 00001DE2                 readmemzp
   94 00001DE2 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  127 00001DE6                 ]
  128 00001DE6                 [                _type = _ZPI
  130                          ]
  131 00001DE6                 [                _type = _IMM
  133                          ]
  404 00001DE6 EBB7 6300       subs             m6502_nz,m6502_y,r0,lsl#24
  405 00001DEA EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 00001DEE F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  815 00001DF2                 fetch_c          3
   62 00001DF2         ;//-----------------------------------------------------
                       ----------------
   63 00001DF2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00001DF6 F100 0003       add              r0,r0,#3
   65 00001DFA F8CA 00A0       str              r0,clocksh
   66 00001DFE         
   67 00001DFE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00001E02         ;//-----------------------------------------------------



ARM Macro Assembler    Page 119 


                       --------------------
   69 00001E02 F578 7840       sbcs             cycles,cycles,#3*256 
                                                            ;//CYCLE=256
   70 00001E06 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00001E0C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00001E0C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00001E10 F8DA F088       ldr              pc,nexttimeout
  816 00001E14         ;-------------------------------------------------------
                       ---------------------
  817 00001E14         _C5                                  ;   CMP $nn
  818 00001E14         ;-------------------------------------------------------
                       ---------------------
  819 00001E14                 doZ
  322 00001E14 00000002 
                       _type   SETA             _ZP
  323 00001E14 F819 CB01       ldrb             addy,[m6502_pc],#1
  820 00001E18                 opCOMP           m6502_a
  403 00001E18                 readmem
  122 00001E18                 [                _type = _ABS
  124                          ]
  125 00001E18                 [                _type = _ZP
  126 00001E18                 readmemzp
   94 00001E18 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  127 00001E1C                 ]
  128 00001E1C                 [                _type = _ZPI
  130                          ]
  131 00001E1C                 [                _type = _IMM
  133                          ]
  404 00001E1C EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  405 00001E20 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 00001E24 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  821 00001E28                 fetch_c          3
   62 00001E28         ;//-----------------------------------------------------
                       ----------------
   63 00001E28 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00001E2C F100 0003       add              r0,r0,#3
   65 00001E30 F8CA 00A0       str              r0,clocksh
   66 00001E34         
   67 00001E34 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00001E38         ;//-----------------------------------------------------
                       --------------------
   69 00001E38 F578 7840       sbcs             cycles,cycles,#3*256 
                                                            ;//CYCLE=256
   70 00001E3C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00001E42         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00001E42 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00001E46 F8DA F088       ldr              pc,nexttimeout
  822 00001E4A         ;-------------------------------------------------------
                       ---------------------
  823 00001E4A         _C6                                  ;   DEC $nn
  824 00001E4A         ;-------------------------------------------------------
                       ---------------------
  825 00001E4A                 doZ
  322 00001E4A 00000002 



ARM Macro Assembler    Page 120 


                       _type   SETA             _ZP
  323 00001E4A F819 CB01       ldrb             addy,[m6502_pc],#1
  826 00001E4E                 opDEC
  411 00001E4E                 readmem
  122 00001E4E                 [                _type = _ABS
  124                          ]
  125 00001E4E                 [                _type = _ZP
  126 00001E4E                 readmemzp
   94 00001E4E F81B 000C       ldrb             r0,[cpu_zpage,addy]
  127 00001E52                 ]
  128 00001E52                 [                _type = _ZPI
  130                          ]
  131 00001E52                 [                _type = _IMM
  133                          ]
  412 00001E52 F1A0 0001       sub              r0,r0,#1
  413 00001E56 EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  414 00001E5A                 writemem
  179 00001E5A                 [                _type = _ABS
  181                          ]
  182 00001E5A                 [                _type = _ZP
  183 00001E5A                 writememzp
  165 00001E5A F80B 000C       strb             r0,[cpu_zpage,addy]
  184 00001E5E                 ]
  185 00001E5E                 [                _type = _ZPI
  187                          ]
  827 00001E5E                 fetch            5
   46 00001E5E         ;//-----------------------------------------------------
                       ----------------
   47 00001E5E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001E62 F100 0005       add              r0,r0,#5
   49 00001E66 F8CA 00A0       str              r0,clocksh
   50 00001E6A         
   51 00001E6A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001E6E         ;//-----------------------------------------------------
                       --------------------
   53 00001E6E F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001E72 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001E78         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001E78 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001E7C F8DA F088       ldr              pc,nexttimeout
  828 00001E80         ;-------------------------------------------------------
                       ---------------------
  829 00001E80         _C8                                  ;   INY
  830 00001E80         ;-------------------------------------------------------
                       ---------------------
  831 00001E80 F107 7780       add              m6502_y,m6502_y,#0x01000000
  832 00001E84 EA4F 6327       mov              m6502_nz,m6502_y,asr#24
  833 00001E88                 fetch            2
   46 00001E88         ;//-----------------------------------------------------
                       ----------------



ARM Macro Assembler    Page 121 


   47 00001E88 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001E8C F100 0002       add              r0,r0,#2
   49 00001E90 F8CA 00A0       str              r0,clocksh
   50 00001E94         
   51 00001E94 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001E98         ;//-----------------------------------------------------
                       --------------------
   53 00001E98 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001E9C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001EA2         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001EA2 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001EA6 F8DA F088       ldr              pc,nexttimeout
  834 00001EAA         ;-------------------------------------------------------
                       ---------------------
  835 00001EAA         _C9                                  ;   CMP #$nn
  836 00001EAA         ;-------------------------------------------------------
                       ---------------------
  837 00001EAA                 doIMM
  270 00001EAA 00000001 
                       _type   SETA             _IMM
  838 00001EAA                 opCOMP           m6502_a
  403 00001EAA                 readmem
  122 00001EAA                 [                _type = _ABS
  124                          ]
  125 00001EAA                 [                _type = _ZP
  127                          ]
  128 00001EAA                 [                _type = _ZPI
  130                          ]
  131 00001EAA                 [                _type = _IMM
  132 00001EAA                 readmemimm
  112 00001EAA F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  133 00001EAE                 ]
  404 00001EAE EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  405 00001EB2 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 00001EB6 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  839 00001EBA                 fetch_c          2
   62 00001EBA         ;//-----------------------------------------------------
                       ----------------
   63 00001EBA F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00001EBE F100 0002       add              r0,r0,#2
   65 00001EC2 F8CA 00A0       str              r0,clocksh
   66 00001EC6         
   67 00001EC6 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00001ECA         ;//-----------------------------------------------------
                       --------------------
   69 00001ECA F578 7800       sbcs             cycles,cycles,#2*256 
                                                            ;//CYCLE=256



ARM Macro Assembler    Page 122 


   70 00001ECE BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00001ED4         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00001ED4 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00001ED8 F8DA F088       ldr              pc,nexttimeout
  840 00001EDC         ;-------------------------------------------------------
                       ---------------------
  841 00001EDC         _CA                                  ;   DEX
  842 00001EDC         ;-------------------------------------------------------
                       ---------------------
  843 00001EDC F1A6 7680       sub              m6502_x,m6502_x,#0x01000000
  844 00001EE0 EA4F 6326       mov              m6502_nz,m6502_x,asr#24
  845 00001EE4                 fetch            2
   46 00001EE4         ;//-----------------------------------------------------
                       ----------------
   47 00001EE4 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001EE8 F100 0002       add              r0,r0,#2
   49 00001EEC F8CA 00A0       str              r0,clocksh
   50 00001EF0         
   51 00001EF0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001EF4         ;//-----------------------------------------------------
                       --------------------
   53 00001EF4 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001EF8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001EFE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001EFE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001F02 F8DA F088       ldr              pc,nexttimeout
  846 00001F06         ;-------------------------------------------------------
                       ---------------------
  847 00001F06         _CC                                  ;   CPY $nnnn
  848 00001F06         ;-------------------------------------------------------
                       ---------------------
  849 00001F06                 doABS
  242 00001F06 00000004 
                       _type   SETA             _ABS
  243 00001F06 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 00001F0A F819 0B01       ldrb             r0,[m6502_pc],#1
  245 00001F0E EA4C 2C00       orr              addy,addy,r0,lsl#8
  850 00001F12                 opCOMP           m6502_y
  403 00001F12                 readmem
  122 00001F12                 [                _type = _ABS
  123 00001F12                 readmemabs
   83 00001F12 F40C 4160       and              r1,addy,#0xE000
   84 00001F16 F20F 0E0A       adr              lr,%F0
   85 00001F1A         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00001F1A EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001F1E F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001F22         



ARM Macro Assembler    Page 123 


   89 00001F22         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00001F22                 ]
  125 00001F22                 [                _type = _ZP
  127                          ]
  128 00001F22                 [                _type = _ZPI
  130                          ]
  131 00001F22                 [                _type = _IMM
  133                          ]
  404 00001F22 EBB7 6300       subs             m6502_nz,m6502_y,r0,lsl#24
  405 00001F26 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 00001F2A F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  851 00001F2E                 fetch_c          4
   62 00001F2E         ;//-----------------------------------------------------
                       ----------------
   63 00001F2E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00001F32 F100 0004       add              r0,r0,#4
   65 00001F36 F8CA 00A0       str              r0,clocksh
   66 00001F3A         
   67 00001F3A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00001F3E         ;//-----------------------------------------------------
                       --------------------
   69 00001F3E F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   70 00001F42 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00001F48         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00001F48 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00001F4C F8DA F088       ldr              pc,nexttimeout
  852 00001F50         ;-------------------------------------------------------
                       ---------------------
  853 00001F50         _CD                                  ;   CMP $nnnn
  854 00001F50         ;-------------------------------------------------------
                       ---------------------
  855 00001F50                 doABS
  242 00001F50 00000004 
                       _type   SETA             _ABS
  243 00001F50 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 00001F54 F819 0B01       ldrb             r0,[m6502_pc],#1
  245 00001F58 EA4C 2C00       orr              addy,addy,r0,lsl#8
  856 00001F5C                 opCOMP           m6502_a
  403 00001F5C                 readmem
  122 00001F5C                 [                _type = _ABS
  123 00001F5C                 readmemabs
   83 00001F5C F40C 4160       and              r1,addy,#0xE000
   84 00001F60 F20F 0E08       adr              lr,%F0
   85 00001F64         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00001F64 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001F68 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001F6C         
   89 00001F6C         0                                    ;//out: r0=val (bit



ARM Macro Assembler    Page 124 


                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00001F6C                 ]
  125 00001F6C                 [                _type = _ZP
  127                          ]
  128 00001F6C                 [                _type = _ZPI
  130                          ]
  131 00001F6C                 [                _type = _IMM
  133                          ]
  404 00001F6C EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  405 00001F70 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 00001F74 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  857 00001F78                 fetch_c          4
   62 00001F78         ;//-----------------------------------------------------
                       ----------------
   63 00001F78 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00001F7C F100 0004       add              r0,r0,#4
   65 00001F80 F8CA 00A0       str              r0,clocksh
   66 00001F84         
   67 00001F84 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00001F88         ;//-----------------------------------------------------
                       --------------------
   69 00001F88 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   70 00001F8C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00001F92         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00001F92 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00001F96 F8DA F088       ldr              pc,nexttimeout
  858 00001F9A         ;-------------------------------------------------------
                       ---------------------
  859 00001F9A         _CE                                  ;   DEC $nnnn
  860 00001F9A         ;-------------------------------------------------------
                       ---------------------
  861 00001F9A                 doABS
  242 00001F9A 00000004 
                       _type   SETA             _ABS
  243 00001F9A F819 CB01       ldrb             addy,[m6502_pc],#1
  244 00001F9E F819 0B01       ldrb             r0,[m6502_pc],#1
  245 00001FA2 EA4C 2C00       orr              addy,addy,r0,lsl#8
  862 00001FA6                 opDEC
  411 00001FA6                 readmem
  122 00001FA6                 [                _type = _ABS
  123 00001FA6                 readmemabs
   83 00001FA6 F40C 4160       and              r1,addy,#0xE000
   84 00001FAA F20F 0E0A       adr              lr,%F0
   85 00001FAE         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00001FAE EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00001FB2 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00001FB6         
   89 00001FB6         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I



ARM Macro Assembler    Page 125 


                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00001FB6                 ]
  125 00001FB6                 [                _type = _ZP
  127                          ]
  128 00001FB6                 [                _type = _ZPI
  130                          ]
  131 00001FB6                 [                _type = _IMM
  133                          ]
  412 00001FB6 F1A0 0001       sub              r0,r0,#1
  413 00001FBA EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  414 00001FBE                 writemem
  179 00001FBE                 [                _type = _ABS
  180 00001FBE                 writememabs
  153 00001FBE F40C 4160       and              r1,addy,#0xe000
  154 00001FC2 F10A 0224       adr              r2,writemem_tbl
  155 00001FC6 F20F 0E0A       adr              lr,%F0
  156 00001FCA         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 00001FCA EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 00001FCE F852 F001       ldr              pc,[r2,r1]
  159 00001FD2         
  160 00001FD2         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 00001FD2                 ]
  182 00001FD2                 [                _type = _ZP
  184                          ]
  185 00001FD2                 [                _type = _ZPI
  187                          ]
  863 00001FD2                 fetch            6
   46 00001FD2         ;//-----------------------------------------------------
                       ----------------
   47 00001FD2 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00001FD6 F100 0006       add              r0,r0,#6
   49 00001FDA F8CA 00A0       str              r0,clocksh
   50 00001FDE         
   51 00001FDE F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00001FE2         ;//-----------------------------------------------------
                       --------------------
   53 00001FE2 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00001FE6 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00001FEC         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00001FEC F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00001FF0 F8DA F088       ldr              pc,nexttimeout
  864 00001FF4         ;-------------------------------------------------------
                       ---------------------
  865 00001FF4         _D0                                  ;   BNE *
  866 00001FF4         ;-------------------------------------------------------



ARM Macro Assembler    Page 126 


                       ---------------------
  867 00001FF4 F013 0FFF       tst              m6502_nz,#0xff
  868 00001FF8 F919 0B01       ldrsb            r0,[m6502_pc],#1
  869 00001FFC BF1C 4481       addne            m6502_pc,m6502_pc,r0
  870 00002000         ; subne cycles,cycles,#3*CYCLE
  871 00002000 F5A8 7880       subne            cycles,cycles,#256
  872 00002004                 fetch            2
   46 00002004         ;//-----------------------------------------------------
                       ----------------
   47 00002004 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00002008 F100 0002       add              r0,r0,#2
   49 0000200C F8CA 00A0       str              r0,clocksh
   50 00002010         
   51 00002010 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00002014         ;//-----------------------------------------------------
                       --------------------
   53 00002014 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00002018 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000201E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000201E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00002022 F8DA F088       ldr              pc,nexttimeout
  873 00002026         ;-------------------------------------------------------
                       ---------------------
  874 00002026         _D1                                  ;   CMP ($nn),Y
  875 00002026         ;-------------------------------------------------------
                       ---------------------
  876 00002026                 doIIY
  292 00002026 00000004 
                       _type   SETA             _ABS
  293 00002026 F819 0B01       ldrb             r0,[m6502_pc],#1
  294 0000202A         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  295 0000202A         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
  296 0000202A F810 C00B       ldrb             addy,[r0,cpu_zpage]
  297 0000202E 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  298 00002030         
  299 00002030         
  300 00002030 7841            ldrb             r1,[r0,#1]
  301 00002032 EA4C 2C01       orr              addy,addy,r1,lsl#8
  302 00002036 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  303 0000203A         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
  877 0000203A                 opCOMP           m6502_a
  403 0000203A                 readmem
  122 0000203A                 [                _type = _ABS
  123 0000203A                 readmemabs
   83 0000203A F40C 4160       and              r1,addy,#0xE000
   84 0000203E F20F 0E0A       adr              lr,%F0
   85 00002042         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x



ARM Macro Assembler    Page 127 


                       E000 (for rom_R)
   86 00002042 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00002046 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 0000204A         
   89 0000204A         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 0000204A                 ]
  125 0000204A                 [                _type = _ZP
  127                          ]
  128 0000204A                 [                _type = _ZPI
  130                          ]
  131 0000204A                 [                _type = _IMM
  133                          ]
  404 0000204A EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  405 0000204E EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 00002052 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  878 00002056                 fetch_c          5
   62 00002056         ;//-----------------------------------------------------
                       ----------------
   63 00002056 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 0000205A F100 0005       add              r0,r0,#5
   65 0000205E F8CA 00A0       str              r0,clocksh
   66 00002062         
   67 00002062 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00002066         ;//-----------------------------------------------------
                       --------------------
   69 00002066 F578 68A0       sbcs             cycles,cycles,#5*256 
                                                            ;//CYCLE=256
   70 0000206A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00002070         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00002070 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00002074 F8DA F088       ldr              pc,nexttimeout
  879 00002078         ;-------------------------------------------------------
                       ---------------------
  880 00002078         _D5                                  ;   CMP $nn,X
  881 00002078         ;-------------------------------------------------------
                       ---------------------
  882 00002078                 doZIXf
  342 00002078 00000003 
                       _type   SETA             _ZPI
  343 00002078 F819 CB01       ldrb             addy,[m6502_pc],#1
  344 0000207C EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  883 00002080                 opCOMP           m6502_a
  403 00002080                 readmem
  122 00002080                 [                _type = _ABS
  124                          ]
  125 00002080                 [                _type = _ZP
  127                          ]
  128 00002080                 [                _type = _ZPI
  129 00002080                 readmemzpi
   99 00002080         ;// ldrb r0,[cpu_zpage,addy,lsr#24]



ARM Macro Assembler    Page 128 


  100 00002080 EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  101 00002084 F81B 0000       ldrb             r0,[cpu_zpage,r0]
  102 00002088         
  130 00002088                 ]
  131 00002088                 [                _type = _IMM
  133                          ]
  404 00002088 EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  405 0000208C EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 00002090 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  884 00002094                 fetch_c          4
   62 00002094         ;//-----------------------------------------------------
                       ----------------
   63 00002094 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00002098 F100 0004       add              r0,r0,#4
   65 0000209C F8CA 00A0       str              r0,clocksh
   66 000020A0         
   67 000020A0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 000020A4         ;//-----------------------------------------------------
                       --------------------
   69 000020A4 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   70 000020A8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 000020AE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 000020AE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 000020B2 F8DA F088       ldr              pc,nexttimeout
  885 000020B6         ;-------------------------------------------------------
                       ---------------------
  886 000020B6         _D6                                  ;   DEC $nn,X
  887 000020B6         ;-------------------------------------------------------
                       ---------------------
  888 000020B6                 doZIXf
  342 000020B6 00000003 
                       _type   SETA             _ZPI
  343 000020B6 F819 CB01       ldrb             addy,[m6502_pc],#1
  344 000020BA EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  889 000020BE                 opDEC
  411 000020BE                 readmem
  122 000020BE                 [                _type = _ABS
  124                          ]
  125 000020BE                 [                _type = _ZP
  127                          ]
  128 000020BE                 [                _type = _ZPI
  129 000020BE                 readmemzpi
   99 000020BE         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  100 000020BE EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  101 000020C2 F81B 0000       ldrb             r0,[cpu_zpage,r0]
  102 000020C6         
  130 000020C6                 ]
  131 000020C6                 [                _type = _IMM
  133                          ]
  412 000020C6 F1A0 0001       sub              r0,r0,#1
  413 000020CA EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  414 000020CE                 writemem
  179 000020CE                 [                _type = _ABS
  181                          ]



ARM Macro Assembler    Page 129 


  182 000020CE                 [                _type = _ZP
  184                          ]
  185 000020CE                 [                _type = _ZPI
  186 000020CE                 writememzpi
  170 000020CE         ;// strb r0,[cpu_zpage,addy,lsr#24]
  171 000020CE EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  172 000020D2 F80B 0001       strb             r0,[cpu_zpage,r1]
  173 000020D6         
  174 000020D6         
  187 000020D6                 ]
  890 000020D6                 fetch            6
   46 000020D6         ;//-----------------------------------------------------
                       ----------------
   47 000020D6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000020DA F100 0006       add              r0,r0,#6
   49 000020DE F8CA 00A0       str              r0,clocksh
   50 000020E2         
   51 000020E2 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000020E6         ;//-----------------------------------------------------
                       --------------------
   53 000020E6 F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000020EA BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000020F0         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000020F0 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000020F4 F8DA F088       ldr              pc,nexttimeout
  891 000020F8         ;-------------------------------------------------------
                       ---------------------
  892 000020F8         _D8                                  ;   CLD
  893 000020F8         ;-------------------------------------------------------
                       ---------------------
  894 000020F8 F028 0808       bic              cycles,cycles,#CYC_D
  895 000020FC                 fetch            2
   46 000020FC         ;//-----------------------------------------------------
                       ----------------
   47 000020FC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00002100 F100 0002       add              r0,r0,#2
   49 00002104 F8CA 00A0       str              r0,clocksh
   50 00002108         
   51 00002108 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000210C         ;//-----------------------------------------------------
                       --------------------
   53 0000210C F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00002110 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ



ARM Macro Assembler    Page 130 


                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00002116         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00002116 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000211A F8DA F088       ldr              pc,nexttimeout
  896 0000211E         ;-------------------------------------------------------
                       ---------------------
  897 0000211E         _D9                                  ;   CMP $nnnn,Y
  898 0000211E         ;-------------------------------------------------------
                       ---------------------
  899 0000211E                 doAIY
  260 0000211E 00000004 
                       _type   SETA             _ABS
  261 0000211E F819 CB01       ldrb             addy,[m6502_pc],#1
  262 00002122 F819 0B01       ldrb             r0,[m6502_pc],#1
  263 00002126 EA4C 2C00       orr              addy,addy,r0,lsl#8
  264 0000212A EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  265 0000212E         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
  900 0000212E                 opCOMP           m6502_a
  403 0000212E                 readmem
  122 0000212E                 [                _type = _ABS
  123 0000212E                 readmemabs
   83 0000212E F40C 4160       and              r1,addy,#0xE000
   84 00002132 F20F 0E0A       adr              lr,%F0
   85 00002136         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00002136 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 0000213A F854 F001       ldr              pc,[m6502_rmem,r1]
   88 0000213E         
   89 0000213E         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 0000213E                 ]
  125 0000213E                 [                _type = _ZP
  127                          ]
  128 0000213E                 [                _type = _ZPI
  130                          ]
  131 0000213E                 [                _type = _IMM
  133                          ]
  404 0000213E EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  405 00002142 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 00002146 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  901 0000214A                 fetch_c          4
   62 0000214A         ;//-----------------------------------------------------
                       ----------------
   63 0000214A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 0000214E F100 0004       add              r0,r0,#4
   65 00002152 F8CA 00A0       str              r0,clocksh
   66 00002156         
   67 00002156 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 0000215A         ;//-----------------------------------------------------
                       --------------------



ARM Macro Assembler    Page 131 


   69 0000215A F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   70 0000215E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00002164         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00002164 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00002168 F8DA F088       ldr              pc,nexttimeout
  902 0000216C         ;-------------------------------------------------------
                       ---------------------
  903 0000216C         _DD                                  ;   CMP $nnnn,X
  904 0000216C         ;-------------------------------------------------------
                       ---------------------
  905 0000216C                 doAIX
  250 0000216C 00000004 
                       _type   SETA             _ABS
  251 0000216C F819 CB01       ldrb             addy,[m6502_pc],#1
  252 00002170 F819 0B01       ldrb             r0,[m6502_pc],#1
  253 00002174 EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 00002178 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 0000217C         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  906 0000217C                 opCOMP           m6502_a
  403 0000217C                 readmem
  122 0000217C                 [                _type = _ABS
  123 0000217C                 readmemabs
   83 0000217C F40C 4160       and              r1,addy,#0xE000
   84 00002180 F20F 0E08       adr              lr,%F0
   85 00002184         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00002184 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00002188 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 0000218C         
   89 0000218C         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 0000218C                 ]
  125 0000218C                 [                _type = _ZP
  127                          ]
  128 0000218C                 [                _type = _ZPI
  130                          ]
  131 0000218C                 [                _type = _IMM
  133                          ]
  404 0000218C EBB5 6300       subs             m6502_nz,m6502_a,r0,lsl#24
  405 00002190 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 00002194 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  907 00002198                 fetch_c          4
   62 00002198         ;//-----------------------------------------------------
                       ----------------
   63 00002198 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 0000219C F100 0004       add              r0,r0,#4
   65 000021A0 F8CA 00A0       str              r0,clocksh
   66 000021A4         
   67 000021A4 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 000021A8         ;//-----------------------------------------------------



ARM Macro Assembler    Page 132 


                       --------------------
   69 000021A8 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   70 000021AC BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 000021B2         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 000021B2 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 000021B6 F8DA F088       ldr              pc,nexttimeout
  908 000021BA         ;-------------------------------------------------------
                       ---------------------
  909 000021BA         _DE                                  ;   DEC $nnnn,X
  910 000021BA         ;-------------------------------------------------------
                       ---------------------
  911 000021BA                 doAIX
  250 000021BA 00000004 
                       _type   SETA             _ABS
  251 000021BA F819 CB01       ldrb             addy,[m6502_pc],#1
  252 000021BE F819 0B01       ldrb             r0,[m6502_pc],#1
  253 000021C2 EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 000021C6 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 000021CA         ; bic addy,addy,#0xff0000 ;Base Wars needs this
  912 000021CA                 opDEC
  411 000021CA                 readmem
  122 000021CA                 [                _type = _ABS
  123 000021CA                 readmemabs
   83 000021CA F40C 4160       and              r1,addy,#0xE000
   84 000021CE F20F 0E0A       adr              lr,%F0
   85 000021D2         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000021D2 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 000021D6 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 000021DA         
   89 000021DA         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 000021DA                 ]
  125 000021DA                 [                _type = _ZP
  127                          ]
  128 000021DA                 [                _type = _ZPI
  130                          ]
  131 000021DA                 [                _type = _IMM
  133                          ]
  412 000021DA F1A0 0001       sub              r0,r0,#1
  413 000021DE EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  414 000021E2                 writemem
  179 000021E2                 [                _type = _ABS
  180 000021E2                 writememabs
  153 000021E2 F40C 4160       and              r1,addy,#0xe000
  154 000021E6 F10A 0224       adr              r2,writemem_tbl
  155 000021EA F20F 0E0A       adr              lr,%F0
  156 000021EE         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 000021EE EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 000021F2 F852 F001       ldr              pc,[r2,r1]
  159 000021F6         



ARM Macro Assembler    Page 133 


  160 000021F6         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 000021F6                 ]
  182 000021F6                 [                _type = _ZP
  184                          ]
  185 000021F6                 [                _type = _ZPI
  187                          ]
  913 000021F6                 fetch            7
   46 000021F6         ;//-----------------------------------------------------
                       ----------------
   47 000021F6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000021FA F100 0007       add              r0,r0,#7
   49 000021FE F8CA 00A0       str              r0,clocksh
   50 00002202         
   51 00002202 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00002206         ;//-----------------------------------------------------
                       --------------------
   53 00002206 F5B8 68E0       subs             cycles,cycles,#7*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000220A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00002210         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00002210 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00002214 F8DA F088       ldr              pc,nexttimeout
  914 00002218         ;-------------------------------------------------------
                       ---------------------
  915 00002218         _E0                                  ;   CPX #$nn
  916 00002218         ;-------------------------------------------------------
                       ---------------------
  917 00002218                 doIMM
  270 00002218 00000001 
                       _type   SETA             _IMM
  918 00002218                 opCOMP           m6502_x
  403 00002218                 readmem
  122 00002218                 [                _type = _ABS
  124                          ]
  125 00002218                 [                _type = _ZP
  127                          ]
  128 00002218                 [                _type = _ZPI
  130                          ]
  131 00002218                 [                _type = _IMM
  132 00002218                 readmemimm
  112 00002218 F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  133 0000221C                 ]
  404 0000221C EBB6 6300       subs             m6502_nz,m6502_x,r0,lsl#24
  405 00002220 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 00002224 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  919 00002228                 fetch_c          2
   62 00002228         ;//-----------------------------------------------------
                       ----------------
   63 00002228 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö



ARM Macro Assembler    Page 134 


                                                            ÓÊý
   64 0000222C F100 0002       add              r0,r0,#2
   65 00002230 F8CA 00A0       str              r0,clocksh
   66 00002234         
   67 00002234 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00002238         ;//-----------------------------------------------------
                       --------------------
   69 00002238 F578 7800       sbcs             cycles,cycles,#2*256 
                                                            ;//CYCLE=256
   70 0000223C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00002242         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00002242 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00002246 F8DA F088       ldr              pc,nexttimeout
  920 0000224A         ;-------------------------------------------------------
                       ---------------------
  921 0000224A         _E1                                  ;   SBC ($nn,X)
  922 0000224A         ;-------------------------------------------------------
                       ---------------------
  923 0000224A                 doIIX
  275 0000224A 00000004 
                       _type   SETA             _ABS
  276 0000224A F819 0B01       ldrb             r0,[m6502_pc],#1
  277 0000224E EB06 6000       add              r0,m6502_x,r0,lsl#24
  278 00002252         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  279 00002252 EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  280 00002256 F81B C00C       ldrb             addy,[cpu_zpage,addy]
  281 0000225A         
  282 0000225A F100 7080       add              r0,r0,#0x01000000
  283 0000225E         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  284 0000225E EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  285 00002262 F81B 1001       ldrb             r1,[cpu_zpage,r1]
  286 00002266         
  287 00002266 EA4C 2C01       orr              addy,addy,r1,lsl#8
  924 0000226A                 opSBC
  497 0000226A                 readmem
  122 0000226A                 [                _type = _ABS
  123 0000226A                 readmemabs
   83 0000226A F40C 4160       and              r1,addy,#0xE000
   84 0000226E F20F 0E0A       adr              lr,%F0
   85 00002272         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00002272 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00002276 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 0000227A         
   89 0000227A         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 0000227A                 ]
  125 0000227A                 [                _type = _ZP
  127                          ]
  128 0000227A                 [                _type = _ZPI



ARM Macro Assembler    Page 135 


  130                          ]
  131 0000227A                 [                _type = _IMM
  133                          ]
  498 0000227A EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  499 0000227E EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  500 00002282 F005 457F       and              m6502_a,m6502_a,#0xff000000
  501 00002286 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  502 0000228A F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  503 0000228E BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  925 00002294                 fetch_c          6
   62 00002294         ;//-----------------------------------------------------
                       ----------------
   63 00002294 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00002298 F100 0006       add              r0,r0,#6
   65 0000229C F8CA 00A0       str              r0,clocksh
   66 000022A0         
   67 000022A0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 000022A4         ;//-----------------------------------------------------
                       --------------------
   69 000022A4 F578 68C0       sbcs             cycles,cycles,#6*256 
                                                            ;//CYCLE=256
   70 000022A8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 000022AE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 000022AE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 000022B2 F8DA F088       ldr              pc,nexttimeout
  926 000022B6         ;-------------------------------------------------------
                       ---------------------
  927 000022B6         _E4                                  ;   CPX $nn
  928 000022B6         ;-------------------------------------------------------
                       ---------------------
  929 000022B6                 doZ
  322 000022B6 00000002 
                       _type   SETA             _ZP
  323 000022B6 F819 CB01       ldrb             addy,[m6502_pc],#1
  930 000022BA                 opCOMP           m6502_x
  403 000022BA                 readmem
  122 000022BA                 [                _type = _ABS
  124                          ]
  125 000022BA                 [                _type = _ZP
  126 000022BA                 readmemzp
   94 000022BA F81B 000C       ldrb             r0,[cpu_zpage,addy]
  127 000022BE                 ]
  128 000022BE                 [                _type = _ZPI
  130                          ]
  131 000022BE                 [                _type = _IMM
  133                          ]
  404 000022BE EBB6 6300       subs             m6502_nz,m6502_x,r0,lsl#24
  405 000022C2 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 000022C6 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  931 000022CA                 fetch_c          3
   62 000022CA         ;//-----------------------------------------------------
                       ----------------
   63 000022CA F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö



ARM Macro Assembler    Page 136 


                                                            ÓÊý
   64 000022CE F100 0003       add              r0,r0,#3
   65 000022D2 F8CA 00A0       str              r0,clocksh
   66 000022D6         
   67 000022D6 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 000022DA         ;//-----------------------------------------------------
                       --------------------
   69 000022DA F578 7840       sbcs             cycles,cycles,#3*256 
                                                            ;//CYCLE=256
   70 000022DE BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 000022E4         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 000022E4 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 000022E8 F8DA F088       ldr              pc,nexttimeout
  932 000022EC         ;-------------------------------------------------------
                       ---------------------
  933 000022EC         _E5                                  ;   SBC $nn
  934 000022EC         ;-------------------------------------------------------
                       ---------------------
  935 000022EC                 doZ
  322 000022EC 00000002 
                       _type   SETA             _ZP
  323 000022EC F819 CB01       ldrb             addy,[m6502_pc],#1
  936 000022F0                 opSBC
  497 000022F0                 readmem
  122 000022F0                 [                _type = _ABS
  124                          ]
  125 000022F0                 [                _type = _ZP
  126 000022F0                 readmemzp
   94 000022F0 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  127 000022F4                 ]
  128 000022F4                 [                _type = _ZPI
  130                          ]
  131 000022F4                 [                _type = _IMM
  133                          ]
  498 000022F4 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  499 000022F8 EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  500 000022FC F005 457F       and              m6502_a,m6502_a,#0xff000000
  501 00002300 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  502 00002304 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  503 00002308 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  937 0000230E                 fetch_c          3
   62 0000230E         ;//-----------------------------------------------------
                       ----------------
   63 0000230E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00002312 F100 0003       add              r0,r0,#3
   65 00002316 F8CA 00A0       str              r0,clocksh
   66 0000231A         
   67 0000231A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 0000231E         ;//-----------------------------------------------------
                       --------------------
   69 0000231E F578 7840       sbcs             cycles,cycles,#3*256 
                                                            ;//CYCLE=256
   70 00002322 BF5C F819 



ARM Macro Assembler    Page 137 


              0B01             ldrplb           r0,[m6502_pc],#1
   71 00002328         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00002328 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 0000232C F8DA F088       ldr              pc,nexttimeout
  938 00002330         ;-------------------------------------------------------
                       ---------------------
  939 00002330         _E6                                  ;   INC $nn
  940 00002330         ;-------------------------------------------------------
                       ---------------------
  941 00002330                 doZ
  322 00002330 00000002 
                       _type   SETA             _ZP
  323 00002330 F819 CB01       ldrb             addy,[m6502_pc],#1
  942 00002334                 opINC
  426 00002334                 readmem
  122 00002334                 [                _type = _ABS
  124                          ]
  125 00002334                 [                _type = _ZP
  126 00002334                 readmemzp
   94 00002334 F81B 000C       ldrb             r0,[cpu_zpage,addy]
  127 00002338                 ]
  128 00002338                 [                _type = _ZPI
  130                          ]
  131 00002338                 [                _type = _IMM
  133                          ]
  427 00002338 F100 0001       add              r0,r0,#1
  428 0000233C EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  429 00002340                 writemem
  179 00002340                 [                _type = _ABS
  181                          ]
  182 00002340                 [                _type = _ZP
  183 00002340                 writememzp
  165 00002340 F80B 000C       strb             r0,[cpu_zpage,addy]
  184 00002344                 ]
  185 00002344                 [                _type = _ZPI
  187                          ]
  943 00002344                 fetch            5
   46 00002344         ;//-----------------------------------------------------
                       ----------------
   47 00002344 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00002348 F100 0005       add              r0,r0,#5
   49 0000234C F8CA 00A0       str              r0,clocksh
   50 00002350         
   51 00002350 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00002354         ;//-----------------------------------------------------
                       --------------------
   53 00002354 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00002358 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000235E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000235E F851 F020       ldrpl            pc,[r1,r0,lsl#2]



ARM Macro Assembler    Page 138 


   57 00002362 F8DA F088       ldr              pc,nexttimeout
  944 00002366         ;-------------------------------------------------------
                       ---------------------
  945 00002366         _E8                                  ;   INX
  946 00002366         ;-------------------------------------------------------
                       ---------------------
  947 00002366 F106 7680       add              m6502_x,m6502_x,#0x01000000
  948 0000236A EA4F 6326       mov              m6502_nz,m6502_x,asr#24
  949 0000236E                 fetch            2
   46 0000236E         ;//-----------------------------------------------------
                       ----------------
   47 0000236E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00002372 F100 0002       add              r0,r0,#2
   49 00002376 F8CA 00A0       str              r0,clocksh
   50 0000237A         
   51 0000237A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000237E         ;//-----------------------------------------------------
                       --------------------
   53 0000237E F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00002382 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00002388         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00002388 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000238C F8DA F088       ldr              pc,nexttimeout
  950 00002390         ;-------------------------------------------------------
                       ---------------------
  951 00002390         _E9                                  ;   SBC #$nn
  952 00002390         ;-------------------------------------------------------
                       ---------------------
  953 00002390                 doIMM
  270 00002390 00000001 
                       _type   SETA             _IMM
  954 00002390                 opSBC
  497 00002390                 readmem
  122 00002390                 [                _type = _ABS
  124                          ]
  125 00002390                 [                _type = _ZP
  127                          ]
  128 00002390                 [                _type = _ZPI
  130                          ]
  131 00002390                 [                _type = _IMM
  132 00002390                 readmemimm
  112 00002390 F819 0B01       ldrb             r0,[m6502_pc],#1 ;ROM
  133 00002394                 ]
  498 00002394 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  499 00002398 EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  500 0000239C F005 457F       and              m6502_a,m6502_a,#0xff000000
  501 000023A0 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  502 000023A4 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  503 000023A8 BF78 F028 



ARM Macro Assembler    Page 139 


              0840             bicvc            cycles,cycles,#CYC_V ;V
  955 000023AE                 fetch_c          2
   62 000023AE         ;//-----------------------------------------------------
                       ----------------
   63 000023AE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 000023B2 F100 0002       add              r0,r0,#2
   65 000023B6 F8CA 00A0       str              r0,clocksh
   66 000023BA         
   67 000023BA F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 000023BE         ;//-----------------------------------------------------
                       --------------------
   69 000023BE F578 7800       sbcs             cycles,cycles,#2*256 
                                                            ;//CYCLE=256
   70 000023C2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 000023C8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 000023C8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 000023CC F8DA F088       ldr              pc,nexttimeout
  956 000023D0         ;-------------------------------------------------------
                       ---------------------
  957 000023D0         _EA                                  ;   NOP
  958 000023D0         ;-------------------------------------------------------
                       ---------------------
  959 000023D0                 fetch            2
   46 000023D0         ;//-----------------------------------------------------
                       ----------------
   47 000023D0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000023D4 F100 0002       add              r0,r0,#2
   49 000023D8 F8CA 00A0       str              r0,clocksh
   50 000023DC         
   51 000023DC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000023E0         ;//-----------------------------------------------------
                       --------------------
   53 000023E0 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000023E4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000023EA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000023EA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000023EE F8DA F088       ldr              pc,nexttimeout
  960 000023F2         ;-------------------------------------------------------
                       ---------------------
  961 000023F2         _EC                                  ;   CPX $nnnn
  962 000023F2         ;-------------------------------------------------------
                       ---------------------
  963 000023F2                 doABS
  242 000023F2 00000004 
                       _type   SETA             _ABS
  243 000023F2 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 000023F6 F819 0B01       ldrb             r0,[m6502_pc],#1



ARM Macro Assembler    Page 140 


  245 000023FA EA4C 2C00       orr              addy,addy,r0,lsl#8
  964 000023FE                 opCOMP           m6502_x
  403 000023FE                 readmem
  122 000023FE                 [                _type = _ABS
  123 000023FE                 readmemabs
   83 000023FE F40C 4160       and              r1,addy,#0xE000
   84 00002402 F20F 0E0A       adr              lr,%F0
   85 00002406         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00002406 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 0000240A F854 F001       ldr              pc,[m6502_rmem,r1]
   88 0000240E         
   89 0000240E         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 0000240E                 ]
  125 0000240E                 [                _type = _ZP
  127                          ]
  128 0000240E                 [                _type = _ZPI
  130                          ]
  131 0000240E                 [                _type = _IMM
  133                          ]
  404 0000240E EBB6 6300       subs             m6502_nz,m6502_x,r0,lsl#24
  405 00002412 EA4F 6323       mov              m6502_nz,m6502_nz,asr#24 ;NZ
  406 00002416 F048 0801       orr              cycles,cycles,#CYC_C ;Prepare C
                                                            
  965 0000241A                 fetch_c          4
   62 0000241A         ;//-----------------------------------------------------
                       ----------------
   63 0000241A F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 0000241E F100 0004       add              r0,r0,#4
   65 00002422 F8CA 00A0       str              r0,clocksh
   66 00002426         
   67 00002426 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 0000242A         ;//-----------------------------------------------------
                       --------------------
   69 0000242A F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   70 0000242E BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00002434         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00002434 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00002438 F8DA F088       ldr              pc,nexttimeout
  966 0000243C         ;-------------------------------------------------------
                       ---------------------
  967 0000243C         _ED                                  ;   SBC $nnnn
  968 0000243C         ;-------------------------------------------------------
                       ---------------------
  969 0000243C                 doABS
  242 0000243C 00000004 
                       _type   SETA             _ABS
  243 0000243C F819 CB01       ldrb             addy,[m6502_pc],#1
  244 00002440 F819 0B01       ldrb             r0,[m6502_pc],#1
  245 00002444 EA4C 2C00       orr              addy,addy,r0,lsl#8



ARM Macro Assembler    Page 141 


  970 00002448                 opSBC
  497 00002448                 readmem
  122 00002448                 [                _type = _ABS
  123 00002448                 readmemabs
   83 00002448 F40C 4160       and              r1,addy,#0xE000
   84 0000244C F20F 0E08       adr              lr,%F0
   85 00002450         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00002450 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00002454 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00002458         
   89 00002458         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00002458                 ]
  125 00002458                 [                _type = _ZP
  127                          ]
  128 00002458                 [                _type = _ZPI
  130                          ]
  131 00002458                 [                _type = _IMM
  133                          ]
  498 00002458 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  499 0000245C EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  500 00002460 F005 457F       and              m6502_a,m6502_a,#0xff000000
  501 00002464 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  502 00002468 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  503 0000246C BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  971 00002472                 fetch_c          4
   62 00002472         ;//-----------------------------------------------------
                       ----------------
   63 00002472 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00002476 F100 0004       add              r0,r0,#4
   65 0000247A F8CA 00A0       str              r0,clocksh
   66 0000247E         
   67 0000247E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 00002482         ;//-----------------------------------------------------
                       --------------------
   69 00002482 F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   70 00002486 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 0000248C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 0000248C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 00002490 F8DA F088       ldr              pc,nexttimeout
  972 00002494         ;-------------------------------------------------------
                       ---------------------
  973 00002494         _EE                                  ;   INC $nnnn
  974 00002494         ;-------------------------------------------------------
                       ---------------------
  975 00002494                 doABS
  242 00002494 00000004 
                       _type   SETA             _ABS



ARM Macro Assembler    Page 142 


  243 00002494 F819 CB01       ldrb             addy,[m6502_pc],#1
  244 00002498 F819 0B01       ldrb             r0,[m6502_pc],#1
  245 0000249C EA4C 2C00       orr              addy,addy,r0,lsl#8
  976 000024A0                 opINC
  426 000024A0                 readmem
  122 000024A0                 [                _type = _ABS
  123 000024A0                 readmemabs
   83 000024A0 F40C 4160       and              r1,addy,#0xE000
   84 000024A4 F20F 0E08       adr              lr,%F0
   85 000024A8         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000024A8 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 000024AC F854 F001       ldr              pc,[m6502_rmem,r1]
   88 000024B0         
   89 000024B0         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 000024B0                 ]
  125 000024B0                 [                _type = _ZP
  127                          ]
  128 000024B0                 [                _type = _ZPI
  130                          ]
  131 000024B0                 [                _type = _IMM
  133                          ]
  427 000024B0 F100 0001       add              r0,r0,#1
  428 000024B4 EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  429 000024B8                 writemem
  179 000024B8                 [                _type = _ABS
  180 000024B8                 writememabs
  153 000024B8 F40C 4160       and              r1,addy,#0xe000
  154 000024BC F10A 0224       adr              r2,writemem_tbl
  155 000024C0 F20F 0E08       adr              lr,%F0
  156 000024C4         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 000024C4 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 000024C8 F852 F001       ldr              pc,[r2,r1]
  159 000024CC         
  160 000024CC         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 000024CC                 ]
  182 000024CC                 [                _type = _ZP
  184                          ]
  185 000024CC                 [                _type = _ZPI
  187                          ]
  977 000024CC                 fetch            6
   46 000024CC         ;//-----------------------------------------------------
                       ----------------
   47 000024CC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000024D0 F100 0006       add              r0,r0,#6
   49 000024D4 F8CA 00A0       str              r0,clocksh
   50 000024D8         
   51 000024D8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000024DC         ;//-----------------------------------------------------



ARM Macro Assembler    Page 143 


                       --------------------
   53 000024DC F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000024E0 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000024E6         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000024E6 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000024EA F8DA F088       ldr              pc,nexttimeout
  978 000024EE         ;-------------------------------------------------------
                       ---------------------
  979 000024EE         _F0                                  ;   BEQ *
  980 000024EE         ;-------------------------------------------------------
                       ---------------------
  981 000024EE F013 0FFF       tst              m6502_nz,#0xff
  982 000024F2 F919 0B01       ldrsb            r0,[m6502_pc],#1
  983 000024F6 BF04 4481       addeq            m6502_pc,m6502_pc,r0
  984 000024FA         ; subeq cycles,cycles,#3*CYCLE
  985 000024FA F5A8 7880       subeq            cycles,cycles,#256
  986 000024FE                 fetch            2
   46 000024FE         ;//-----------------------------------------------------
                       ----------------
   47 000024FE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00002502 F100 0002       add              r0,r0,#2
   49 00002506 F8CA 00A0       str              r0,clocksh
   50 0000250A         
   51 0000250A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000250E         ;//-----------------------------------------------------
                       --------------------
   53 0000250E F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00002512 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00002518         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00002518 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000251C F8DA F088       ldr              pc,nexttimeout
  987 00002520         ;-------------------------------------------------------
                       ---------------------
  988 00002520         _F1                                  ;   SBC ($nn),Y
  989 00002520         ;-------------------------------------------------------
                       ---------------------
  990 00002520                 doIIY
  292 00002520 00000004 
                       _type   SETA             _ABS
  293 00002520 F819 0B01       ldrb             r0,[m6502_pc],#1
  294 00002524         ;// ldrb addy,[r0,cpu_zpage]! ;;ÔÚÊý¾Ý´«ËÍÖ®Ç°,½«Æ«ÒÆÁ¿¼
                       Óµ½Rn ÖÐ,Æä½á¹û×÷Îª´«ËÍÊý¾ÝµÄ´æ´¢µØÖ·
  295 00002524         ;//ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ



ARM Macro Assembler    Page 144 


  296 00002524 F810 C00B       ldrb             addy,[r0,cpu_zpage]
  297 00002528 4458            add              r0,r0,cpu_zpage ;//////////////
                                                            ///////////////////
                                                            /////
  298 0000252A         
  299 0000252A         
  300 0000252A 7841            ldrb             r1,[r0,#1]
  301 0000252C EA4C 2C01       orr              addy,addy,r1,lsl#8
  302 00002530 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  303 00002534         ; bic addy,addy,#0xff0000 ;Zelda2 needs this
  991 00002534                 opSBC
  497 00002534                 readmem
  122 00002534                 [                _type = _ABS
  123 00002534                 readmemabs
   83 00002534 F40C 4160       and              r1,addy,#0xE000
   84 00002538 F20F 0E08       adr              lr,%F0
   85 0000253C         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 0000253C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00002540 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00002544         
   89 00002544         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 00002544                 ]
  125 00002544                 [                _type = _ZP
  127                          ]
  128 00002544                 [                _type = _ZPI
  130                          ]
  131 00002544                 [                _type = _IMM
  133                          ]
  498 00002544 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  499 00002548 EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  500 0000254C F005 457F       and              m6502_a,m6502_a,#0xff000000
  501 00002550 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  502 00002554 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  503 00002558 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  992 0000255E                 fetch_c          5
   62 0000255E         ;//-----------------------------------------------------
                       ----------------
   63 0000255E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00002562 F100 0005       add              r0,r0,#5
   65 00002566 F8CA 00A0       str              r0,clocksh
   66 0000256A         
   67 0000256A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 0000256E         ;//-----------------------------------------------------
                       --------------------
   69 0000256E F578 68A0       sbcs             cycles,cycles,#5*256 
                                                            ;//CYCLE=256
   70 00002572 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00002578         ; ldrpl pc,[m6502_optbl,r0,lsl#2]



ARM Macro Assembler    Page 145 


   72 00002578 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 0000257C F8DA F088       ldr              pc,nexttimeout
  993 00002580         ;-------------------------------------------------------
                       ---------------------
  994 00002580         _F5                                  ;   SBC $nn,X
  995 00002580         ;-------------------------------------------------------
                       ---------------------
  996 00002580                 doZIXf
  342 00002580 00000003 
                       _type   SETA             _ZPI
  343 00002580 F819 CB01       ldrb             addy,[m6502_pc],#1
  344 00002584 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
  997 00002588                 opSBC
  497 00002588                 readmem
  122 00002588                 [                _type = _ABS
  124                          ]
  125 00002588                 [                _type = _ZP
  127                          ]
  128 00002588                 [                _type = _ZPI
  129 00002588                 readmemzpi
   99 00002588         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  100 00002588 EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  101 0000258C F81B 0000       ldrb             r0,[cpu_zpage,r0]
  102 00002590         
  130 00002590                 ]
  131 00002590                 [                _type = _IMM
  133                          ]
  498 00002590 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  499 00002594 EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  500 00002598 F005 457F       and              m6502_a,m6502_a,#0xff000000
  501 0000259C EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  502 000025A0 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  503 000025A4 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
  998 000025AA                 fetch_c          4
   62 000025AA         ;//-----------------------------------------------------
                       ----------------
   63 000025AA F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 000025AE F100 0004       add              r0,r0,#4
   65 000025B2 F8CA 00A0       str              r0,clocksh
   66 000025B6         
   67 000025B6 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 000025BA         ;//-----------------------------------------------------
                       --------------------
   69 000025BA F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   70 000025BE BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 000025C4         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 000025C4 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 000025C8 F8DA F088       ldr              pc,nexttimeout
  999 000025CC         ;-------------------------------------------------------
                       ---------------------
 1000 000025CC         _F6                                  ;   INC $nn,X
 1001 000025CC         ;-------------------------------------------------------
                       ---------------------



ARM Macro Assembler    Page 146 


 1002 000025CC                 doZIXf
  342 000025CC 00000003 
                       _type   SETA             _ZPI
  343 000025CC F819 CB01       ldrb             addy,[m6502_pc],#1
  344 000025D0 EB06 6C0C       add              addy,m6502_x,addy,lsl#24
 1003 000025D4                 opINC
  426 000025D4                 readmem
  122 000025D4                 [                _type = _ABS
  124                          ]
  125 000025D4                 [                _type = _ZP
  127                          ]
  128 000025D4                 [                _type = _ZPI
  129 000025D4                 readmemzpi
   99 000025D4         ;// ldrb r0,[cpu_zpage,addy,lsr#24]
  100 000025D4 EA4F 601C       lsr              r0,addy,#24 ;//¸Ä¹ý£¬¼Ó3ÐÐ
  101 000025D8 F81B 0000       ldrb             r0,[cpu_zpage,r0]
  102 000025DC         
  130 000025DC                 ]
  131 000025DC                 [                _type = _IMM
  133                          ]
  427 000025DC F100 0001       add              r0,r0,#1
  428 000025E0 EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  429 000025E4                 writemem
  179 000025E4                 [                _type = _ABS
  181                          ]
  182 000025E4                 [                _type = _ZP
  184                          ]
  185 000025E4                 [                _type = _ZPI
  186 000025E4                 writememzpi
  170 000025E4         ;// strb r0,[cpu_zpage,addy,lsr#24]
  171 000025E4 EA4F 611C       lsr              r1,addy,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>2
                                                            4
  172 000025E8 F80B 0001       strb             r0,[cpu_zpage,r1]
  173 000025EC         
  174 000025EC         
  187 000025EC                 ]
 1004 000025EC                 fetch            6
   46 000025EC         ;//-----------------------------------------------------
                       ----------------
   47 000025EC F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000025F0 F100 0006       add              r0,r0,#6
   49 000025F4 F8CA 00A0       str              r0,clocksh
   50 000025F8         
   51 000025F8 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000025FC         ;//-----------------------------------------------------
                       --------------------
   53 000025FC F5B8 68C0       subs             cycles,cycles,#6*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00002600 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00002606         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00002606 F851 F020       ldrpl            pc,[r1,r0,lsl#2]



ARM Macro Assembler    Page 147 


   57 0000260A F8DA F088       ldr              pc,nexttimeout
 1005 0000260E         ;-------------------------------------------------------
                       ---------------------
 1006 0000260E         _F8                                  ;   SED
 1007 0000260E         ;-------------------------------------------------------
                       ---------------------
 1008 0000260E F048 0808       orr              cycles,cycles,#CYC_D
 1009 00002612                 fetch            2
   46 00002612         ;//-----------------------------------------------------
                       ----------------
   47 00002612 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00002616 F100 0002       add              r0,r0,#2
   49 0000261A F8CA 00A0       str              r0,clocksh
   50 0000261E         
   51 0000261E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00002622         ;//-----------------------------------------------------
                       --------------------
   53 00002622 F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00002626 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000262C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000262C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00002630 F8DA F088       ldr              pc,nexttimeout
 1010 00002634         ;-------------------------------------------------------
                       ---------------------
 1011 00002634         _F9                                  ;   SBC $nnnn,Y
 1012 00002634         ;-------------------------------------------------------
                       ---------------------
 1013 00002634                 doAIY
  260 00002634 00000004 
                       _type   SETA             _ABS
  261 00002634 F819 CB01       ldrb             addy,[m6502_pc],#1
  262 00002638 F819 0B01       ldrb             r0,[m6502_pc],#1
  263 0000263C EA4C 2C00       orr              addy,addy,r0,lsl#8
  264 00002640 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  265 00002644         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
 1014 00002644                 opSBC
  497 00002644                 readmem
  122 00002644                 [                _type = _ABS
  123 00002644                 readmemabs
   83 00002644 F40C 4160       and              r1,addy,#0xE000
   84 00002648 F20F 0E08       adr              lr,%F0
   85 0000264C         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 0000264C EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00002650 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 00002654         
   89 00002654         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 



ARM Macro Assembler    Page 148 


                                                            preserved for RMW i
                                                            nstructions
  124 00002654                 ]
  125 00002654                 [                _type = _ZP
  127                          ]
  128 00002654                 [                _type = _ZPI
  130                          ]
  131 00002654                 [                _type = _IMM
  133                          ]
  498 00002654 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  499 00002658 EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  500 0000265C F005 457F       and              m6502_a,m6502_a,#0xff000000
  501 00002660 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  502 00002664 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  503 00002668 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1015 0000266E                 fetch_c          4
   62 0000266E         ;//-----------------------------------------------------
                       ----------------
   63 0000266E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 00002672 F100 0004       add              r0,r0,#4
   65 00002676 F8CA 00A0       str              r0,clocksh
   66 0000267A         
   67 0000267A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 0000267E         ;//-----------------------------------------------------
                       --------------------
   69 0000267E F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   70 00002682 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 00002688         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 00002688 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 0000268C F8DA F088       ldr              pc,nexttimeout
 1016 00002690         ;-------------------------------------------------------
                       ---------------------
 1017 00002690         _FD                                  ;   SBC $nnnn,X
 1018 00002690         ;-------------------------------------------------------
                       ---------------------
 1019 00002690                 doAIX
  250 00002690 00000004 
                       _type   SETA             _ABS
  251 00002690 F819 CB01       ldrb             addy,[m6502_pc],#1
  252 00002694 F819 0B01       ldrb             r0,[m6502_pc],#1
  253 00002698 EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 0000269C EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 000026A0         ; bic addy,addy,#0xff0000 ;Base Wars needs this
 1020 000026A0                 opSBC
  497 000026A0                 readmem
  122 000026A0                 [                _type = _ABS
  123 000026A0                 readmemabs
   83 000026A0 F40C 4160       and              r1,addy,#0xE000
   84 000026A4 F20F 0E08       adr              lr,%F0
   85 000026A8         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000026A8 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1



ARM Macro Assembler    Page 149 


   87 000026AC F854 F001       ldr              pc,[m6502_rmem,r1]
   88 000026B0         
   89 000026B0         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 000026B0                 ]
  125 000026B0                 [                _type = _ZP
  127                          ]
  128 000026B0                 [                _type = _ZPI
  130                          ]
  131 000026B0                 [                _type = _IMM
  133                          ]
  498 000026B0 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  499 000026B4 EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  500 000026B8 F005 457F       and              m6502_a,m6502_a,#0xff000000
  501 000026BC EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  502 000026C0 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  503 000026C4 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1021 000026CA                 fetch_c          4
   62 000026CA         ;//-----------------------------------------------------
                       ----------------
   63 000026CA F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   64 000026CE F100 0004       add              r0,r0,#4
   65 000026D2 F8CA 00A0       str              r0,clocksh
   66 000026D6         
   67 000026D6 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   68 000026DA         ;//-----------------------------------------------------
                       --------------------
   69 000026DA F578 6880       sbcs             cycles,cycles,#4*256 
                                                            ;//CYCLE=256
   70 000026DE BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1
   71 000026E4         ; ldrpl pc,[m6502_optbl,r0,lsl#2]
   72 000026E4 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   73 000026E8 F8DA F088       ldr              pc,nexttimeout
 1022 000026EC         ;-------------------------------------------------------
                       ---------------------
 1023 000026EC         _FE                                  ;   INC $nnnn,X
 1024 000026EC         ;-------------------------------------------------------
                       ---------------------
 1025 000026EC                 doAIX
  250 000026EC 00000004 
                       _type   SETA             _ABS
  251 000026EC F819 CB01       ldrb             addy,[m6502_pc],#1
  252 000026F0 F819 0B01       ldrb             r0,[m6502_pc],#1
  253 000026F4 EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 000026F8 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 000026FC         ; bic addy,addy,#0xff0000 ;Base Wars needs this
 1026 000026FC                 opINC
  426 000026FC                 readmem
  122 000026FC                 [                _type = _ABS
  123 000026FC                 readmemabs
   83 000026FC F40C 4160       and              r1,addy,#0xE000



ARM Macro Assembler    Page 150 


   84 00002700 F20F 0E08       adr              lr,%F0
   85 00002704         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00002704 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00002708 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 0000270C         
   89 0000270C         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 0000270C                 ]
  125 0000270C                 [                _type = _ZP
  127                          ]
  128 0000270C                 [                _type = _ZPI
  130                          ]
  131 0000270C                 [                _type = _IMM
  133                          ]
  427 0000270C F100 0001       add              r0,r0,#1
  428 00002710 EA40 6300       orr              m6502_nz,r0,r0,lsl#24 ;NZ
  429 00002714                 writemem
  179 00002714                 [                _type = _ABS
  180 00002714                 writememabs
  153 00002714 F40C 4160       and              r1,addy,#0xe000
  154 00002718 F10A 0224       adr              r2,writemem_tbl
  155 0000271C F20F 0E08       adr              lr,%F0
  156 00002720         ;// ldr pc,[r2,r1,lsr#11] ;//in: addy,r0=val(bits 8-31=?
                       )
  157 00002720 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ >>11
                                                            
  158 00002724 F852 F001       ldr              pc,[r2,r1]
  159 00002728         
  160 00002728         0                                    ;out: r0,r1,r2,addy
                                                            =?
  181 00002728                 ]
  182 00002728                 [                _type = _ZP
  184                          ]
  185 00002728                 [                _type = _ZPI
  187                          ]
 1027 00002728                 fetch            7
   46 00002728         ;//-----------------------------------------------------
                       ----------------
   47 00002728 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000272C F100 0007       add              r0,r0,#7
   49 00002730 F8CA 00A0       str              r0,clocksh
   50 00002734         
   51 00002734 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00002738         ;//-----------------------------------------------------
                       --------------------
   53 00002738 F5B8 68E0       subs             cycles,cycles,#7*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000273C BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë



ARM Macro Assembler    Page 151 


   55 00002742         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00002742 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00002746 F8DA F088       ldr              pc,nexttimeout
 1028 0000274A         ;*******************************************************
                       ****ÒÔÏÂÖ¸ÁîÊÇÒ»Ð©HACKÓÎÏ·ÐèÒª******************
 1029 0000274A         _FF                                  ;  ISB $????,X  ¼Óµ
                                                            Ä£¬²»È·¶¨ÕýÈ·    ¼¤
                                                            ¹êÈÌÕß´«2ÎÞµÐHACKÐè
                                                            Òª
 1030 0000274A         ;-------------------------------------------------------
                       ------------
 1031 0000274A                 doAIX                        ;MR_AX();
  250 0000274A 00000004 
                       _type   SETA             _ABS
  251 0000274A F819 CB01       ldrb             addy,[m6502_pc],#1
  252 0000274E F819 0B01       ldrb             r0,[m6502_pc],#1
  253 00002752 EA4C 2C00       orr              addy,addy,r0,lsl#8
  254 00002756 EB0C 6C16       add              addy,addy,m6502_x,lsr#24
  255 0000275A         ; bic addy,addy,#0xff0000 ;Base Wars needs this
 1032 0000275A                 opSBC                        ;ISB(); 
  497 0000275A                 readmem
  122 0000275A                 [                _type = _ABS
  123 0000275A                 readmemabs
   83 0000275A F40C 4160       and              r1,addy,#0xE000
   84 0000275E F20F 0E0A       adr              lr,%F0
   85 00002762         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 00002762 EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 00002766 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 0000276A         
   89 0000276A         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 0000276A                 ]
  125 0000276A                 [                _type = _ZP
  127                          ]
  128 0000276A                 [                _type = _ZPI
  130                          ]
  131 0000276A                 [                _type = _IMM
  133                          ]
  498 0000276A EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  499 0000276E EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  500 00002772 F005 457F       and              m6502_a,m6502_a,#0xff000000
  501 00002776 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  502 0000277A F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  503 0000277E BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1033 00002784         ;MW_EA();  #define MW_EA()  WR6502(EA,DT)  // EA .... EF
                       FECTIVE ADDRESS
 1034 00002784                 fetch            5           ;ADD_CYCLE(5);     
                                                                               
                                                                      // DT ...
                                                            . DATA



ARM Macro Assembler    Page 152 


   46 00002784         ;//-----------------------------------------------------
                       ----------------
   47 00002784 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00002788 F100 0005       add              r0,r0,#5
   49 0000278C F8CA 00A0       str              r0,clocksh
   50 00002790         
   51 00002790 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00002794         ;//-----------------------------------------------------
                       --------------------
   53 00002794 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00002798 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000279E         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000279E F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000027A2 F8DA F088       ldr              pc,nexttimeout
 1035 000027A6         ;-------------------------------------------------------
                       -----------------
 1036 000027A6         _FB                                  ;  ISB $????,X  ¼Óµ
                                                            Ä£¬²»È·¶¨ÕýÈ·    ¼¤
                                                            ¹êÈÌÕß´«2ÎÞµÐHACKÐè
                                                            Òª
 1037 000027A6         ;-------------------------------------------------------
                       ------------
 1038 000027A6                 doAIY                        ;MR_AY();
  260 000027A6 00000004 
                       _type   SETA             _ABS
  261 000027A6 F819 CB01       ldrb             addy,[m6502_pc],#1
  262 000027AA F819 0B01       ldrb             r0,[m6502_pc],#1
  263 000027AE EA4C 2C00       orr              addy,addy,r0,lsl#8
  264 000027B2 EB0C 6C17       add              addy,addy,m6502_y,lsr#24
  265 000027B6         ; bic addy,addy,#0xff0000 ;Tecmo Bowl needs this
 1039 000027B6                 opSBC                        ;ISB(); 
  497 000027B6                 readmem
  122 000027B6                 [                _type = _ABS
  123 000027B6                 readmemabs
   83 000027B6 F40C 4160       and              r1,addy,#0xE000
   84 000027BA F20F 0E0A       adr              lr,%F0
   85 000027BE         ;// ldr pc,[m6502_rmem,r1,lsr#11] ;//in: addy,r1=addy&0x
                       E000 (for rom_R)
   86 000027BE EA4F 21D1       lsr              r1,r1,#11   ;//¸Ä¹ý£¬¼Ó2ÐÐ  >>1
                                                            1
   87 000027C2 F854 F001       ldr              pc,[m6502_rmem,r1]
   88 000027C6         
   89 000027C6         0                                    ;//out: r0=val (bit
                                                            s 8-31=0 (LSR,ROR,I
                                                            NC,DEC,ASL)), addy 
                                                            preserved for RMW i
                                                            nstructions
  124 000027C6                 ]
  125 000027C6                 [                _type = _ZP
  127                          ]



ARM Macro Assembler    Page 153 


  128 000027C6                 [                _type = _ZPI
  130                          ]
  131 000027C6                 [                _type = _IMM
  133                          ]
  498 000027C6 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  499 000027CA EB75 6500       sbcs             m6502_a,m6502_a,r0,lsl#24
  500 000027CE F005 457F       and              m6502_a,m6502_a,#0xff000000
  501 000027D2 EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  502 000027D6 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  503 000027DA BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1040 000027E0         ;MW_EA();  
 1041 000027E0                 fetch            5           ;ADD_CYCLE(5);     
                                                                               
                                                                      
   46 000027E0         ;//-----------------------------------------------------
                       ----------------
   47 000027E0 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000027E4 F100 0005       add              r0,r0,#5
   49 000027E8 F8CA 00A0       str              r0,clocksh
   50 000027EC         
   51 000027EC F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000027F0         ;//-----------------------------------------------------
                       --------------------
   53 000027F0 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000027F4 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000027FA         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000027FA F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000027FE F8DA F088       ldr              pc,nexttimeout
 1042 00002802         ;-------------------------------------------------------
                       -----------------
 1043 00002802         _14                                  ;      ¼ÓµÄ£¬²»È·¶¨
                                                            ÕýÈ·          ¼¤¹êÈ
                                                            ÌÕß´«2ÎÞµÐHACKÐèÒª
 1044 00002802         ;-------------------------------------------------------
                       ------------
 1045 00002802 F109 0901       add              m6502_pc,m6502_pc,#1 ;R.PC++;
 1046 00002806                 fetch            4           ;ADD_CYCLE(4);     
                                                                               
                                                               
   46 00002806         ;//-----------------------------------------------------
                       ----------------
   47 00002806 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 0000280A F100 0004       add              r0,r0,#4
   49 0000280E F8CA 00A0       str              r0,clocksh
   50 00002812         
   51 00002812 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·



ARM Macro Assembler    Page 154 


   52 00002816         ;//-----------------------------------------------------
                       --------------------
   53 00002816 F5B8 6880       subs             cycles,cycles,#4*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 0000281A BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00002820         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00002820 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00002824 F8DA F088       ldr              pc,nexttimeout
 1047 00002828         ;-------------------------------------------------------
                       ------------
 1048 00002828         _67                                  ; // RRA $??       
                                                                      µÛ¹úÕ½»úÎ
                                                            ÞµÐHACKÐèÒª
 1049 00002828         ;-------------------------------------------------------
                       ------------
 1050 00002828                 doZ                          ;MR_ZP(); 
  322 00002828 00000002 
                       _type   SETA             _ZP
  323 00002828 F819 CB01       ldrb             addy,[m6502_pc],#1
 1051 0000282C                 opADC                        ;RRA(); 
  366 0000282C                 readmem
  122 0000282C                 [                _type = _ABS
  124                          ]
  125 0000282C                 [                _type = _ZP
  126 0000282C                 readmemzp
   94 0000282C F81B 000C       ldrb             r0,[cpu_zpage,addy]
  127 00002830                 ]
  128 00002830                 [                _type = _ZPI
  130                          ]
  131 00002830                 [                _type = _IMM
  133                          ]
  367 00002830 EA5F 0158       movs             r1,cycles,lsr#1 ;get C
  368 00002834 BF28 F5A0 
              7080             subcs            r0,r0,#0x00000100
  369 0000283A EB55 2530       adcs             m6502_a,m6502_a,r0,ror#8
  370 0000283E EA4F 6325       mov              m6502_nz,m6502_a,asr#24 ;NZ
  371 00002842 F048 0841       orr              cycles,cycles,#CYC_C+CYC_V 
                                                            ;Prepare C & V
  372 00002846 BF78 F028 
              0840             bicvc            cycles,cycles,#CYC_V ;V
 1052 0000284C         ;MW_ZP();
 1053 0000284C                 fetch            5           ;ADD_CYCLE(5);    
   46 0000284C         ;//-----------------------------------------------------
                       ----------------
   47 0000284C F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00002850 F100 0005       add              r0,r0,#5
   49 00002854 F8CA 00A0       str              r0,clocksh
   50 00002858         
   51 00002858 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000285C         ;//-----------------------------------------------------
                       --------------------



ARM Macro Assembler    Page 155 


   53 0000285C F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00002860 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00002866         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00002866 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000286A F8DA F088       ldr              pc,nexttimeout
 1054 0000286E         ;-------------------------------------------------------
                       -------------
 1055 0000286E         _03                                  ; // SLO ($??,X)   
                                                                       µÛ¹úÕ½»ú
                                                            ÎÞµÐHACKÐèÒª
 1056 0000286E         ;-------------------------------------------------------
                       ------------
 1057 0000286E                 doIIX                        ;MR_IX(); 
  275 0000286E 00000004 
                       _type   SETA             _ABS
  276 0000286E F819 0B01       ldrb             r0,[m6502_pc],#1
  277 00002872 EB06 6000       add              r0,m6502_x,r0,lsl#24
  278 00002876         ;//ldrb addy,[cpu_zpage,r0,lsr#24] ;//´íÎó:Ö¸¶¨µÄ×ª±ä²»Ô
                       ÊÐí
  279 00002876 EA4F 6C10       lsr              addy,r0,#24 ;//¸Ä¹ý£¬¼Ó2ÐÐ >>24
                                                            
  280 0000287A F81B C00C       ldrb             addy,[cpu_zpage,addy]
  281 0000287E         
  282 0000287E F100 7080       add              r0,r0,#0x01000000
  283 00002882         ;//ldrb r1,[cpu_zpage,r0,lsr#24] ;//R1,LSR#2;½«R1ÖÐµÄÄÚÈ
                       ÝÓÒÒÆ2Î»
  284 00002882 EA4F 6110       lsr              r1,r0,#24   ;//¸Ä¹ý£¬¼Ó2ÐÐ
  285 00002886 F81B 1001       ldrb             r1,[cpu_zpage,r1]
  286 0000288A         
  287 0000288A EA4C 2C01       orr              addy,addy,r1,lsl#8
 1058 0000288E         ;SLO(); 
 1059 0000288E         ;MW_EA();
 1060 0000288E                 fetch            8           ; ;ADD_CYCLE(8);
   46 0000288E         ;//-----------------------------------------------------
                       ----------------
   47 0000288E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00002892 F100 0008       add              r0,r0,#8
   49 00002896 F8CA 00A0       str              r0,clocksh
   50 0000289A         
   51 0000289A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 0000289E         ;//-----------------------------------------------------
                       --------------------
   53 0000289E F5B8 6800       subs             cycles,cycles,#8*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000028A2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000028A8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0



ARM Macro Assembler    Page 156 


                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000028A8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000028AC F8DA F088       ldr              pc,nexttimeout
 1061 000028B0         ;-------------------------------------------------------
                       ----------
 1062 000028B0         _07                                  ; // SLO $??
 1063 000028B0         ;-------------------------------------------------------
                       -----------
 1064 000028B0                 doZ                          ;MR_ZP(); 
  322 000028B0 00000002 
                       _type   SETA             _ZP
  323 000028B0 F819 CB01       ldrb             addy,[m6502_pc],#1
 1065 000028B4         ;SLO(); 
 1066 000028B4         ;MW_ZP();
 1067 000028B4                 fetch            5           ;ADD_CYCLE(5);
   46 000028B4         ;//-----------------------------------------------------
                       ----------------
   47 000028B4 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000028B8 F100 0005       add              r0,r0,#5
   49 000028BC F8CA 00A0       str              r0,clocksh
   50 000028C0         
   51 000028C0 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000028C4         ;//-----------------------------------------------------
                       --------------------
   53 000028C4 F5B8 68A0       subs             cycles,cycles,#5*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000028C8 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000028CE         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000028CE F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000028D2 F8DA F088       ldr              pc,nexttimeout
 1068 000028D6         
 1069 000028D6         ;-------------------------------------------------------
                       ---------------------
 1070 000028D6                 IMPORT           debug_6502  ;main.c
 1071 000028D6         _xx                                  ; ???     ;invalid 
                                                            opcode ÎÞÐ§µÄ²Ù×÷Âë
                                                            
 1072 000028D6         ;-------------------------------------------------------
                       ---------------------
 1073 000028D6 F04F 0101       mov              r1,#1       ;²»ÓÃdebug¿ÉÒÔÖ±½Ó×
                                                            ¢ÒëÕâÁ½ÐÐ
 1074 000028DA F7FF FFFE       bl               debug_6502
 1075 000028DE         
 1076 000028DE                 fetch            2
   46 000028DE         ;//-----------------------------------------------------
                       ----------------
   47 000028DE F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000028E2 F100 0002       add              r0,r0,#2
   49 000028E6 F8CA 00A0       str              r0,clocksh



ARM Macro Assembler    Page 157 


   50 000028EA         
   51 000028EA F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000028EE         ;//-----------------------------------------------------
                       --------------------
   53 000028EE F5B8 7800       subs             cycles,cycles,#2*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000028F2 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000028F8         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000028F8 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000028FC F8DA F088       ldr              pc,nexttimeout
 1077 00002900         
 1078 00002900         ;*******************************************************
                       **********************************************
 1079 00002900         
 1080 00002900                 AREA             cpu_run, CODE, READONLY
 1081 00000000         run6502 PROC                         ;r0=ÒªÔËÐÐµÄcpuÖÜÆÚ
                                                            *256
 1082 00000000         ;-------------------------------------------------------
                       ---------------------
 1083 00000000         
 1084 00000000 E92D 4FF0       stmfd            sp!,{r4-r11,lr} ;½«Õâ¼¸¸ö¼Ä´æÆ÷
                                                            ÖÐµÄÖµ±£´æµ½¶ÑÕ»ÖÐ
 1085 00000004         
 1086 00000004 F8DF A180       ldr              globalptr,=cpu_data ;r10   wram
                                                            _globals: ¶ÁÈ¡µØÖ·
 1087 00000008 F8DF B180       ldr              cpu_zpage,=NES_RAM ;r11
 1088 0000000C F8DB B000       ldr              cpu_zpage,[cpu_zpage] 
                                                            ;NES_RAMÓÃÁËÖ¸Õë
 1089 00000010         
 1090 00000010 F10A 0164       adr              r1,cpuregs
 1091 00000014 E891 03F8       ldmia            r1,{m6502_nz-m6502_pc} ;restore
                                                             6502 state»Ö¸´6502
                                                            ×´Ì¬  r3-r9 
 1092 00000018 4480            add              cycles,cycles,r0
 1093 0000001A         
 1094 0000001A F89A 00A8       ldrb             r0,cpuirqf  ;cpuÖÐ¶Ï±êÖ¾
 1095 0000001E 2801            cmp              r0,#0x01    ;
 1096 00000020 D036            beq              CheckI      ;EQ       ÏàµÈ(EQua
                                                            l) irq6502;
 1097 00000022         
 1098 00000022                 fetch            0           ;//ÌáÈ¡²Ù×÷Âë²¢ÔËÐÐ
                                                                      
   46 00000022         ;//-----------------------------------------------------
                       ----------------
   47 00000022 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000026 F100 0000       add              r0,r0,#0
   49 0000002A F8CA 00A0       str              r0,clocksh
   50 0000002E         
   51 0000002E F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 00000032         ;//-----------------------------------------------------



ARM Macro Assembler    Page 158 


                       --------------------
   53 00000032 F1B8 0800       subs             cycles,cycles,#0*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000036 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 0000003C         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 0000003C F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 00000040 F8DA F088       ldr              pc,nexttimeout
 1099 00000044         exit_run
 1100 00000044         
 1101 00000044 F89A 00A4       ldrb             r0,cpunmif  ;cpuÖÐ¶Ï±êÖ¾
 1102 00000048 2801            cmp              r0,#0x01    ;
 1103 0000004A D0FE            beq              NMI6502     ;EQ       ÏàµÈ(EQua
                                                            l) 
 1104 0000004C         
 1105 0000004C         exit_nmi
 1106 0000004C F10A 0064       adr              r0,cpuregs
 1107 00000050 E880 03F8       stmia            r0,{m6502_nz-m6502_pc} ;±£´æ650
                                                            2×´Ì¬   r3-r9
 1108 00000054         
 1109 00000054 E8BD 8FF0       ldmfd            sp!,{r4-r11,pc} ;exit      
 1110 00000058                 ENDP
 1111 00000058         ;*******************************************************
                       ********************************
 1112 00000058         NMI6502 PROC                         ;------------------
                                                            ---------
 1113 00000058 F04F 0000       mov              r0,#0
 1114 0000005C F8CA 00A4       str              r0,cpunmif  ;Çå³ýcpuÖÐ¶Ï±êÖ¾   
                                                            
 1115 00000060         
 1116 00000060 F64F 7CFA       ldr              r12,=NMI_VECTOR ;NMI?  addy
 1117 00000064 F000 F830       bl               Vec6502
 1118 00000068 F5A8 68E0       sub              cycles,cycles,#7*256 ;CYCLE=256
                                                              6502µÄÖÐ¶ÏÇ±·üÆÚÎ
                                                            ªÆß (7) ¸öÖÜ
 1119 0000006C         ; ÆÚ; ÕâÒ²¾ÍÊÇËµÐèÒªÐèÒªÆß (7) ¸öÖÜÆÚÀ´ÒÆÈëºÍÒÆ³öÒ»¸öÖÐ¶
                       Ï
 1120 0000006C E7EE            b                exit_nmi    ;return 
 1121 0000006E                 ENDP
 1122 0000006E         ;-------------------------------------------------------
                       ---------------------
 1123 0000006E         
 1124 0000006E         default_scanlinehook
 1125 0000006E         
 1126 0000006E                 fetch            0
   46 0000006E         ;//-----------------------------------------------------
                       ----------------
   47 0000006E F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 00000072 F100 0000       add              r0,r0,#0
   49 00000076 F8CA 00A0       str              r0,clocksh
   50 0000007A         
   51 0000007A F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·



ARM Macro Assembler    Page 159 


   52 0000007E         ;//-----------------------------------------------------
                       --------------------
   53 0000007E F1B8 0800       subs             cycles,cycles,#0*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 00000082 BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 00000088         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 00000088 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 0000008C F8DA F088       ldr              pc,nexttimeout
 1127 00000090         ;-------------------------------------------------------
                       ---
 1128 00000090         CheckI                               ;Check Interrupt Di
                                                            sable ¼ì²éÖÐ¶Ï½ûÓÃ
 1129 00000090         ;-------------------------------------------------------
                       ---
 1130 00000090 F018 0F04       tst              cycles,#CYC_I
 1131 00000094 D1EB            bne              default_scanlinehook ;we dont w
                                                            ant no stinkin irqs
                                                             ÎÒÃÇ²»ÐèÒªÃ»ÓÐÌÖÑá
                                                            µÄIRQ
 1132 00000096         ;-------------------------------------------------------
                       ---
 1133 00000096         irq6502
 1134 00000096         ;-------------------------------------------------------
                       ---
 1135 00000096 F04F 0000       mov              r0,#0
 1136 0000009A F8CA 00A8       str              r0,cpuirqf  ;Çå³ýcpuÖÐ¶Ï±êÖ¾
 1137 0000009E         
 1138 0000009E F64F 7CFE       ldr              r12,=IRQ_VECTOR
 1139 000000A2 F000 F811       bl               Vec6502
 1140 000000A6                 fetch            7
   46 000000A6         ;//-----------------------------------------------------
                       ----------------
   47 000000A6 F8DA 00A0       ldr              r0,clocksh  ;//´¦ÀíapuÐèÒªµÄÊ±Ö
                                                            ÓÊý
   48 000000AA F100 0007       add              r0,r0,#7
   49 000000AE F8CA 00A0       str              r0,clocksh
   50 000000B2         
   51 000000B2 F8DA 1000       ldr              r1,opz      ;//»ñÈ¡´úÂëÌø×ª±íµØ
                                                            Ö·
   52 000000B6         ;//-----------------------------------------------------
                       --------------------
   53 000000B6 F5B8 68E0       subs             cycles,cycles,#7*256 ;//CYCLE=2
                                                            56 ;// 3*256 ÕýÊý»ò
                                                            0¾ÍÖ´ÐÐÏÂ2ÌõÖ¸Áî  
   54 000000BA BF5C F819 
              0B01             ldrplb           r0,[m6502_pc],#1 ; //´Ó´æ´¢Æ÷ÖÐ
                                                            ¼ÓÔØ×Ö½Úµ½Ò»¸ö¼Ä´æÆ
                                                            ÷ÖÐ  r0=²Ù×÷Âë
   55 000000C0         ; ldrpl pc,[m6502_optbl,r0,lsl#2]   ;//r10 ********r0=r0
                       x4***ÔËÐÐ´úÂëµÄµØÖ·*************************************
                       *
   56 000000C0 F851 F020       ldrpl            pc,[r1,r0,lsl#2]
   57 000000C4 F8DA F088       ldr              pc,nexttimeout



ARM Macro Assembler    Page 160 


 1141 000000C8         ;-------------------------------------------------------
                       ---
 1142 000000C8         Vec6502
 1143 000000C8         ;-------------------------------------------------------
                       ---
 1144 000000C8 F8DA 0084       ldr              r0,lastbank
 1145 000000CC EBA9 0000       sub              r0,m6502_pc,r0
 1146 000000D0                 push16                       ;save PC
  193 000000D0 EA4F 2110       mov              r1,r0,lsr#8
  194 000000D4 F8DA 2080       ldr              r2,m6502_s
  195 000000D8 F802 1901       strb             r1,[r2],#-1
  196 000000DC F442 7280       orr              r2,r2,#0x100
  197 000000E0 F802 0901       strb             r0,[r2],#-1
  198 000000E4 F88A 2080       strb             r2,m6502_s
 1147 000000E8         
 1148 000000E8                 encodeP          (R)         ;save P
   27 000000E8 F008 004D       and              r0,cycles,#CYC_V+CYC_D+CYC_I+CY
C_C
   28 000000EC F013 4F00       tst              m6502_nz,#0x80000000 ;//PSR_N
   29 000000F0 BF18 F040 
              0080             orrne            r0,r0,#N    ;N
   30 000000F6 F013 0FFF       tst              m6502_nz,#0xff
   31 000000FA BF08 F040 
              0002             orreq            r0,r0,#Z    ;Z
   32 00000100 F040 0020       orr              r0,r0,#(R)  ;R(&B)
 1149 00000104         VecCont
 1150 00000104                 push8            r0
  203 00000104 F8DA 2080       ldr              r2,m6502_s
  204 00000108 F802 0901       strb             r0,[r2],#-1
  205 0000010C F88A 2080       strb             r2,m6502_s
 1151 00000110         
 1152 00000110 F048 0804       orr              cycles,cycles,#CYC_I ;disable I
                                                            RQ ½ûÓÃIRQ
 1153 00000114         
 1154 00000114 F8DA 0060       ldr              r0,memmap_tbl+28 ;7*4
 1155 00000118         ; ldrb m6502_pc,[r0,r12]!
 1156 00000118 F810 900C       ldrb             m6502_pc,[r0,r12] ;ÔÚÊý¾Ý´«ËÍÖ®
                                                            Ç°,½«Æ«ÒÆÁ¿¼Óµ½Rn Ö
                                                            Ð,Æä½á¹û×÷Îª´«ËÍÊý¾
                                                            ÝµÄ´æ´¢µØÖ·
 1157 0000011C         ;ÈôÊ¹ÓÃºó×º"!",Ôò½á¹ûÐ´»Øµ½RnÖÐ
 1158 0000011C 4460            add              r0,r0,r12   ;R12=0xfffc ;// ¸´Î
                                                            »ÖÐ¶ÏÏòÁ¿µØÖ·
 1159 0000011E         
 1160 0000011E 7842            ldrb             r2,[r0,#1]
 1161 00000120 EA49 2902       orr              m6502_pc,m6502_pc,r2,lsl#8
 1162 00000124                 encodePC                     ;get IRQ vectorµÃµ½
                                                            6502 PC ROMµÄÆ«ÒÆÁ¿
                                                            
   15 00000124 F409 4160       and              r1,m6502_pc,#0xE000 ;//r9ºÍ0xe0
                                                            00°´Î»ÓëÔËËã
   16 00000128 F10A 0244       adr              r2,memmap_tbl ;//°Ñ´æ´¢Æ÷Ó³ÏóµØ
                                                            Ö·¼ÓÔØµ½r2
   17 0000012C         ;// ldr r0,[r2,r1,lsr#11]    ;//¸Ä¹ý£¬¼Ó2ÐÐ 
   18 0000012C EA4F 20D1       lsr              r0,r1,#11   ;//>>11Î»   r1/2048
                                                            
   19 00000130 5810            ldr              r0,[r2,r0]  ;//¶ÁÈ¡r2µØÖ·+r1Æ«Ò
                                                            ÆµÄÊý¾Ýµ½r0
   20 00000132         



ARM Macro Assembler    Page 161 


   21 00000132 F8CA 0084       str              r0,lastbank ;//±£´æ6502PC´Ó ROM
                                                            µÄ×îºóÆ«ÒÆÁ¿ 
   22 00000136 4481            add              m6502_pc,m6502_pc,r0 
                                                            ;//m6502_pc+r0
 1163 00000138         
 1164 00000138 4770            bx               lr          ; º¯Êý·µ»Ø
 1165 0000013A         ;-------------------------------------------------------
                       ---------------------
 1166 0000013A         CPU_reset
                               PROC                         ;called by loadcart
                                                             (r0-r9 are free to
                                                             use)
 1167 0000013A         ;-------------------------------------------------------
                       ---------------------
 1168 0000013A F84D ED04       str              lr,[sp,#-4]!
 1169 0000013E         
 1170 0000013E F04F 0500       mov              m6502_a,#0
 1171 00000142 F04F 0600       mov              m6502_x,#0
 1172 00000146 F04F 0700       mov              m6502_y,#0
 1173 0000014A F04F 0300       mov              m6502_nz,#0
 1174 0000014E F10A 0404       adr              m6502_rmem,readmem_tbl ;°Ñreadm
                                                            em_tblµÄµØÖ·¼ÓÔØµ½m
                                                            6502_rmem
 1175 00000152         
 1176 00000152         ; ldr r0,=NES_RAM+0x100    ;256 
 1177 00000152 480E            ldr              r0,=NES_RAM ;NES_RAMÓÃÁËÖ¸Õë
 1178 00000154 6800            ldr              r0,[r0]     ;
 1179 00000156 F500 7080       add              r0,#0x100
 1180 0000015A         
 1181 0000015A F8CA 0080       str              r0,m6502_s  ;S=0xFD (0x100-3)  
                                                             °ÑÒ»¸ö¼Ä´æÆ÷°´×Ö´æ
                                                            ´¢µ½´æ´¢Æ÷ÖÐ
 1182 0000015E         ;-------------------------------------------------------
                        
 1183 0000015E F04F 0000       mov              r0,#0
 1184 00000162 F8CA 00A4       str              r0,cpunmif  ;Çå³ýcpuÖÐ¶Ï±êÖ¾
 1185 00000166 F8CA 00A8       str              r0,cpuirqf  ;Çå³ýcpuÖÐ¶Ï±êÖ¾
 1186 0000016A         ;------------------------------------------ 
 1187 0000016A F04F 0800       mov              cycles,#0   ;D=0, C=0, V=0, I=1
                                                             disable IRQ.
 1188 0000016E         
 1189 0000016E F64F 7CFC       ldr              r12,=RES_VECTOR ;// ¸´Î»ÖÐ¶ÏÏòÁ
                                                            ¿µØÖ·
 1190 00000172 F7FF FFA9       bl               Vec6502
 1191 00000176         
 1192 00000176 F10A 0064       adr              r0,cpuregs  ;¶ÁÈ¡µØÖ·
 1193 0000017A E880 03F8       stmia            r0,{m6502_nz-m6502_pc} 
                                                            ;±£´æ6502×´Ì¬
 1194 0000017E         
 1195 0000017E 4904            ldr              r1,=exit_run ;
 1196 00000180 F8CA 1088       str              r1,nexttimeout ;±£´æÖ¸ÁîÖ´ÐÐÍêº
                                                            óÏÂÒ»²½µÄPCµØÖ·
 1197 00000184         
 1198 00000184 F85D FB04       ldr              pc,[sp],#4
 1199 00000188                 ENDP
 1200 00000188         ; nop
 1201 00000188         ;-------------------------------------------------------
                       ------------------
 1202 00000188         



ARM Macro Assembler    Page 162 


 1203 00000188 00000000 
              00000000 
              00000000         AREA             rwram_code, CODE, READONLY ;REA
                                                            DWRITE*************
                                                            *******************
                                                            ******
 1204 00000000         ;-------------------------------------------------------
                       ---------------------
 1205 00000000         ;memory
 1206 00000000         ;-------------------------------------------------------
                       -----------------
 1207 00000000         empty_R                              ;¶ÁµØÖ·²»ÕýÈ·read b
                                                            ad address (error)
 1208 00000000         ;-------------------------------------------------------
                       --------------------- 
 1209 00000000 4660            mov              r0,r12
 1210 00000002 F04F 0102       mov              r1,#2
 1211 00000006 F7FF FFFE       bl               debug_6502
 1212 0000000A         ;----------------------------------
 1213 0000000A F04F 0000       mov              r0,#0
 1214 0000000E F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1215 00000012 4770            bx               lr
 1216 00000014         ;-------------------------------------------------------
                       ---------------------
 1217 00000014         void    PROC                         ;- - - - - - - - -¿
                                                            Õº¯Êý
 1218 00000014 F04F 0000       mov              r0,#0
 1219 00000018 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1220 0000001C 4770            bx               lr
 1221 0000001E                 ENDP
 1222 0000001E         ;-------------------------------------------------------
                       ---------------------
 1223 0000001E         ram_R                                ;ram read ($0000-$1
                                                            FFF)
 1224 0000001E         ;-------------------------------------------------------
                       ---------------------
 1225 0000001E F42C 3CFC       bic              addy,addy,#0x1f800 
                                                            ;only 0x07FF is RAM
                                                            
 1226 00000022 F81B 000C       ldrb             r0,[cpu_zpage,addy]
 1227 00000026 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1228 0000002A 4770            bx               lr
 1229 0000002C         ;-------------------------------------------------------
                       ---------------------
 1230 0000002C         ram_W                                ;ram write ($0000-$
                                                            1FFF)
 1231 0000002C         ;-------------------------------------------------------
                       ---------------------
 1232 0000002C F42C 3CFC       bic              addy,addy,#0x1f800 
                                                            ;only 0x07FF is RAM
                                                            
 1233 00000030 F80B 000C       strb             r0,[cpu_zpage,addy] ; cpu_zpage
                                                             RN r11 ;=CPU_RAM
 1234 00000034 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1235 00000038 4770            bx               lr



ARM Macro Assembler    Page 163 


 1236 0000003A         ;-------------------------------------------------------
                       ---------------------
 1237 0000003A         sram_R                               ;sram read ($6000-$
                                                            7FFF)
 1238 0000003A         ;-------------------------------------------------------
                       ---------------------
 1239 0000003A F5AC 41C0       sub              r1,addy,#0x6000
 1240 0000003E F8DA 2050       ldr              r2,memmap_tbl+12
 1241 00000042         ; ldrb r0,[cpu_zpage,r1]
 1242 00000042 5C50            ldrb             r0,[r2,r1]
 1243 00000044 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1244 00000048 4770            bx               lr
 1245 0000004A         ;-------------------------------------------------------
                       ---------------------
 1246 0000004A         sram_W                               ;sram write ($6000-
                                                            $7FFF)
 1247 0000004A         ;-------------------------------------------------------
                       ---------------------
 1248 0000004A F5AC 4CC0       sub              addy,addy,#0x6000
 1249 0000004E F8DA 1050       ldr              r1,memmap_tbl+12
 1250 00000052         ; strb r0,[cpu_zpage,addy]
 1251 00000052 F801 000C       strb             r0,[r1,addy]
 1252 00000056 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1253 0000005A 4770            bx               lr
 1254 0000005C         ;-------------------------------------------------------
                       ---------------------
 1255 0000005C         rom_R60                              ;rom read ($6000-$7
                                                            FFF)
 1256 0000005C         ;-------------------------------------------------------
                       ---------------------
 1257 0000005C F8DA 1050       ldr              r1,memmap_tbl+12
 1258 00000060 F811 000C       ldrb             r0,[r1,addy]
 1259 00000064 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1260 00000068 4770            bx               lr
 1261 0000006A         ;-------------------------------------------------------
                       ---------------------
 1262 0000006A         rom_R80                              ;rom read ($8000-$9
                                                            FFF)
 1263 0000006A         ;-------------------------------------------------------
                       ---------------------
 1264 0000006A F8DA 1054       ldr              r1,memmap_tbl+16
 1265 0000006E F811 000C       ldrb             r0,[r1,addy]
 1266 00000072 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1267 00000076 4770            bx               lr
 1268 00000078         ;-------------------------------------------------------
                       ---------------------
 1269 00000078         rom_RA0                              ;rom read ($A000-$B
                                                            FFF)
 1270 00000078         ;-------------------------------------------------------
                       ---------------------
 1271 00000078 F8DA 1058       ldr              r1,memmap_tbl+20
 1272 0000007C F811 000C       ldrb             r0,[r1,addy]
 1273 00000080 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1274 00000084 4770            bx               lr



ARM Macro Assembler    Page 164 


 1275 00000086         ;-------------------------------------------------------
                       ---------------------
 1276 00000086         rom_RC0                              ;rom read ($C000-$D
                                                            FFF)
 1277 00000086         ;-------------------------------------------------------
                       ---------------------
 1278 00000086 F8DA 105C       ldr              r1,memmap_tbl+24
 1279 0000008A F811 000C       ldrb             r0,[r1,addy]
 1280 0000008E F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1281 00000092 4770            bx               lr
 1282 00000094         ;-------------------------------------------------------
                       ---------------------
 1283 00000094         rom_RE0                              ;rom read ($E000-$F
                                                            FFF)
 1284 00000094         ;-------------------------------------------------------
                       ---------------------
 1285 00000094 F8DA 1060       ldr              r1,memmap_tbl+28
 1286 00000098 F811 000C       ldrb             r0,[r1,addy]
 1287 0000009C F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1288 000000A0 4770            bx               lr
 1289 000000A2         
 1290 000000A2 BF00            nop
 1291 000000A4         ;-------------------------------------------------------
                       ---------------------
 1292 000000A4         ;IO
 1293 000000A4                 AREA             io_code, CODE, READONLY ;--
 1294 00000000         ;-------------------------------------------------------
                       ---------------------
 1295 00000000         
 1296 00000000         ;-------------------------------------------------------
                       ---------------------
 1297 00000000         IO_R                                 ;I/O read
 1298 00000000         ;-------------------------------------------------------
                       ---------------------
 1299 00000000 F244 0218       mov              r2,#0x4018  ;$4018-$6000
 1300 00000004 4594            cmp              r12,r2
 1301 00000006 D8FE            bhi              Read_Low    ;HI  ÎÞ·ûºÅÊý´óÓÚ  
                                                            C==1 && Z==0 
 1302 00000008         
 1303 00000008 F5AC 4180       sub              r1,r12,#0x4000 ;addy=r12
 1304 0000000C 3915            subs             r1,r1,#0x15
 1305 0000000E F53F AFFE       bmi              empty_R     ;¶ÁµØÖ·²»ÕýÈ· MI   
                                                                ¸ºÊý(MInus)    
                                                                           N==1
                                                             
 1306 00000012 2903            cmp              r1,#3
 1307 00000014         ; ldrmi pc,[pc,r2,lsl#2]
 1308 00000014 4A66            ldr              r2,=io_read_tbl ;//¸Ä¹ý£¬¼Ó3ÐÐ
 1309 00000016 EB02 0281       add              r2,r2,r1,lsl#2 ;<<2
 1310 0000001A BF48 F8D2 
              F000             ldrmi            pc,[r2]
 1311 00000020 F7FF BFFE       b                empty_R     ;¶ÁµØÖ·²»ÕýÈ·
 1312 00000024         ; nop
 1313 00000024         
 1314 00000024         io_read_tbl
 1315 00000024 00000000        DCD              apu_4015R   ;void;_4015r ;4015 
                                                            (sound)



ARM Macro Assembler    Page 165 


 1316 00000028 00000000        DCD              joy0_R      ;4016: controller 1
                                                            
 1317 0000002C 00000000        DCD              joy1_R      ;4017: controller 2
                                                            
 1318 00000030         ;-------------------------------------------------------
                       ---------------------
 1319 00000030         IO_W                                 ;I/O write
 1320 00000030         ;-------------------------------------------------------
                       ---------------------
 1321 00000030 F244 0218       mov              r2,#0x4018  ;$4018-$6000
 1322 00000034 4594            cmp              r12,r2
 1323 00000036 D8FE            bhi              Write_Low   ;HI  ÎÞ·ûºÅÊý´óÓÚ  
                                                            C==1 && Z==0 
 1324 00000038         
 1325 00000038 F5AC 4180       sub              r1,r12,#0x4000 ;addy=r12
 1326 0000003C 2918            cmp              r1,#0x18
 1327 0000003E         ; ldrmi pc,[pc,r2,lsl#2]
 1328 0000003E 4A5D            ldr              r2,=io_write_tbl ;//¸Ä¹ý£¬¼Ó3ÐÐ
                                                            
 1329 00000040 EB02 0281       add              r2,r2,r1,lsl#2 ;<<2  
 1330 00000044 BF48 F8D2 
              F000             ldrmi            pc,[r2]     ;//Ö±½Ó²Ù×÷pcÌ«ËûÂè
                                                            Î£ÏÕÁË
 1331 0000004A F7FF BFFE       b                empty_R     ;¶ÁµØÖ·²»ÕýÈ·
 1332 0000004E BF00            nop
 1333 00000050         
 1334 00000050         io_write_tbl
 1335 00000050 00000000        DCD              apu_w       ;void;_4000w
 1336 00000054 00000000        DCD              apu_w       ;_4001w
 1337 00000058 00000000        DCD              apu_w       ;_4002w
 1338 0000005C 00000000        DCD              apu_w       ;_4003w
 1339 00000060 00000000        DCD              apu_w       ;_4004w
 1340 00000064 00000000        DCD              apu_w       ;_4005w
 1341 00000068 00000000        DCD              apu_w       ;_4006w
 1342 0000006C 00000000        DCD              apu_w       ;_4007w
 1343 00000070 00000000        DCD              apu_w       ;_4008w
 1344 00000074 00000000        DCD              apu_w       ;void;
 1345 00000078 00000000        DCD              apu_w       ;_400aw
 1346 0000007C 00000000        DCD              apu_w       ;void;_400bw
 1347 00000080 00000000        DCD              apu_w       ;void;_400cw
 1348 00000084 00000000        DCD              apu_w       ;void
 1349 00000088 00000000        DCD              apu_w       ;void;_400ew
 1350 0000008C 00000000        DCD              apu_w       ;void;_400fw
 1351 00000090 00000000        DCD              apu_w       ;void;_4010w
 1352 00000094 00000000        DCD              apu_w       ;void;_4011w
 1353 00000098 00000000        DCD              apu_w       ;void;_4012w
 1354 0000009C 00000000        DCD              apu_w       ;void;_4013w
 1355 000000A0 00000000        DCD              dma_W       ;$4014: Sprite DMA 
                                                            transfer
 1356 000000A4 00000000        DCD              apu_4015w   ;void;_4015w   ; Éù
                                                            ÒôÍ¨µÀÇÐ»» 
 1357 000000A8         
 1358 000000A8 00000000        DCD              joy0_W      ;$4016: Joypad 0 wr
                                                            ite;joypad_write_pt
                                                            r
 1359 000000AC 00000000        DCD              void        ;joy1_W;$4017: ?
 1360 000000B0         
 1361 000000B0         ;-------------------------------------------------------
                       ------------------------



ARM Macro Assembler    Page 166 


 1362 000000B0                 IMPORT           asm_Mapper_ReadLow
 1363 000000B0         Read_Low
                               PROC                         ;$5000-$6000  mappe
                                                            r->MemoryReadLow(ad
                                                            dr); 
 1364 000000B0         ;-------------------------------------------------------
                       -----------------------
 1365 000000B0 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ» 
 1366 000000B2 4660            mov              r0,r12
 1367 000000B4 F7FF FFFE       bl               asm_Mapper_ReadLow
 1368 000000B8         
 1369 000000B8 E8BD 4008       ldmfd            sp!,{r3,lr}
 1370 000000BC F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1371 000000C0 4770            bx               lr
 1372 000000C2                 ENDP
 1373 000000C2         ;-------------------------------------------------------
                       ------------------------
 1374 000000C2                 IMPORT           asm_Mapper_WriteLow
 1375 000000C2         Write_Low
                               PROC                         ;$5000-$6000  mappe
                                                            r->MemoryWriteLow( 
                                                            data, addr); 
 1376 000000C2         ;-------------------------------------------------------
                       -----------------------
 1377 000000C2 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ» 
 1378 000000C4 4661            mov              r1,r12
 1379 000000C6 F7FF FFFE       bl               asm_Mapper_WriteLow
 1380 000000CA         
 1381 000000CA E8BD 4008       ldmfd            sp!,{r3,lr}
 1382 000000CE F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1383 000000D2 4770            bx               lr
 1384 000000D4                 ENDP
 1385 000000D4         ;-------------------------------------------------------
                       ----------------------
 1386 000000D4                 IMPORT           Apu_Write   ;apu.c 
 1387 000000D4                 IMPORT           Apu_Write4015 ;apu.c 
 1388 000000D4         ;-------------------------------------------------------
                       ----------------------------
 1389 000000D4         apu_w                                ; 0x4000--0x4013
 1390 000000D4         ;-------------------------------------------------------
                       --------------------------
 1391 000000D4 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ» 
 1392 000000D6 F7FF FFFE       bl               Apu_Write
 1393 000000DA         
 1394 000000DA E8BD 4008       ldmfd            sp!,{r3,lr}
 1395 000000DE F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1396 000000E2 4770            bx               lr
 1397 000000E4         ;-------------------------------------------------------
                       ----------------------------
 1398 000000E4         apu_4015w
 1399 000000E4         ;-------------------------------------------------------
                       ------------------
 1400 000000E4 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ»     
                                                             
 1401 000000E6 F7FF FFFE       bl               Apu_Write4015
 1402 000000EA         



ARM Macro Assembler    Page 167 


 1403 000000EA E8BD 4008       ldmfd            sp!,{r3,lr}
 1404 000000EE F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1405 000000F2 4770            bx               lr
 1406 000000F4         
 1407 000000F4         ;-------------------------------------------------------
                       ---------------------
 1408 000000F4                 IMPORT           Apu_Read4015 ;apu.c
 1409 000000F4         apu_4015R                            ;4015
 1410 000000F4         ;-------------------------------------------------------
                       --------------------------- 
 1411 000000F4 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ» 
 1412 000000F6 F101 0015       add              r0,r1,#0x15
 1413 000000FA F7FF FFFE       bl               Apu_Read4015
 1414 000000FE         
 1415 000000FE E8BD 4008       ldmfd            sp!,{r3,lr}
 1416 00000102 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1417 00000106 4770            bx               lr
 1418 00000108         ;-------------------------------------------------------
                       ---------------------
 1419 00000108         dma_W                                ;(4014)  sprite DMA
                                                             transfer ¾«ÁéDMA´«
                                                            Êä DMA·ÃÎÊ¾«ÁéRAM£º
                                                            
 1420 00000108         ;Í¨¹ýÐ´Ò»¸öÖµxxµ½Õâ¸ö¶Ë¿Ú£¬ÒýÆðCPUÄÚ´æµØÖ·Îª$xx00£­$xxFF
                       µÄÇøÓò´«ËÍµ½¾«ÁéÄÚ´æ 
 1421 00000108         ;-------------------------------------------------------
                       ---------------------
 1422 00000108 F5A8 3800       sub              cycles,cycles,#512*256
 1423 0000010C B508            stmfd            sp!,{r3,lr}
 1424 0000010E         
 1425 0000010E F000 01E0       and              r1,r0,#0xe0
 1426 00000112 F10A 0244       adr              r2,memmap_tbl
 1427 00000116 EA4F 01D1       lsr              r1,r1,#3
 1428 0000011A 5852            ldr              r2,[r2,r1]
 1429 0000011C F000 00FF       and              r0,r0,#0xff
 1430 00000120 EB02 2200       add              r2,r2,r0,lsl#8 ;addy  r2=DMA so
                                                            urce Ô´
 1431 00000124 4924            ldr              r1,=spr_ram ;r1     DMAµÄ Ä¿µÄµ
                                                            Ø    ppu.c
 1432 00000126 6809            ldr              r1,[r1]     ;spr_ramÓÃÁËÖ¸Õë
 1433 00000128         
 1434 00000128 F04F 0040       mov              r0,#64      ;256/4/8
 1435 0000012C         copy_
 1436 0000012C 1E40            subs             r0,r0,#1    ;-1
 1437 0000012E F852 3020       ldr              r3,[r2,r0,lsl#2]
 1438 00000132 F841 3020       str              r3,[r1,r0,lsl#2] ;<<2    *4
 1439 00000136 D1F9            bne              copy_
 1440 00000138         
 1441 00000138 E8BD 4008       ldmfd            sp!,{r3,lr}
 1442 0000013C F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1443 00000140 4770            bx               lr
 1444 00000142         ;-------------------------------------------------------
                       ---------------------
 1445 00000142                 IMPORT           PADdata
 1446 00000142                 IMPORT           PADdata1
 1447 00000142         joy0_W                               ;4016  ÊÖ±ú1¼üÖµ [7



ARM Macro Assembler    Page 168 


                                                            :0]ÓÒ7 ×ó6 ÏÂ5 ÉÏ4 
                                                            Start3 Select2 B1 A
                                                            0   )
 1448 00000142         ;-------------------------------------------------------
                       ---------------------
 1449 00000142 F010 0F01       tst              r0,#1       ;0£½Ð´£¬1£½¶Á
 1450 00000146 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1451 0000014A BF18 4770       bxne             lr          ;NE       ²»µÈ£¨Not
                                                            Equal£©  
 1452 0000014E         
 1453 0000014E 491B            ldr              r1,=PADdata ;   //ÊÖ±ú1¼üÖµ  
 1454 00000150 6809            ldr              r1,[r1]
 1455 00000152 F8CA 1098       str              r1,joy0data
 1456 00000156         
 1457 00000156 491A            ldr              r1,=PADdata1 ;   //ÊÖ±ú1¼üÖµ  
 1458 00000158 6809            ldr              r1,[r1]
 1459 0000015A F8CA 109C       str              r1,joy1data
 1460 0000015E         
 1461 0000015E 4770            bx               lr
 1462 00000160         ;-------------------------------------------------------
                       ----------------------   
 1463 00000160         joy1_W                               ;4017  ÊÖ±ú1¼üÖµ [7
                                                            :0]ÓÒ7 ×ó6 ÏÂ5 ÉÏ4 
                                                            Start3 Select2 B1 A
                                                            0   )
 1464 00000160         ;-------------------------------------------------------
                       ---------------------
 1465 00000160         ;tst r0,#1          ; 0£½??£¬1£½¶Á
 1466 00000160         ;orr lr,#0x01  ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈëarm×´Ì¬
 1467 00000160         ;bxne lr  ;NE       ²»µÈ£¨NotEqual£©   
 1468 00000160         
 1469 00000160 4770            bx               lr
 1470 00000162         ;-------------------------------------------------------
                       ---------------------
 1471 00000162         
 1472 00000162         joy0_R                               ;4016
 1473 00000162         ;-------------------------------------------------------
                       --------------------- 
 1474 00000162 F8DA 0098       ldr              r0,joy0data ;´®ÐÐÊý¾Ý  µ±Ç°¶ÁÈ¡
                                                            Î»;joy0dataÊÇ¼üÖµ
 1475 00000166 EA4F 0150       mov              r1,r0,lsr#1 ;>>1
 1476 0000016A F8CA 1098       str              r1,joy0data
 1477 0000016E         
 1478 0000016E F000 0001       and              r0,r0,#1    ;&1 
 1479 00000172 F040 0040       orr              r0,r0,#0x40 ;|0x40
 1480 00000176         
 1481 00000176 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1482 0000017A 4770            bx               lr
 1483 0000017C         ;-------------------------------------------------------
                       ---------------------
 1484 0000017C         joy1_R                               ;4017
 1485 0000017C         ;-------------------------------------------------------
                       ---------------------
 1486 0000017C F8DA 009C       ldr              r0,joy1data ;´®ÐÐÊý¾Ý  µ±Ç°¶ÁÈ¡
                                                            Î»;joy0dataÊÇ¼üÖµ
 1487 00000180 EA4F 0150       mov              r1,r0,lsr#1 ;>>1
 1488 00000184 F8CA 109C       str              r1,joy1data



ARM Macro Assembler    Page 169 


 1489 00000188         
 1490 00000188 F000 0001       and              r0,r0,#1    ;&1 
 1491 0000018C F040 0040       orr              r0,r0,#0x40 ;|0x80£¿  0xf8?
 1492 00000190         
 1493 00000190 F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1494 00000194 4770            bx               lr
 1495 00000196         ;-------------------------------------------------------
                       -------
 1496 00000196         K6502_Read
                               PROC                         ;apu  Rendering DPC
                                                            M channel #5  r0=AP
                                                            U->ApuC5Address²»È·
                                                            ¶¨ÕýÈ·*
 1497 00000196         ;-------------------------------------------------------
                       --------
 1498 00000196                 EXPORT           K6502_Read  ;switch ( wAddr & 0
                                                            xe000 ) apu.c
 1499 00000196 B500            stmfd            sp!,{lr}
 1500 00000198         
 1501 00000198 EA4F 3150       mov              r1,r0,lsr#13 ;>>13=  & 0xe000
 1502 0000019C 4A09            ldr              r2,=CPU_RAM ;;//´æ´¢Æ÷Ó³Ïó ram+
                                                            rom 
 1503 0000019E F852 1021       ldr              r1,[r2,r1,lsl#2] ;lookup rom pt
                                                            r..²éÕÒptr
 1504 000001A2         
 1505 000001A2 F420 4060       bic              r0,r0,#0xe000 ;and r0,#0x1fff &
                                                            0x1fff 
 1506 000001A6 5C08            ldrb             r0,[r1,r0]
 1507 000001A8         
 1508 000001A8 F85D EB04       ldmfd            sp!,{lr}
 1509 000001AC 4770            bx               lr
 1510 000001AE                 ENDP
 1511 000001AE BF00            nop
 1512 000001B0         ;-------------------------------------------------------
                       -----------------
 1513 000001B0 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         AREA             CPU_GPU, CODE, READONLY
 1514 00000000         
 1515 00000000                 IMPORT           PPU_WriteToPort ;PPU.c
 1516 00000000                 IMPORT           PPU_ReadFromPort ;PPU.c
 1517 00000000         ;-------------------------------------------------------
                       -----------------------------
 1518 00000000         PPU_W
 1519 00000000 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ» 
 1520 00000002 4661            mov              r1,r12
 1521 00000004 F7FF FFFE       bl               PPU_WriteToPort
 1522 00000008 E8BD 4008       ldmfd            sp!,{r3,lr}
 1523 0000000C F04E 0E01       orr              lr,#0x01    ;lr×îµÍÎ»ÖÃ1·ÀÖ¹½øÈ
                                                            ëarm×´Ì¬
 1524 00000010 4770            bx               lr
 1525 00000012         ;-------------------------------------------------------
                       -------------------------------
 1526 00000012         PPU_R
 1527 00000012 B508            stmfd            sp!,{r3,lr} ;LR ¼Ä´æÆ÷·ÅÕ»    »



ARM Macro Assembler    Page 170 


                                                            á¸Ä±äR4 
 1528 00000014 4660            mov              r0,r12
 1529 00000016 F7FF FFFE       bl               PPU_ReadFromPort
 1530 0000001A E8BD 4008       ldmfd            sp!,{r3,lr}
 1531 0000001E F04E 0E01       orr              lr,#0x01
 1532 00000022 4770            bx               lr
 1533 00000024 BF00            nop
 1534 00000026         ;-------------------------------------------------------
                       ----------------------------------
 1535 00000026                 AREA             cpu_code, DATA, READONLY
 1536 00002900         ;-------------------------------------------------------
                       ----------------------------------  
 1537 00002900         op_table                             ;DCD ÓÃÓÚ·ÖÅäÒ»¶Î×Ö
                                                            ÄÚ´æµ¥Ôª op_tableÄÚ
                                                            ´æ¿éÆðÊ¼µØÖ·±êºÅ
 1538 00002900 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _00,_01,_xx,_03,_xx,_05,_06,_07
,_08,_09,_0A,_xx,_xx,_0D,_0E,_xx
 1539 00002940 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _10,_11,_xx,_xx,_14,_15,_16,_xx
,_18,_19,_xx,_xx,_xx,_1D,_1E,_xx
 1540 00002980 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 



ARM Macro Assembler    Page 171 


              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _20,_21,_xx,_xx,_24,_25,_26,_xx
,_28,_29,_2A,_xx,_2C,_2D,_2E,_xx
 1541 000029C0 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _30,_31,_xx,_xx,_xx,_35,_36,_xx
,_38,_39,_xx,_xx,_xx,_3D,_3E,_xx
 1542 00002A00 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _40,_41,_xx,_xx,_xx,_45,_46,_xx
,_48,_49,_4A,_xx,_4C,_4D,_4E,_xx
 1543 00002A40 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _50,_51,_xx,_xx,_xx,_55,_56,_xx
,_58,_59,_xx,_xx,_xx,_5D,_5E,_xx
 1544 00002A80 00000000 



ARM Macro Assembler    Page 172 


              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _60,_61,_xx,_xx,_xx,_65,_66,_67
,_68,_69,_6A,_xx,_6C,_6D,_6E,_xx
 1545 00002AC0 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _70,_71,_xx,_xx,_xx,_75,_76,_xx
,_78,_79,_xx,_xx,_xx,_7D,_7E,_xx
 1546 00002B00 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _xx,_81,_xx,_xx,_84,_85,_86,_xx
,_88,_xx,_8A,_xx,_8C,_8D,_8E,_xx
 1547 00002B40 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 



ARM Macro Assembler    Page 173 


              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _90,_91,_xx,_xx,_94,_95,_96,_xx
,_98,_99,_9A,_xx,_xx,_9D,_xx,_xx
 1548 00002B80 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _A0,_A1,_A2,_xx,_A4,_A5,_A6,_xx
,_A8,_A9,_AA,_xx,_AC,_AD,_AE,_xx
 1549 00002BC0 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _B0,_B1,_xx,_xx,_B4,_B5,_B6,_xx
,_B8,_B9,_BA,_xx,_BC,_BD,_BE,_xx
 1550 00002C00 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _C0,_C1,_xx,_xx,_C4,_C5,_C6,_xx
,_C8,_C9,_CA,_xx,_CC,_CD,_CE,_xx



ARM Macro Assembler    Page 174 


 1551 00002C40 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _D0,_D1,_xx,_xx,_xx,_D5,_D6,_xx
,_D8,_D9,_xx,_xx,_xx,_DD,_DE,_xx
 1552 00002C80 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _E0,_E1,_xx,_xx,_E4,_E5,_E6,_xx
,_E8,_E9,_EA,_xx,_EC,_ED,_EE,_xx
 1553 00002CC0 00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000 
              00000000         DCD              _F0,_F1,_xx,_xx,_xx,_F5,_F6,_xx
,_F8,_F9,_xx,_FB,_xx,_FD,_FE,_FF
 1554 00002D00         
 1555 00002D00         ;-------------------------------------------------------
                       --------------------------    
 1556 00002D00                 AREA             wram_globals0, DATA, READWRITE
 1557 00000000         ;-------------------------------------------------------
                       --------------------------  
 1558 00000000         cpu_data
 1559 00000000 00000000        DCD              0           ;opz #   4      //´



ARM Macro Assembler    Page 175 


                                                            úÂë±íµØÖ· 
 1560 00000004         ;readmem_tbl             
 1561 00000004 00000000        DCD              ram_R       ;$0000    
 1562 00000008 00000000        DCD              PPU_R       ;$2000
 1563 0000000C 00000000        DCD              IO_R        ;$4000
 1564 00000010 00000000        DCD              sram_R      ;$6000
 1565 00000014 00000000        DCD              rom_R80     ;$8000
 1566 00000018 00000000        DCD              rom_RA0     ;$A000
 1567 0000001C 00000000        DCD              rom_RC0     ;$C000
 1568 00000020 00000000        DCD              rom_RE0     ;$E000
 1569 00000024         ;writemem_tbl
 1570 00000024 00000000        DCD              ram_W       ;$0000     
 1571 00000028 00000000        DCD              PPU_W       ;$2000   r0´«²ÎÊý
 1572 0000002C 00000000        DCD              IO_W        ;$4000
 1573 00000030 00000000        DCD              sram_W      ;$6000
 1574 00000034 00000000        DCD              void        ;$8000
 1575 00000038 00000000        DCD              void        ;$A000
 1576 0000003C 00000000        DCD              void        ;$C000
 1577 00000040 00000000        DCD              void        ;$E000
 1578 00000044         CPU_RAM                              ;memmap_tbl  ´æ´¢Æ÷
                                                            Ó³Ïó
 1579 00000044 00000000        DCD              NES_RAM     ;$0000   0000-7fff 
                                                             keep $400 byte ali
                                                            gned for 6502 stack
                                                             shit
 1580 00000048 00000000        DCD              NES_RAM     ;$2000    should   
                                                            ±£³Ö1024×Ö½Ú¶ÔÆë
 1581 0000004C 00000000        DCD              NES_RAM     ;$4000     never
 1582 00000050 00000000        DCD              NES_SRAM    ;   NES_RAM-0x5800 
                                                            ;$6000      change¸
                                                            Ä±ä
 1583 00000054 00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00       rommap  %                4*4         ;$8000-FFFF  memmap
                                                            _tbl+16
 1584 00000064         
 1585 00000064         cpustate
 1586 00000064         ;group these together for save/loadstate
 1587 00000064 00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00 00 00 
              00               %                7*4         ;cpuregs (nz,c,a,x,
                                                            y,cycles,pc)
 1588 00000080 00000000        DCD              0           ;m6502_s:
 1589 00000084 00000000        DCD              0           ;lastbank: ×îºóMEMM
                                                            APÌí¼Óµ½PC £¨ÓÃÓÚ¼Æ
                                                            Ëãµ±Ç°µÄPC £©
 1590 00000088 00000000        DCD              0           ;nexttimeout:  jump
                                                             here when cycles r
                                                            uns out Ìøµ½ÏÂÒ»¸öÊ



ARM Macro Assembler    Page 176 


                                                            ±ÖÓÖÜÆÚÔËÐÐ
 1591 0000008C         
 1592 0000008C 00000000        DCD              0           ;rombase # 4   ;//R
                                                            OM¿ªÊ¼µØÖ·
 1593 00000090 00000000        DCD              0           ;romnumber # 4   ;/
                                                            / 
 1594 00000094 00000000        DCD              0           ;rommask # 4     ;/
                                                            /ROMÑÚÄ¤ rommask=ro
                                                            msize-1
 1595 00000098         
 1596 00000098 00000000        DCD              0           ;joy0data # 4    ;/
                                                            /ÊÖ±ú1´®ÐÐÊý¾Ý
 1597 0000009C 00000000        DCD              0           ;joy1data # 4    ;/
                                                            /ÊÖ±ú2´®ÐÐÊý¾Ý 
 1598 000000A0         clocks
 1599 000000A0 00000000        DCD              0           ;clocksh # 4    ;//
                                                            Ö´ÐÐµÄÊ±ÖÓÊý apuÓÃ
 1600 000000A4         cpunmi
 1601 000000A4 00000000        DCD              0           ;cpunmif # 4      ;
                                                            cpuÖÐ¶Ï±êÖ¾
 1602 000000A8         cpuirq
 1603 000000A8 00000000        DCD              0           ;cpuirqf # 4      ;
                                                            cpuÖÐ¶Ï±êÖ¾   
 1604 000000AC         ; DCW 0 DCW¶¨Òå16Î»±äÁ¿
 1605 000000AC         ;-------------------------------------------------------
                       ---------------------
 1606 000000AC         ; ALIGN           ;Í¨¹ýÓÃÁã»ò¿ÕÖ¸ÁîNOPÌî³ä£¬À´Ê¹µ±Ç°Î»ÖÃ
                       ÓëÒ»¸öÖ¸¶¨µÄ±ß½ç¶ÔÆë
 1607 000000AC                 END
Command Line: --xref --diag_suppress=9931 --cpu=Cortex-M3 --apcs=interwork --de
pend=..\obj\6502.d -o..\obj\6502.o -I.\RTE\_WZTENG -ID:\Keil\Packs\Keil\STM32F1
xx_DFP\2.3.0\Device\Include -ID:\Keil\ARM\CMSIS\Include --predefine="__UVISION_
VERSION SETA 527" --predefine="STM32F10X_HD SETA 1" --list=.\6502.lst ..\NES\65
02.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

 0000009A

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000001EE

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000234

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000252

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000002CA

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000003B8

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000402

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000044C

Symbol: 



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000046A

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000051E

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000006C2

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000716

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000075C

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000780

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000007F8

Symbol: 
   Definitions
      None
   Uses



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

      None
Warning:  undefinedComment:  unused
 000008EC

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000936

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000980

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000009A4

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000A74

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000BEE

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000C34

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000C50



ARM Macro Assembler    Page 4 Alphabetic symbol ordering
Relocatable symbols


Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000CC8

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000DB2

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000DFC

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000E46

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000E62

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00000F0E

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000010FC

Symbol: 
   Definitions



ARM Macro Assembler    Page 5 Alphabetic symbol ordering
Relocatable symbols

      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001156

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000117E

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000011F6

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001316

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001374

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000013D2

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000013FA

Symbol: 
   Definitions
      None
   Uses
      None



ARM Macro Assembler    Page 6 Alphabetic symbol ordering
Relocatable symbols

Warning:  undefinedComment:  unused
 00001454

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001576

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000015BC

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001602

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001682

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001796

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000180A

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001886




ARM Macro Assembler    Page 7 Alphabetic symbol ordering
Relocatable symbols

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000019FA

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001A40

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001A86

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001B06

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001C18

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001C90

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001CDA

Symbol: 
   Definitions
      None



ARM Macro Assembler    Page 8 Alphabetic symbol ordering
Relocatable symbols

   Uses
      None
Warning:  undefinedComment:  unused
 00001D24

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001DB0

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001F22

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001F6C

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001FB6

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00001FD2

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000204A

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused



ARM Macro Assembler    Page 9 Alphabetic symbol ordering
Relocatable symbols

 0000213E

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000218C

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000021DA

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000021F6

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000227A

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000240E

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00002458

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000024B0

Symbol: 



ARM Macro Assembler    Page 10 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000024CC

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00002544

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00002654

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 000026B0

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000270C

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 00002728

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
 0000276A

Symbol: 
   Definitions
      None
   Uses



ARM Macro Assembler    Page 11 Alphabetic symbol ordering
Relocatable symbols

      None
Warning:  undefinedComment:  unused
 000027C6

Symbol: 
   Definitions
      None
   Uses
      None
Warning:  undefinedComment:  unused
_00 00000000

Symbol: _00
   Definitions
      At line 68 in file ..\NES\6502.s
   Uses
      At line 1538 in file ..\NES\6502.s
Comment: _00 used once
_01 0000006A

Symbol: _01
   Definitions
      At line 84 in file ..\NES\6502.s
   Uses
      At line 1538 in file ..\NES\6502.s
Comment: _01 used once
_03 0000286E

Symbol: _03
   Definitions
      At line 1055 in file ..\NES\6502.s
   Uses
      At line 1538 in file ..\NES\6502.s
Comment: _03 used once
_05 000000C4

Symbol: _05
   Definitions
      At line 90 in file ..\NES\6502.s
   Uses
      At line 1538 in file ..\NES\6502.s
Comment: _05 used once
_06 000000F6

Symbol: _06
   Definitions
      At line 96 in file ..\NES\6502.s
   Uses
      At line 1538 in file ..\NES\6502.s
Comment: _06 used once
_07 000028B0

Symbol: _07
   Definitions
      At line 1062 in file ..\NES\6502.s
   Uses
      At line 1538 in file ..\NES\6502.s
Comment: _07 used once
_08 0000012E



ARM Macro Assembler    Page 12 Alphabetic symbol ordering
Relocatable symbols


Symbol: _08
   Definitions
      At line 102 in file ..\NES\6502.s
   Uses
      At line 1538 in file ..\NES\6502.s
Comment: _08 used once
_09 00000178

Symbol: _09
   Definitions
      At line 108 in file ..\NES\6502.s
   Uses
      At line 1538 in file ..\NES\6502.s
Comment: _09 used once
_0A 000001A6

Symbol: _0A
   Definitions
      At line 114 in file ..\NES\6502.s
   Uses
      At line 1538 in file ..\NES\6502.s
Comment: _0A used once
_0D 000001D2

Symbol: _0D
   Definitions
      At line 121 in file ..\NES\6502.s
   Uses
      At line 1538 in file ..\NES\6502.s
Comment: _0D used once
_0E 00000218

Symbol: _0E
   Definitions
      At line 127 in file ..\NES\6502.s
   Uses
      At line 1538 in file ..\NES\6502.s
Comment: _0E used once
_10 00000274

Symbol: _10
   Definitions
      At line 133 in file ..\NES\6502.s
   Uses
      At line 1539 in file ..\NES\6502.s
Comment: _10 used once
_11 000002A6

Symbol: _11
   Definitions
      At line 142 in file ..\NES\6502.s
   Uses
      At line 1539 in file ..\NES\6502.s
Comment: _11 used once
_14 00002802

Symbol: _14
   Definitions



ARM Macro Assembler    Page 13 Alphabetic symbol ordering
Relocatable symbols

      At line 1043 in file ..\NES\6502.s
   Uses
      At line 1539 in file ..\NES\6502.s
Comment: _14 used once
_15 000002F4

Symbol: _15
   Definitions
      At line 148 in file ..\NES\6502.s
   Uses
      At line 1539 in file ..\NES\6502.s
Comment: _15 used once
_16 0000032E

Symbol: _16
   Definitions
      At line 154 in file ..\NES\6502.s
   Uses
      At line 1539 in file ..\NES\6502.s
Comment: _16 used once
_18 00000372

Symbol: _18
   Definitions
      At line 160 in file ..\NES\6502.s
   Uses
      At line 1539 in file ..\NES\6502.s
Comment: _18 used once
_19 00000398

Symbol: _19
   Definitions
      At line 165 in file ..\NES\6502.s
   Uses
      At line 1539 in file ..\NES\6502.s
Comment: _19 used once
_1D 000003E2

Symbol: _1D
   Definitions
      At line 171 in file ..\NES\6502.s
   Uses
      At line 1539 in file ..\NES\6502.s
Comment: _1D used once
_1E 0000042C

Symbol: _1E
   Definitions
      At line 177 in file ..\NES\6502.s
   Uses
      At line 1539 in file ..\NES\6502.s
Comment: _1E used once
_20 0000048C

Symbol: _20
   Definitions
      At line 183 in file ..\NES\6502.s
   Uses
      At line 1540 in file ..\NES\6502.s



ARM Macro Assembler    Page 14 Alphabetic symbol ordering
Relocatable symbols

Comment: _20 used once
_21 000004EE

Symbol: _21
   Definitions
      At line 194 in file ..\NES\6502.s
   Uses
      At line 1540 in file ..\NES\6502.s
Comment: _21 used once
_24 00000548

Symbol: _24
   Definitions
      At line 200 in file ..\NES\6502.s
   Uses
      At line 1540 in file ..\NES\6502.s
Comment: _24 used once
_25 00000588

Symbol: _25
   Definitions
      At line 206 in file ..\NES\6502.s
   Uses
      At line 1540 in file ..\NES\6502.s
Comment: _25 used once
_26 000005BA

Symbol: _26
   Definitions
      At line 212 in file ..\NES\6502.s
   Uses
      At line 1540 in file ..\NES\6502.s
Comment: _26 used once
_28 000005F8

Symbol: _28
   Definitions
      At line 218 in file ..\NES\6502.s
   Uses
      At line 1540 in file ..\NES\6502.s
Comment: _28 used once
_29 00000642

Symbol: _29
   Definitions
      At line 224 in file ..\NES\6502.s
   Uses
      At line 1540 in file ..\NES\6502.s
Comment: _29 used once
_2A 00000670

Symbol: _2A
   Definitions
      At line 230 in file ..\NES\6502.s
   Uses
      At line 1540 in file ..\NES\6502.s
Comment: _2A used once
_2C 000006A6




ARM Macro Assembler    Page 15 Alphabetic symbol ordering
Relocatable symbols

Symbol: _2C
   Definitions
      At line 239 in file ..\NES\6502.s
   Uses
      At line 1540 in file ..\NES\6502.s
Comment: _2C used once
_2D 000006FA

Symbol: _2D
   Definitions
      At line 245 in file ..\NES\6502.s
   Uses
      At line 1540 in file ..\NES\6502.s
Comment: _2D used once
_2E 00000740

Symbol: _2E
   Definitions
      At line 251 in file ..\NES\6502.s
   Uses
      At line 1540 in file ..\NES\6502.s
Comment: _2E used once
_30 000007A2

Symbol: _30
   Definitions
      At line 257 in file ..\NES\6502.s
   Uses
      At line 1541 in file ..\NES\6502.s
Comment: _30 used once
_31 000007D4

Symbol: _31
   Definitions
      At line 266 in file ..\NES\6502.s
   Uses
      At line 1541 in file ..\NES\6502.s
Comment: _31 used once
_35 00000822

Symbol: _35
   Definitions
      At line 272 in file ..\NES\6502.s
   Uses
      At line 1541 in file ..\NES\6502.s
Comment: _35 used once
_36 0000085C

Symbol: _36
   Definitions
      At line 278 in file ..\NES\6502.s
   Uses
      At line 1541 in file ..\NES\6502.s
Comment: _36 used once
_38 000008A6

Symbol: _38
   Definitions
      At line 284 in file ..\NES\6502.s



ARM Macro Assembler    Page 16 Alphabetic symbol ordering
Relocatable symbols

   Uses
      At line 1541 in file ..\NES\6502.s
Comment: _38 used once
_39 000008CC

Symbol: _39
   Definitions
      At line 289 in file ..\NES\6502.s
   Uses
      At line 1541 in file ..\NES\6502.s
Comment: _39 used once
_3D 00000916

Symbol: _3D
   Definitions
      At line 295 in file ..\NES\6502.s
   Uses
      At line 1541 in file ..\NES\6502.s
Comment: _3D used once
_3E 00000960

Symbol: _3E
   Definitions
      At line 301 in file ..\NES\6502.s
   Uses
      At line 1541 in file ..\NES\6502.s
Comment: _3E used once
_40 000009C6

Symbol: _40
   Definitions
      At line 307 in file ..\NES\6502.s
   Uses
      At line 1542 in file ..\NES\6502.s
Comment: _40 used once
_41 00000A44

Symbol: _41
   Definitions
      At line 315 in file ..\NES\6502.s
   Uses
      At line 1542 in file ..\NES\6502.s
Comment: _41 used once
_45 00000A9E

Symbol: _45
   Definitions
      At line 321 in file ..\NES\6502.s
   Uses
      At line 1542 in file ..\NES\6502.s
Comment: _45 used once
_46 00000AD0

Symbol: _46
   Definitions
      At line 327 in file ..\NES\6502.s
   Uses
      At line 1542 in file ..\NES\6502.s
Comment: _46 used once



ARM Macro Assembler    Page 17 Alphabetic symbol ordering
Relocatable symbols

_48 00000B04

Symbol: _48
   Definitions
      At line 333 in file ..\NES\6502.s
   Uses
      At line 1542 in file ..\NES\6502.s
Comment: _48 used once
_49 00000B36

Symbol: _49
   Definitions
      At line 339 in file ..\NES\6502.s
   Uses
      At line 1542 in file ..\NES\6502.s
Comment: _49 used once
_4A 00000B64

Symbol: _4A
   Definitions
      At line 345 in file ..\NES\6502.s
   Uses
      At line 1542 in file ..\NES\6502.s
Comment: _4A used once
_4C 00000B90

Symbol: _4C
   Definitions
      At line 352 in file ..\NES\6502.s
   Uses
      At line 1542 in file ..\NES\6502.s
Comment: _4C used once
_4D 00000BD2

Symbol: _4D
   Definitions
      At line 360 in file ..\NES\6502.s
   Uses
      At line 1542 in file ..\NES\6502.s
Comment: _4D used once
_4E 00000C18

Symbol: _4E
   Definitions
      At line 366 in file ..\NES\6502.s
   Uses
      At line 1542 in file ..\NES\6502.s
Comment: _4E used once
_50 00000C72

Symbol: _50
   Definitions
      At line 372 in file ..\NES\6502.s
   Uses
      At line 1543 in file ..\NES\6502.s
Comment: _50 used once
_51 00000CA4

Symbol: _51



ARM Macro Assembler    Page 18 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 381 in file ..\NES\6502.s
   Uses
      At line 1543 in file ..\NES\6502.s
Comment: _51 used once
_55 00000CF2

Symbol: _55
   Definitions
      At line 387 in file ..\NES\6502.s
   Uses
      At line 1543 in file ..\NES\6502.s
Comment: _55 used once
_56 00000D2C

Symbol: _56
   Definitions
      At line 393 in file ..\NES\6502.s
   Uses
      At line 1543 in file ..\NES\6502.s
Comment: _56 used once
_58 00000D6C

Symbol: _58
   Definitions
      At line 399 in file ..\NES\6502.s
   Uses
      At line 1543 in file ..\NES\6502.s
Comment: _58 used once
_59 00000D92

Symbol: _59
   Definitions
      At line 404 in file ..\NES\6502.s
   Uses
      At line 1543 in file ..\NES\6502.s
Comment: _59 used once
_5D 00000DDC

Symbol: _5D
   Definitions
      At line 410 in file ..\NES\6502.s
   Uses
      At line 1543 in file ..\NES\6502.s
Comment: _5D used once
_5E 00000E26

Symbol: _5E
   Definitions
      At line 416 in file ..\NES\6502.s
   Uses
      At line 1543 in file ..\NES\6502.s
Comment: _5E used once
_60 00000E84

Symbol: _60
   Definitions
      At line 422 in file ..\NES\6502.s
   Uses



ARM Macro Assembler    Page 19 Alphabetic symbol ordering
Relocatable symbols

      At line 1544 in file ..\NES\6502.s
Comment: _60 used once
_61 00000EDE

Symbol: _61
   Definitions
      At line 429 in file ..\NES\6502.s
   Uses
      At line 1544 in file ..\NES\6502.s
Comment: _61 used once
_65 00000F4C

Symbol: _65
   Definitions
      At line 435 in file ..\NES\6502.s
   Uses
      At line 1544 in file ..\NES\6502.s
Comment: _65 used once
_66 00000F92

Symbol: _66
   Definitions
      At line 441 in file ..\NES\6502.s
   Uses
      At line 1544 in file ..\NES\6502.s
Comment: _66 used once
_67 00002828

Symbol: _67
   Definitions
      At line 1048 in file ..\NES\6502.s
   Uses
      At line 1544 in file ..\NES\6502.s
Comment: _67 used once
_68 00000FD4

Symbol: _68
   Definitions
      At line 447 in file ..\NES\6502.s
   Uses
      At line 1544 in file ..\NES\6502.s
Comment: _68 used once
_69 0000100E

Symbol: _69
   Definitions
      At line 453 in file ..\NES\6502.s
   Uses
      At line 1544 in file ..\NES\6502.s
Comment: _69 used once
_6A 00001050

Symbol: _6A
   Definitions
      At line 459 in file ..\NES\6502.s
   Uses
      At line 1544 in file ..\NES\6502.s
Comment: _6A used once
_6C 00001084



ARM Macro Assembler    Page 20 Alphabetic symbol ordering
Relocatable symbols


Symbol: _6C
   Definitions
      At line 468 in file ..\NES\6502.s
   Uses
      At line 1544 in file ..\NES\6502.s
Comment: _6C used once
_6D 000010E0

Symbol: _6D
   Definitions
      At line 485 in file ..\NES\6502.s
   Uses
      At line 1544 in file ..\NES\6502.s
Comment: _6D used once
_6E 0000113A

Symbol: _6E
   Definitions
      At line 491 in file ..\NES\6502.s
   Uses
      At line 1544 in file ..\NES\6502.s
Comment: _6E used once
_70 000011A0

Symbol: _70
   Definitions
      At line 497 in file ..\NES\6502.s
   Uses
      At line 1545 in file ..\NES\6502.s
Comment: _70 used once
_71 000011D2

Symbol: _71
   Definitions
      At line 506 in file ..\NES\6502.s
   Uses
      At line 1545 in file ..\NES\6502.s
Comment: _71 used once
_75 00001234

Symbol: _75
   Definitions
      At line 512 in file ..\NES\6502.s
   Uses
      At line 1545 in file ..\NES\6502.s
Comment: _75 used once
_76 00001282

Symbol: _76
   Definitions
      At line 518 in file ..\NES\6502.s
   Uses
      At line 1545 in file ..\NES\6502.s
Comment: _76 used once
_78 000012D0

Symbol: _78
   Definitions



ARM Macro Assembler    Page 21 Alphabetic symbol ordering
Relocatable symbols

      At line 524 in file ..\NES\6502.s
   Uses
      At line 1545 in file ..\NES\6502.s
Comment: _78 used once
_79 000012F6

Symbol: _79
   Definitions
      At line 529 in file ..\NES\6502.s
   Uses
      At line 1545 in file ..\NES\6502.s
Comment: _79 used once
_7D 00001354

Symbol: _7D
   Definitions
      At line 535 in file ..\NES\6502.s
   Uses
      At line 1545 in file ..\NES\6502.s
Comment: _7D used once
_7E 000013B2

Symbol: _7E
   Definitions
      At line 541 in file ..\NES\6502.s
   Uses
      At line 1545 in file ..\NES\6502.s
Comment: _7E used once
_81 0000141C

Symbol: _81
   Definitions
      At line 547 in file ..\NES\6502.s
   Uses
      At line 1546 in file ..\NES\6502.s
Comment: _81 used once
_84 00001476

Symbol: _84
   Definitions
      At line 553 in file ..\NES\6502.s
   Uses
      At line 1546 in file ..\NES\6502.s
Comment: _84 used once
_85 000014A4

Symbol: _85
   Definitions
      At line 559 in file ..\NES\6502.s
   Uses
      At line 1546 in file ..\NES\6502.s
Comment: _85 used once
_86 000014D2

Symbol: _86
   Definitions
      At line 565 in file ..\NES\6502.s
   Uses
      At line 1546 in file ..\NES\6502.s



ARM Macro Assembler    Page 22 Alphabetic symbol ordering
Relocatable symbols

Comment: _86 used once
_88 00001500

Symbol: _88
   Definitions
      At line 571 in file ..\NES\6502.s
   Uses
      At line 1546 in file ..\NES\6502.s
Comment: _88 used once
_8A 0000152A

Symbol: _8A
   Definitions
      At line 577 in file ..\NES\6502.s
   Uses
      At line 1546 in file ..\NES\6502.s
Comment: _8A used once
_8C 00001552

Symbol: _8C
   Definitions
      At line 583 in file ..\NES\6502.s
   Uses
      At line 1546 in file ..\NES\6502.s
Comment: _8C used once
_8D 00001598

Symbol: _8D
   Definitions
      At line 589 in file ..\NES\6502.s
   Uses
      At line 1546 in file ..\NES\6502.s
Comment: _8D used once
_8E 000015DE

Symbol: _8E
   Definitions
      At line 595 in file ..\NES\6502.s
   Uses
      At line 1546 in file ..\NES\6502.s
Comment: _8E used once
_90 00001624

Symbol: _90
   Definitions
      At line 601 in file ..\NES\6502.s
   Uses
      At line 1547 in file ..\NES\6502.s
Comment: _90 used once
_91 00001656

Symbol: _91
   Definitions
      At line 610 in file ..\NES\6502.s
   Uses
      At line 1547 in file ..\NES\6502.s
Comment: _91 used once
_94 000016A4




ARM Macro Assembler    Page 23 Alphabetic symbol ordering
Relocatable symbols

Symbol: _94
   Definitions
      At line 616 in file ..\NES\6502.s
   Uses
      At line 1547 in file ..\NES\6502.s
Comment: _94 used once
_95 000016DA

Symbol: _95
   Definitions
      At line 622 in file ..\NES\6502.s
   Uses
      At line 1547 in file ..\NES\6502.s
Comment: _95 used once
_96 00001710

Symbol: _96
   Definitions
      At line 628 in file ..\NES\6502.s
   Uses
      At line 1547 in file ..\NES\6502.s
Comment: _96 used once
_98 00001746

Symbol: _98
   Definitions
      At line 634 in file ..\NES\6502.s
   Uses
      At line 1547 in file ..\NES\6502.s
Comment: _98 used once
_99 0000176E

Symbol: _99
   Definitions
      At line 640 in file ..\NES\6502.s
   Uses
      At line 1547 in file ..\NES\6502.s
Comment: _99 used once
_9A 000017B8

Symbol: _9A
   Definitions
      At line 646 in file ..\NES\6502.s
   Uses
      At line 1547 in file ..\NES\6502.s
Comment: _9A used once
_9D 000017E2

Symbol: _9D
   Definitions
      At line 652 in file ..\NES\6502.s
   Uses
      At line 1547 in file ..\NES\6502.s
Comment: _9D used once
_A0 0000182C

Symbol: _A0
   Definitions
      At line 658 in file ..\NES\6502.s



ARM Macro Assembler    Page 24 Alphabetic symbol ordering
Relocatable symbols

   Uses
      At line 1548 in file ..\NES\6502.s
Comment: _A0 used once
_A1 00001856

Symbol: _A1
   Definitions
      At line 664 in file ..\NES\6502.s
   Uses
      At line 1548 in file ..\NES\6502.s
Comment: _A1 used once
_A2 000018B0

Symbol: _A2
   Definitions
      At line 670 in file ..\NES\6502.s
   Uses
      At line 1548 in file ..\NES\6502.s
Comment: _A2 used once
_A4 000018DA

Symbol: _A4
   Definitions
      At line 676 in file ..\NES\6502.s
   Uses
      At line 1548 in file ..\NES\6502.s
Comment: _A4 used once
_A5 00001908

Symbol: _A5
   Definitions
      At line 682 in file ..\NES\6502.s
   Uses
      At line 1548 in file ..\NES\6502.s
Comment: _A5 used once
_A6 00001936

Symbol: _A6
   Definitions
      At line 688 in file ..\NES\6502.s
   Uses
      At line 1548 in file ..\NES\6502.s
Comment: _A6 used once
_A8 00001964

Symbol: _A8
   Definitions
      At line 694 in file ..\NES\6502.s
   Uses
      At line 1548 in file ..\NES\6502.s
Comment: _A8 used once
_A9 0000198C

Symbol: _A9
   Definitions
      At line 700 in file ..\NES\6502.s
   Uses
      At line 1548 in file ..\NES\6502.s
Comment: _A9 used once



ARM Macro Assembler    Page 25 Alphabetic symbol ordering
Relocatable symbols

_AA 000019B6

Symbol: _AA
   Definitions
      At line 706 in file ..\NES\6502.s
   Uses
      At line 1548 in file ..\NES\6502.s
Comment: _AA used once
_AC 000019DE

Symbol: _AC
   Definitions
      At line 712 in file ..\NES\6502.s
   Uses
      At line 1548 in file ..\NES\6502.s
Comment: _AC used once
_AD 00001A24

Symbol: _AD
   Definitions
      At line 718 in file ..\NES\6502.s
   Uses
      At line 1548 in file ..\NES\6502.s
Comment: _AD used once
_AE 00001A6A

Symbol: _AE
   Definitions
      At line 724 in file ..\NES\6502.s
   Uses
      At line 1548 in file ..\NES\6502.s
Comment: _AE used once
_B0 00001AB0

Symbol: _B0
   Definitions
      At line 730 in file ..\NES\6502.s
   Uses
      At line 1549 in file ..\NES\6502.s
Comment: _B0 used once
_B1 00001AE2

Symbol: _B1
   Definitions
      At line 739 in file ..\NES\6502.s
   Uses
      At line 1549 in file ..\NES\6502.s
Comment: _B1 used once
_B4 00001B30

Symbol: _B4
   Definitions
      At line 745 in file ..\NES\6502.s
   Uses
      At line 1549 in file ..\NES\6502.s
Comment: _B4 used once
_B5 00001B66

Symbol: _B5



ARM Macro Assembler    Page 26 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 751 in file ..\NES\6502.s
   Uses
      At line 1549 in file ..\NES\6502.s
Comment: _B5 used once
_B6 00001B9C

Symbol: _B6
   Definitions
      At line 757 in file ..\NES\6502.s
   Uses
      At line 1549 in file ..\NES\6502.s
Comment: _B6 used once
_B8 00001BD2

Symbol: _B8
   Definitions
      At line 763 in file ..\NES\6502.s
   Uses
      At line 1549 in file ..\NES\6502.s
Comment: _B8 used once
_B9 00001BF8

Symbol: _B9
   Definitions
      At line 768 in file ..\NES\6502.s
   Uses
      At line 1549 in file ..\NES\6502.s
Comment: _B9 used once
_BA 00001C42

Symbol: _BA
   Definitions
      At line 774 in file ..\NES\6502.s
   Uses
      At line 1549 in file ..\NES\6502.s
Comment: _BA used once
_BC 00001C70

Symbol: _BC
   Definitions
      At line 781 in file ..\NES\6502.s
   Uses
      At line 1549 in file ..\NES\6502.s
Comment: _BC used once
_BD 00001CBA

Symbol: _BD
   Definitions
      At line 787 in file ..\NES\6502.s
   Uses
      At line 1549 in file ..\NES\6502.s
Comment: _BD used once
_BE 00001D04

Symbol: _BE
   Definitions
      At line 793 in file ..\NES\6502.s
   Uses



ARM Macro Assembler    Page 27 Alphabetic symbol ordering
Relocatable symbols

      At line 1549 in file ..\NES\6502.s
Comment: _BE used once
_C0 00001D4E

Symbol: _C0
   Definitions
      At line 799 in file ..\NES\6502.s
   Uses
      At line 1550 in file ..\NES\6502.s
Comment: _C0 used once
_C1 00001D80

Symbol: _C1
   Definitions
      At line 805 in file ..\NES\6502.s
   Uses
      At line 1550 in file ..\NES\6502.s
Comment: _C1 used once
_C4 00001DDE

Symbol: _C4
   Definitions
      At line 811 in file ..\NES\6502.s
   Uses
      At line 1550 in file ..\NES\6502.s
Comment: _C4 used once
_C5 00001E14

Symbol: _C5
   Definitions
      At line 817 in file ..\NES\6502.s
   Uses
      At line 1550 in file ..\NES\6502.s
Comment: _C5 used once
_C6 00001E4A

Symbol: _C6
   Definitions
      At line 823 in file ..\NES\6502.s
   Uses
      At line 1550 in file ..\NES\6502.s
Comment: _C6 used once
_C8 00001E80

Symbol: _C8
   Definitions
      At line 829 in file ..\NES\6502.s
   Uses
      At line 1550 in file ..\NES\6502.s
Comment: _C8 used once
_C9 00001EAA

Symbol: _C9
   Definitions
      At line 835 in file ..\NES\6502.s
   Uses
      At line 1550 in file ..\NES\6502.s
Comment: _C9 used once
_CA 00001EDC



ARM Macro Assembler    Page 28 Alphabetic symbol ordering
Relocatable symbols


Symbol: _CA
   Definitions
      At line 841 in file ..\NES\6502.s
   Uses
      At line 1550 in file ..\NES\6502.s
Comment: _CA used once
_CC 00001F06

Symbol: _CC
   Definitions
      At line 847 in file ..\NES\6502.s
   Uses
      At line 1550 in file ..\NES\6502.s
Comment: _CC used once
_CD 00001F50

Symbol: _CD
   Definitions
      At line 853 in file ..\NES\6502.s
   Uses
      At line 1550 in file ..\NES\6502.s
Comment: _CD used once
_CE 00001F9A

Symbol: _CE
   Definitions
      At line 859 in file ..\NES\6502.s
   Uses
      At line 1550 in file ..\NES\6502.s
Comment: _CE used once
_D0 00001FF4

Symbol: _D0
   Definitions
      At line 865 in file ..\NES\6502.s
   Uses
      At line 1551 in file ..\NES\6502.s
Comment: _D0 used once
_D1 00002026

Symbol: _D1
   Definitions
      At line 874 in file ..\NES\6502.s
   Uses
      At line 1551 in file ..\NES\6502.s
Comment: _D1 used once
_D5 00002078

Symbol: _D5
   Definitions
      At line 880 in file ..\NES\6502.s
   Uses
      At line 1551 in file ..\NES\6502.s
Comment: _D5 used once
_D6 000020B6

Symbol: _D6
   Definitions



ARM Macro Assembler    Page 29 Alphabetic symbol ordering
Relocatable symbols

      At line 886 in file ..\NES\6502.s
   Uses
      At line 1551 in file ..\NES\6502.s
Comment: _D6 used once
_D8 000020F8

Symbol: _D8
   Definitions
      At line 892 in file ..\NES\6502.s
   Uses
      At line 1551 in file ..\NES\6502.s
Comment: _D8 used once
_D9 0000211E

Symbol: _D9
   Definitions
      At line 897 in file ..\NES\6502.s
   Uses
      At line 1551 in file ..\NES\6502.s
Comment: _D9 used once
_DD 0000216C

Symbol: _DD
   Definitions
      At line 903 in file ..\NES\6502.s
   Uses
      At line 1551 in file ..\NES\6502.s
Comment: _DD used once
_DE 000021BA

Symbol: _DE
   Definitions
      At line 909 in file ..\NES\6502.s
   Uses
      At line 1551 in file ..\NES\6502.s
Comment: _DE used once
_E0 00002218

Symbol: _E0
   Definitions
      At line 915 in file ..\NES\6502.s
   Uses
      At line 1552 in file ..\NES\6502.s
Comment: _E0 used once
_E1 0000224A

Symbol: _E1
   Definitions
      At line 921 in file ..\NES\6502.s
   Uses
      At line 1552 in file ..\NES\6502.s
Comment: _E1 used once
_E4 000022B6

Symbol: _E4
   Definitions
      At line 927 in file ..\NES\6502.s
   Uses
      At line 1552 in file ..\NES\6502.s



ARM Macro Assembler    Page 30 Alphabetic symbol ordering
Relocatable symbols

Comment: _E4 used once
_E5 000022EC

Symbol: _E5
   Definitions
      At line 933 in file ..\NES\6502.s
   Uses
      At line 1552 in file ..\NES\6502.s
Comment: _E5 used once
_E6 00002330

Symbol: _E6
   Definitions
      At line 939 in file ..\NES\6502.s
   Uses
      At line 1552 in file ..\NES\6502.s
Comment: _E6 used once
_E8 00002366

Symbol: _E8
   Definitions
      At line 945 in file ..\NES\6502.s
   Uses
      At line 1552 in file ..\NES\6502.s
Comment: _E8 used once
_E9 00002390

Symbol: _E9
   Definitions
      At line 951 in file ..\NES\6502.s
   Uses
      At line 1552 in file ..\NES\6502.s
Comment: _E9 used once
_EA 000023D0

Symbol: _EA
   Definitions
      At line 957 in file ..\NES\6502.s
   Uses
      At line 1552 in file ..\NES\6502.s
Comment: _EA used once
_EC 000023F2

Symbol: _EC
   Definitions
      At line 961 in file ..\NES\6502.s
   Uses
      At line 1552 in file ..\NES\6502.s
Comment: _EC used once
_ED 0000243C

Symbol: _ED
   Definitions
      At line 967 in file ..\NES\6502.s
   Uses
      At line 1552 in file ..\NES\6502.s
Comment: _ED used once
_EE 00002494




ARM Macro Assembler    Page 31 Alphabetic symbol ordering
Relocatable symbols

Symbol: _EE
   Definitions
      At line 973 in file ..\NES\6502.s
   Uses
      At line 1552 in file ..\NES\6502.s
Comment: _EE used once
_F0 000024EE

Symbol: _F0
   Definitions
      At line 979 in file ..\NES\6502.s
   Uses
      At line 1553 in file ..\NES\6502.s
Comment: _F0 used once
_F1 00002520

Symbol: _F1
   Definitions
      At line 988 in file ..\NES\6502.s
   Uses
      At line 1553 in file ..\NES\6502.s
Comment: _F1 used once
_F5 00002580

Symbol: _F5
   Definitions
      At line 994 in file ..\NES\6502.s
   Uses
      At line 1553 in file ..\NES\6502.s
Comment: _F5 used once
_F6 000025CC

Symbol: _F6
   Definitions
      At line 1000 in file ..\NES\6502.s
   Uses
      At line 1553 in file ..\NES\6502.s
Comment: _F6 used once
_F8 0000260E

Symbol: _F8
   Definitions
      At line 1006 in file ..\NES\6502.s
   Uses
      At line 1553 in file ..\NES\6502.s
Comment: _F8 used once
_F9 00002634

Symbol: _F9
   Definitions
      At line 1011 in file ..\NES\6502.s
   Uses
      At line 1553 in file ..\NES\6502.s
Comment: _F9 used once
_FB 000027A6

Symbol: _FB
   Definitions
      At line 1036 in file ..\NES\6502.s



ARM Macro Assembler    Page 32 Alphabetic symbol ordering
Relocatable symbols

   Uses
      At line 1553 in file ..\NES\6502.s
Comment: _FB used once
_FD 00002690

Symbol: _FD
   Definitions
      At line 1017 in file ..\NES\6502.s
   Uses
      At line 1553 in file ..\NES\6502.s
Comment: _FD used once
_FE 000026EC

Symbol: _FE
   Definitions
      At line 1023 in file ..\NES\6502.s
   Uses
      At line 1553 in file ..\NES\6502.s
Comment: _FE used once
_FF 0000274A

Symbol: _FF
   Definitions
      At line 1029 in file ..\NES\6502.s
   Uses
      At line 1553 in file ..\NES\6502.s
Comment: _FF used once
_xx 000028D6

Symbol: _xx
   Definitions
      At line 1071 in file ..\NES\6502.s
   Uses
      At line 1538 in file ..\NES\6502.s
      At line 1538 in file ..\NES\6502.s
      At line 1538 in file ..\NES\6502.s
      At line 1538 in file ..\NES\6502.s
      At line 1538 in file ..\NES\6502.s
      At line 1539 in file ..\NES\6502.s
      At line 1539 in file ..\NES\6502.s
      At line 1539 in file ..\NES\6502.s
      At line 1539 in file ..\NES\6502.s
      At line 1539 in file ..\NES\6502.s
      At line 1539 in file ..\NES\6502.s
      At line 1539 in file ..\NES\6502.s
      At line 1540 in file ..\NES\6502.s
      At line 1540 in file ..\NES\6502.s
      At line 1540 in file ..\NES\6502.s
      At line 1540 in file ..\NES\6502.s
      At line 1540 in file ..\NES\6502.s
      At line 1541 in file ..\NES\6502.s
      At line 1541 in file ..\NES\6502.s
      At line 1541 in file ..\NES\6502.s
      At line 1541 in file ..\NES\6502.s
      At line 1541 in file ..\NES\6502.s
      At line 1541 in file ..\NES\6502.s
      At line 1541 in file ..\NES\6502.s
      At line 1541 in file ..\NES\6502.s
      At line 1542 in file ..\NES\6502.s



ARM Macro Assembler    Page 33 Alphabetic symbol ordering
Relocatable symbols

      At line 1542 in file ..\NES\6502.s
      At line 1542 in file ..\NES\6502.s
      At line 1542 in file ..\NES\6502.s
      At line 1542 in file ..\NES\6502.s
      At line 1542 in file ..\NES\6502.s
      At line 1543 in file ..\NES\6502.s
      At line 1543 in file ..\NES\6502.s
      At line 1543 in file ..\NES\6502.s
      At line 1543 in file ..\NES\6502.s
      At line 1543 in file ..\NES\6502.s
      At line 1543 in file ..\NES\6502.s
      At line 1543 in file ..\NES\6502.s
      At line 1543 in file ..\NES\6502.s
      At line 1544 in file ..\NES\6502.s
      At line 1544 in file ..\NES\6502.s
      At line 1544 in file ..\NES\6502.s
      At line 1544 in file ..\NES\6502.s
      At line 1544 in file ..\NES\6502.s
      At line 1545 in file ..\NES\6502.s
      At line 1545 in file ..\NES\6502.s
      At line 1545 in file ..\NES\6502.s
      At line 1545 in file ..\NES\6502.s
      At line 1545 in file ..\NES\6502.s
      At line 1545 in file ..\NES\6502.s
      At line 1545 in file ..\NES\6502.s
      At line 1545 in file ..\NES\6502.s
      At line 1546 in file ..\NES\6502.s
      At line 1546 in file ..\NES\6502.s
      At line 1546 in file ..\NES\6502.s
      At line 1546 in file ..\NES\6502.s
      At line 1546 in file ..\NES\6502.s
      At line 1546 in file ..\NES\6502.s
      At line 1546 in file ..\NES\6502.s
      At line 1547 in file ..\NES\6502.s
      At line 1547 in file ..\NES\6502.s
      At line 1547 in file ..\NES\6502.s
      At line 1547 in file ..\NES\6502.s
      At line 1547 in file ..\NES\6502.s
      At line 1547 in file ..\NES\6502.s
      At line 1547 in file ..\NES\6502.s
      At line 1548 in file ..\NES\6502.s
      At line 1548 in file ..\NES\6502.s
      At line 1548 in file ..\NES\6502.s
      At line 1548 in file ..\NES\6502.s
      At line 1549 in file ..\NES\6502.s
      At line 1549 in file ..\NES\6502.s
      At line 1549 in file ..\NES\6502.s
      At line 1549 in file ..\NES\6502.s
      At line 1549 in file ..\NES\6502.s
      At line 1550 in file ..\NES\6502.s
      At line 1550 in file ..\NES\6502.s
      At line 1550 in file ..\NES\6502.s
      At line 1550 in file ..\NES\6502.s
      At line 1550 in file ..\NES\6502.s
      At line 1551 in file ..\NES\6502.s
      At line 1551 in file ..\NES\6502.s
      At line 1551 in file ..\NES\6502.s
      At line 1551 in file ..\NES\6502.s
      At line 1551 in file ..\NES\6502.s



ARM Macro Assembler    Page 34 Alphabetic symbol ordering
Relocatable symbols

      At line 1551 in file ..\NES\6502.s
      At line 1551 in file ..\NES\6502.s
      At line 1551 in file ..\NES\6502.s
      At line 1552 in file ..\NES\6502.s
      At line 1552 in file ..\NES\6502.s
      At line 1552 in file ..\NES\6502.s
      At line 1552 in file ..\NES\6502.s
      At line 1552 in file ..\NES\6502.s
      At line 1553 in file ..\NES\6502.s
      At line 1553 in file ..\NES\6502.s
      At line 1553 in file ..\NES\6502.s
      At line 1553 in file ..\NES\6502.s
      At line 1553 in file ..\NES\6502.s
      At line 1553 in file ..\NES\6502.s

cpu_code 00000000

Symbol: cpu_code
   Definitions
      At line 31 in file ..\NES\6502.s
   Uses
      None
Comment: cpu_code unused
op_table 00002900

Symbol: op_table
   Definitions
      At line 1537 in file ..\NES\6502.s
   Uses
      At line 16 in file ..\NES\6502.s
Comment: op_table used once
235 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

CPU_reset 0000013A

Symbol: CPU_reset
   Definitions
      At line 1166 in file ..\NES\6502.s
   Uses
      At line 14 in file ..\NES\6502.s
Comment: CPU_reset used once
CheckI 00000090

Symbol: CheckI
   Definitions
      At line 1128 in file ..\NES\6502.s
   Uses
      At line 1096 in file ..\NES\6502.s
Comment: CheckI used once
NMI6502 00000058

Symbol: NMI6502
   Definitions
      At line 1112 in file ..\NES\6502.s
   Uses
      At line 13 in file ..\NES\6502.s
      At line 1103 in file ..\NES\6502.s

Vec6502 000000C8

Symbol: Vec6502
   Definitions
      At line 1142 in file ..\NES\6502.s
   Uses
      At line 1117 in file ..\NES\6502.s
      At line 1139 in file ..\NES\6502.s
      At line 1190 in file ..\NES\6502.s

VecCont 00000104

Symbol: VecCont
   Definitions
      At line 1149 in file ..\NES\6502.s
   Uses
      At line 79 in file ..\NES\6502.s
Comment: VecCont used once
cpu_run 00000000

Symbol: cpu_run
   Definitions
      At line 1080 in file ..\NES\6502.s
   Uses
      None
Comment: cpu_run unused
default_scanlinehook 0000006E

Symbol: default_scanlinehook
   Definitions
      At line 1124 in file ..\NES\6502.s
   Uses
      At line 1131 in file ..\NES\6502.s
Comment: default_scanlinehook used once



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

exit_nmi 0000004C

Symbol: exit_nmi
   Definitions
      At line 1105 in file ..\NES\6502.s
   Uses
      At line 1120 in file ..\NES\6502.s
Comment: exit_nmi used once
exit_run 00000044

Symbol: exit_run
   Definitions
      At line 1099 in file ..\NES\6502.s
   Uses
      At line 1195 in file ..\NES\6502.s
Comment: exit_run used once
irq6502 00000096

Symbol: irq6502
   Definitions
      At line 1133 in file ..\NES\6502.s
   Uses
      None
Comment: irq6502 unused
run6502 00000000

Symbol: run6502
   Definitions
      At line 1081 in file ..\NES\6502.s
   Uses
      At line 15 in file ..\NES\6502.s
Comment: run6502 used once
11 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

empty_R 00000000

Symbol: empty_R
   Definitions
      At line 1207 in file ..\NES\6502.s
   Uses
      At line 1305 in file ..\NES\6502.s
      At line 1311 in file ..\NES\6502.s
      At line 1331 in file ..\NES\6502.s

ram_R 0000001E

Symbol: ram_R
   Definitions
      At line 1223 in file ..\NES\6502.s
   Uses
      At line 1561 in file ..\NES\6502.s
Comment: ram_R used once
ram_W 0000002C

Symbol: ram_W
   Definitions
      At line 1230 in file ..\NES\6502.s
   Uses
      At line 1570 in file ..\NES\6502.s
Comment: ram_W used once
rom_R60 0000005C

Symbol: rom_R60
   Definitions
      At line 1255 in file ..\NES\6502.s
   Uses
      None
Comment: rom_R60 unused
rom_R80 0000006A

Symbol: rom_R80
   Definitions
      At line 1262 in file ..\NES\6502.s
   Uses
      At line 1565 in file ..\NES\6502.s
Comment: rom_R80 used once
rom_RA0 00000078

Symbol: rom_RA0
   Definitions
      At line 1269 in file ..\NES\6502.s
   Uses
      At line 1566 in file ..\NES\6502.s
Comment: rom_RA0 used once
rom_RC0 00000086

Symbol: rom_RC0
   Definitions
      At line 1276 in file ..\NES\6502.s
   Uses
      At line 1567 in file ..\NES\6502.s
Comment: rom_RC0 used once
rom_RE0 00000094



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols


Symbol: rom_RE0
   Definitions
      At line 1283 in file ..\NES\6502.s
   Uses
      At line 1568 in file ..\NES\6502.s
Comment: rom_RE0 used once
rwram_code 00000000

Symbol: rwram_code
   Definitions
      At line 1203 in file ..\NES\6502.s
   Uses
      None
Comment: rwram_code unused
sram_R 0000003A

Symbol: sram_R
   Definitions
      At line 1237 in file ..\NES\6502.s
   Uses
      At line 1564 in file ..\NES\6502.s
Comment: sram_R used once
sram_W 0000004A

Symbol: sram_W
   Definitions
      At line 1246 in file ..\NES\6502.s
   Uses
      At line 1573 in file ..\NES\6502.s
Comment: sram_W used once
void 00000014

Symbol: void
   Definitions
      At line 1217 in file ..\NES\6502.s
   Uses
      At line 1359 in file ..\NES\6502.s
      At line 1574 in file ..\NES\6502.s
      At line 1575 in file ..\NES\6502.s
      At line 1576 in file ..\NES\6502.s
      At line 1577 in file ..\NES\6502.s

12 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

IO_R 00000000

Symbol: IO_R
   Definitions
      At line 1297 in file ..\NES\6502.s
   Uses
      At line 1563 in file ..\NES\6502.s
Comment: IO_R used once
IO_W 00000030

Symbol: IO_W
   Definitions
      At line 1319 in file ..\NES\6502.s
   Uses
      At line 1572 in file ..\NES\6502.s
Comment: IO_W used once
K6502_Read 00000196

Symbol: K6502_Read
   Definitions
      At line 1496 in file ..\NES\6502.s
   Uses
      At line 1498 in file ..\NES\6502.s
Comment: K6502_Read used once
Read_Low 000000B0

Symbol: Read_Low
   Definitions
      At line 1363 in file ..\NES\6502.s
   Uses
      At line 1301 in file ..\NES\6502.s
Comment: Read_Low used once
Write_Low 000000C2

Symbol: Write_Low
   Definitions
      At line 1375 in file ..\NES\6502.s
   Uses
      At line 1323 in file ..\NES\6502.s
Comment: Write_Low used once
apu_4015R 000000F4

Symbol: apu_4015R
   Definitions
      At line 1409 in file ..\NES\6502.s
   Uses
      At line 1315 in file ..\NES\6502.s
Comment: apu_4015R used once
apu_4015w 000000E4

Symbol: apu_4015w
   Definitions
      At line 1398 in file ..\NES\6502.s
   Uses
      At line 1356 in file ..\NES\6502.s
Comment: apu_4015w used once
apu_w 000000D4

Symbol: apu_w



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 1389 in file ..\NES\6502.s
   Uses
      At line 1335 in file ..\NES\6502.s
      At line 1336 in file ..\NES\6502.s
      At line 1337 in file ..\NES\6502.s
      At line 1338 in file ..\NES\6502.s
      At line 1339 in file ..\NES\6502.s
      At line 1340 in file ..\NES\6502.s
      At line 1341 in file ..\NES\6502.s
      At line 1342 in file ..\NES\6502.s
      At line 1343 in file ..\NES\6502.s
      At line 1344 in file ..\NES\6502.s
      At line 1345 in file ..\NES\6502.s
      At line 1346 in file ..\NES\6502.s
      At line 1347 in file ..\NES\6502.s
      At line 1348 in file ..\NES\6502.s
      At line 1349 in file ..\NES\6502.s
      At line 1350 in file ..\NES\6502.s
      At line 1351 in file ..\NES\6502.s
      At line 1352 in file ..\NES\6502.s
      At line 1353 in file ..\NES\6502.s
      At line 1354 in file ..\NES\6502.s

copy_ 0000012C

Symbol: copy_
   Definitions
      At line 1435 in file ..\NES\6502.s
   Uses
      At line 1439 in file ..\NES\6502.s
Comment: copy_ used once
dma_W 00000108

Symbol: dma_W
   Definitions
      At line 1419 in file ..\NES\6502.s
   Uses
      At line 1355 in file ..\NES\6502.s
Comment: dma_W used once
io_code 00000000

Symbol: io_code
   Definitions
      At line 1293 in file ..\NES\6502.s
   Uses
      None
Comment: io_code unused
io_read_tbl 00000024

Symbol: io_read_tbl
   Definitions
      At line 1314 in file ..\NES\6502.s
   Uses
      At line 1308 in file ..\NES\6502.s
Comment: io_read_tbl used once
io_write_tbl 00000050

Symbol: io_write_tbl



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Relocatable symbols

   Definitions
      At line 1334 in file ..\NES\6502.s
   Uses
      At line 1328 in file ..\NES\6502.s
Comment: io_write_tbl used once
joy0_R 00000162

Symbol: joy0_R
   Definitions
      At line 1472 in file ..\NES\6502.s
   Uses
      At line 1316 in file ..\NES\6502.s
Comment: joy0_R used once
joy0_W 00000142

Symbol: joy0_W
   Definitions
      At line 1447 in file ..\NES\6502.s
   Uses
      At line 1358 in file ..\NES\6502.s
Comment: joy0_W used once
joy1_R 0000017C

Symbol: joy1_R
   Definitions
      At line 1484 in file ..\NES\6502.s
   Uses
      At line 1317 in file ..\NES\6502.s
Comment: joy1_R used once
joy1_W 00000160

Symbol: joy1_W
   Definitions
      At line 1463 in file ..\NES\6502.s
   Uses
      None
Comment: joy1_W unused
17 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

CPU_GPU 00000000

Symbol: CPU_GPU
   Definitions
      At line 1513 in file ..\NES\6502.s
   Uses
      None
Comment: CPU_GPU unused
PPU_R 00000012

Symbol: PPU_R
   Definitions
      At line 1526 in file ..\NES\6502.s
   Uses
      At line 1562 in file ..\NES\6502.s
Comment: PPU_R used once
PPU_W 00000000

Symbol: PPU_W
   Definitions
      At line 1518 in file ..\NES\6502.s
   Uses
      At line 1571 in file ..\NES\6502.s
Comment: PPU_W used once
3 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

CPU_RAM 00000044

Symbol: CPU_RAM
   Definitions
      At line 1578 in file ..\NES\6502.s
   Uses
      At line 1502 in file ..\NES\6502.s
Comment: CPU_RAM used once
clocks 000000A0

Symbol: clocks
   Definitions
      At line 1598 in file ..\NES\6502.s
   Uses
      At line 11 in file ..\NES\6502.s
Comment: clocks used once
cpu_data 00000000

Symbol: cpu_data
   Definitions
      At line 1558 in file ..\NES\6502.s
   Uses
      At line 12 in file ..\NES\6502.s
      At line 1086 in file ..\NES\6502.s

cpuirq 000000A8

Symbol: cpuirq
   Definitions
      At line 1602 in file ..\NES\6502.s
   Uses
      At line 10 in file ..\NES\6502.s
Comment: cpuirq used once
cpunmi 000000A4

Symbol: cpunmi
   Definitions
      At line 1600 in file ..\NES\6502.s
   Uses
      At line 9 in file ..\NES\6502.s
Comment: cpunmi used once
cpustate 00000064

Symbol: cpustate
   Definitions
      At line 1585 in file ..\NES\6502.s
   Uses
      None
Comment: cpustate unused
rommap 00000054

Symbol: rommap
   Definitions
      At line 1583 in file ..\NES\6502.s
   Uses
      None
Comment: rommap unused
wram_globals0 00000000




ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

Symbol: wram_globals0
   Definitions
      At line 1556 in file ..\NES\6502.s
   Uses
      None
Comment: wram_globals0 unused
8 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Absolute symbols

B 00000010

Symbol: B
   Definitions
      At line 6 in file ..\NES\6502mac.s
   Uses
      At line 32 in macro encodeP
      at line 76 in file ..\NES\6502.s
Comment: B used once
C 00000001

Symbol: C
   Definitions
      At line 2 in file ..\NES\6502mac.s
   Uses
      At line 38 in macro decodeP
      at line 221 in file ..\NES\6502.s
Comment: C used once
CYC_C 00000001

Symbol: CYC_C
   Definitions
      At line 24 in file ..\NES\6502.s
   Uses
      At line 27 in macro encodeP
      at line 76 in file ..\NES\6502.s
      At line 387 in macro opASL
      at line 99 in file ..\NES\6502.s
      At line 118 in file ..\NES\6502.s
      At line 162 in file ..\NES\6502.s
      At line 37 in macro decodeP
      at line 221 in file ..\NES\6502.s
      At line 286 in file ..\NES\6502.s
      At line 450 in macro opLSR
      at line 330 in file ..\NES\6502.s
      At line 349 in file ..\NES\6502.s
      At line 443 in macro opLSR
      at line 369 in file ..\NES\6502.s
      At line 459 in macro opLSR
      at line 396 in file ..\NES\6502.s
      At line 371 in macro opADC
      at line 432 in file ..\NES\6502.s
      At line 603 in file ..\NES\6502.s
      At line 732 in file ..\NES\6502.s
      At line 406 in macro opCOMP
      at line 802 in file ..\NES\6502.s
      At line 502 in macro opSBC
      at line 924 in file ..\NES\6502.s

CYC_D 00000008

Symbol: CYC_D
   Definitions
      At line 27 in file ..\NES\6502.s
   Uses
      At line 27 in macro encodeP
      at line 76 in file ..\NES\6502.s
      At line 37 in macro decodeP
      at line 221 in file ..\NES\6502.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Absolute symbols

      At line 894 in file ..\NES\6502.s
      At line 1008 in file ..\NES\6502.s

CYC_I 00000004

Symbol: CYC_I
   Definitions
      At line 26 in file ..\NES\6502.s
   Uses
      At line 27 in macro encodeP
      at line 76 in file ..\NES\6502.s
      At line 37 in macro decodeP
      at line 221 in file ..\NES\6502.s
      At line 401 in file ..\NES\6502.s
      At line 526 in file ..\NES\6502.s
      At line 1130 in file ..\NES\6502.s
      At line 1152 in file ..\NES\6502.s

CYC_V 00000040

Symbol: CYC_V
   Definitions
      At line 28 in file ..\NES\6502.s
   Uses
      At line 27 in macro encodeP
      at line 76 in file ..\NES\6502.s
      At line 394 in macro opBIT
      at line 203 in file ..\NES\6502.s
      At line 396 in macro opBIT
      at line 203 in file ..\NES\6502.s
      At line 37 in macro decodeP
      at line 221 in file ..\NES\6502.s
      At line 374 in file ..\NES\6502.s
      At line 371 in macro opADC
      at line 432 in file ..\NES\6502.s
      At line 372 in macro opADC
      at line 432 in file ..\NES\6502.s
      At line 499 in file ..\NES\6502.s
      At line 765 in file ..\NES\6502.s
      At line 502 in macro opSBC
      at line 924 in file ..\NES\6502.s
      At line 503 in macro opSBC
      at line 924 in file ..\NES\6502.s

D 00000008

Symbol: D
   Definitions
      At line 5 in file ..\NES\6502mac.s
   Uses
      At line 38 in macro decodeP
      at line 221 in file ..\NES\6502.s
Comment: D used once
I 00000004

Symbol: I
   Definitions
      At line 4 in file ..\NES\6502mac.s
   Uses



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Absolute symbols

      At line 38 in macro decodeP
      at line 221 in file ..\NES\6502.s
Comment: I used once
IRQ_VECTOR 0000FFFE

Symbol: IRQ_VECTOR
   Definitions
      At line 18 in file ..\NES\6502.s
   Uses
      At line 78 in file ..\NES\6502.s
      At line 1138 in file ..\NES\6502.s

N 00000080

Symbol: N
   Definitions
      At line 9 in file ..\NES\6502mac.s
   Uses
      At line 29 in macro encodeP
      at line 76 in file ..\NES\6502.s
Comment: N used once
NMI_VECTOR 0000FFFA

Symbol: NMI_VECTOR
   Definitions
      At line 20 in file ..\NES\6502.s
   Uses
      At line 1116 in file ..\NES\6502.s
Comment: NMI_VECTOR used once
R 00000020

Symbol: R
   Definitions
      At line 7 in file ..\NES\6502mac.s
   Uses
      At line 32 in macro encodeP
      at line 76 in file ..\NES\6502.s
Comment: R used once
RES_VECTOR 0000FFFC

Symbol: RES_VECTOR
   Definitions
      At line 19 in file ..\NES\6502.s
   Uses
      At line 1189 in file ..\NES\6502.s
Comment: RES_VECTOR used once
V 00000040

Symbol: V
   Definitions
      At line 8 in file ..\NES\6502mac.s
   Uses
      At line 395 in macro opBIT
      at line 203 in file ..\NES\6502.s
      At line 38 in macro decodeP
      at line 221 in file ..\NES\6502.s

Z 00000002




ARM Macro Assembler    Page 4 Alphabetic symbol ordering
Absolute symbols

Symbol: Z
   Definitions
      At line 3 in file ..\NES\6502mac.s
   Uses
      At line 31 in macro encodeP
      at line 76 in file ..\NES\6502.s
      At line 41 in macro decodeP
      at line 221 in file ..\NES\6502.s

_ABS 00000004

Symbol: _ABS
   Definitions
      At line 238 in file ..\NES\6502mac.s
   Uses
      At line 275 in macro doIIX
      at line 86 in file ..\NES\6502.s
      At line 122 in macro readmem
      at line 469 in macro opORA
      at line 87 in file ..\NES\6502.s
      At line 179 in macro writemem
      at line 388 in macro opASL
      at line 99 in file ..\NES\6502.s
      At line 242 in macro doABS
      at line 123 in file ..\NES\6502.s
      At line 292 in macro doIIY
      at line 144 in file ..\NES\6502.s
      At line 260 in macro doAIY
      at line 167 in file ..\NES\6502.s
      At line 250 in macro doAIX
      at line 173 in file ..\NES\6502.s
      At line 440 in macro opLSR
      at line 330 in file ..\NES\6502.s
      At line 138 in macro readmems
      at line 434 in macro opLOAD
      at line 661 in file ..\NES\6502.s

_IMM 00000001

Symbol: _IMM
   Definitions
      At line 235 in file ..\NES\6502mac.s
   Uses
      At line 131 in macro readmem
      at line 469 in macro opORA
      at line 87 in file ..\NES\6502.s
      At line 270 in macro doIMM
      at line 110 in file ..\NES\6502.s
      At line 145 in macro readmems
      at line 434 in macro opLOAD
      at line 661 in file ..\NES\6502.s

_ZP 00000002

Symbol: _ZP
   Definitions
      At line 236 in file ..\NES\6502mac.s
   Uses
      At line 125 in macro readmem



ARM Macro Assembler    Page 5 Alphabetic symbol ordering
Absolute symbols

      at line 469 in macro opORA
      at line 87 in file ..\NES\6502.s
      At line 322 in macro doZ
      at line 92 in file ..\NES\6502.s
      At line 182 in macro writemem
      at line 388 in macro opASL
      at line 99 in file ..\NES\6502.s
      At line 447 in macro opLSR
      at line 330 in file ..\NES\6502.s
      At line 142 in macro readmems
      at line 434 in macro opLOAD
      at line 661 in file ..\NES\6502.s
      At line 334 in macro doZIX
      at line 747 in file ..\NES\6502.s
      At line 349 in macro doZIY
      at line 759 in file ..\NES\6502.s

_ZPI 00000003

Symbol: _ZPI
   Definitions
      At line 237 in file ..\NES\6502mac.s
   Uses
      At line 128 in macro readmem
      at line 469 in macro opORA
      at line 87 in file ..\NES\6502.s
      At line 185 in macro writemem
      at line 388 in macro opASL
      at line 99 in file ..\NES\6502.s
      At line 342 in macro doZIXf
      at line 150 in file ..\NES\6502.s
      At line 453 in macro opLSR
      at line 330 in file ..\NES\6502.s
      At line 357 in macro doZIYf
      at line 630 in file ..\NES\6502.s

19 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Register relative symbols

clocksh 000000A0

Symbol: clocksh
   Definitions
      At line 25 in file ..\NES\equates.s
   Uses
      At line 47 in macro fetch
      at line 81 in file ..\NES\6502.s
      At line 49 in macro fetch
      at line 81 in file ..\NES\6502.s
      At line 63 in macro fetch_c
      at line 100 in file ..\NES\6502.s
      At line 65 in macro fetch_c
      at line 100 in file ..\NES\6502.s

cpuirqf 000000A8

Symbol: cpuirqf
   Definitions
      At line 27 in file ..\NES\equates.s
   Uses
      At line 1094 in file ..\NES\6502.s
      At line 1136 in file ..\NES\6502.s
      At line 1185 in file ..\NES\6502.s

cpunmif 000000A4

Symbol: cpunmif
   Definitions
      At line 26 in file ..\NES\equates.s
   Uses
      At line 1101 in file ..\NES\6502.s
      At line 1114 in file ..\NES\6502.s
      At line 1184 in file ..\NES\6502.s

cpuregs 00000064

Symbol: cpuregs
   Definitions
      At line 13 in file ..\NES\equates.s
   Uses
      At line 1090 in file ..\NES\6502.s
      At line 1106 in file ..\NES\6502.s
      At line 1192 in file ..\NES\6502.s

joy0data 00000098

Symbol: joy0data
   Definitions
      At line 22 in file ..\NES\equates.s
   Uses
      At line 1455 in file ..\NES\6502.s
      At line 1474 in file ..\NES\6502.s
      At line 1476 in file ..\NES\6502.s

joy1data 0000009C

Symbol: joy1data
   Definitions



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Register relative symbols

      At line 23 in file ..\NES\equates.s
   Uses
      At line 1459 in file ..\NES\6502.s
      At line 1486 in file ..\NES\6502.s
      At line 1488 in file ..\NES\6502.s

lastbank 00000084

Symbol: lastbank
   Definitions
      At line 15 in file ..\NES\equates.s
   Uses
      At line 71 in file ..\NES\6502.s
      At line 186 in file ..\NES\6502.s
      At line 21 in macro encodePC
      at line 191 in file ..\NES\6502.s
      At line 1144 in file ..\NES\6502.s

m6502_s 00000080

Symbol: m6502_s
   Definitions
      At line 14 in file ..\NES\equates.s
   Uses
      At line 194 in macro push16
      at line 74 in file ..\NES\6502.s
      At line 198 in macro push16
      at line 74 in file ..\NES\6502.s
      At line 203 in macro push8
      at line 105 in file ..\NES\6502.s
      At line 205 in macro push8
      at line 105 in file ..\NES\6502.s
      At line 222 in macro pop8
      at line 220 in file ..\NES\6502.s
      At line 224 in macro pop8
      at line 220 in file ..\NES\6502.s
      At line 210 in macro pop16
      at line 311 in file ..\NES\6502.s
      At line 212 in macro pop16
      at line 311 in file ..\NES\6502.s
      At line 213 in macro pop16
      at line 311 in file ..\NES\6502.s
      At line 649 in file ..\NES\6502.s
      At line 776 in file ..\NES\6502.s
      At line 1181 in file ..\NES\6502.s

memmap_tbl 00000044

Symbol: memmap_tbl
   Definitions
      At line 12 in file ..\NES\equates.s
   Uses
      At line 16 in macro encodePC
      at line 191 in file ..\NES\6502.s
      At line 471 in file ..\NES\6502.s
      At line 1154 in file ..\NES\6502.s
      At line 1240 in file ..\NES\6502.s
      At line 1249 in file ..\NES\6502.s
      At line 1257 in file ..\NES\6502.s



ARM Macro Assembler    Page 3 Alphabetic symbol ordering
Register relative symbols

      At line 1264 in file ..\NES\6502.s
      At line 1271 in file ..\NES\6502.s
      At line 1278 in file ..\NES\6502.s
      At line 1285 in file ..\NES\6502.s
      At line 1426 in file ..\NES\6502.s

nexttimeout 00000088

Symbol: nexttimeout
   Definitions
      At line 16 in file ..\NES\equates.s
   Uses
      At line 57 in macro fetch
      at line 81 in file ..\NES\6502.s
      At line 73 in macro fetch_c
      at line 100 in file ..\NES\6502.s
      At line 1196 in file ..\NES\6502.s

opz 00000000

Symbol: opz
   Definitions
      At line 9 in file ..\NES\equates.s
   Uses
      At line 51 in macro fetch
      at line 81 in file ..\NES\6502.s
      At line 67 in macro fetch_c
      at line 100 in file ..\NES\6502.s

readmem_tbl 00000004

Symbol: readmem_tbl
   Definitions
      At line 10 in file ..\NES\equates.s
   Uses
      At line 1174 in file ..\NES\6502.s
Comment: readmem_tbl used once
rombase 0000008C

Symbol: rombase
   Definitions
      At line 18 in file ..\NES\equates.s
   Uses
      None
Comment: rombase unused
rommask 00000094

Symbol: rommask
   Definitions
      At line 20 in file ..\NES\equates.s
   Uses
      None
Comment: rommask unused
romnumber 00000090

Symbol: romnumber
   Definitions
      At line 19 in file ..\NES\equates.s
   Uses



ARM Macro Assembler    Page 4 Alphabetic symbol ordering
Register relative symbols

      None
Comment: romnumber unused
writemem_tbl 00000024

Symbol: writemem_tbl
   Definitions
      At line 11 in file ..\NES\equates.s
   Uses
      At line 154 in macro writememabs
      at line 180 in macro writemem
      at line 388 in macro opASL
      at line 130 in file ..\NES\6502.s
Comment: writemem_tbl used once
16 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

Apu_Read4015 00000000

Symbol: Apu_Read4015
   Definitions
      At line 1408 in file ..\NES\6502.s
   Uses
      At line 1413 in file ..\NES\6502.s
Comment: Apu_Read4015 used once
Apu_Write 00000000

Symbol: Apu_Write
   Definitions
      At line 1386 in file ..\NES\6502.s
   Uses
      At line 1392 in file ..\NES\6502.s
Comment: Apu_Write used once
Apu_Write4015 00000000

Symbol: Apu_Write4015
   Definitions
      At line 1387 in file ..\NES\6502.s
   Uses
      At line 1401 in file ..\NES\6502.s
Comment: Apu_Write4015 used once
NES_RAM 00000000

Symbol: NES_RAM
   Definitions
      At line 5 in file ..\NES\6502.s
   Uses
      At line 1087 in file ..\NES\6502.s
      At line 1177 in file ..\NES\6502.s
      At line 1579 in file ..\NES\6502.s
      At line 1580 in file ..\NES\6502.s
      At line 1581 in file ..\NES\6502.s

NES_SRAM 00000000

Symbol: NES_SRAM
   Definitions
      At line 6 in file ..\NES\6502.s
   Uses
      At line 1582 in file ..\NES\6502.s
Comment: NES_SRAM used once
PADdata 00000000

Symbol: PADdata
   Definitions
      At line 1445 in file ..\NES\6502.s
   Uses
      At line 1453 in file ..\NES\6502.s
Comment: PADdata used once
PADdata1 00000000

Symbol: PADdata1
   Definitions
      At line 1446 in file ..\NES\6502.s
   Uses
      At line 1457 in file ..\NES\6502.s



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
External symbols

Comment: PADdata1 used once
PPU_ReadFromPort 00000000

Symbol: PPU_ReadFromPort
   Definitions
      At line 1516 in file ..\NES\6502.s
   Uses
      At line 1529 in file ..\NES\6502.s
Comment: PPU_ReadFromPort used once
PPU_WriteToPort 00000000

Symbol: PPU_WriteToPort
   Definitions
      At line 1515 in file ..\NES\6502.s
   Uses
      At line 1521 in file ..\NES\6502.s
Comment: PPU_WriteToPort used once
asm_Mapper_ReadLow 00000000

Symbol: asm_Mapper_ReadLow
   Definitions
      At line 1362 in file ..\NES\6502.s
   Uses
      At line 1367 in file ..\NES\6502.s
Comment: asm_Mapper_ReadLow used once
asm_Mapper_WriteLow 00000000

Symbol: asm_Mapper_WriteLow
   Definitions
      At line 1374 in file ..\NES\6502.s
   Uses
      At line 1379 in file ..\NES\6502.s
Comment: asm_Mapper_WriteLow used once
debug_6502 00000000

Symbol: debug_6502
   Definitions
      At line 1070 in file ..\NES\6502.s
   Uses
      At line 1074 in file ..\NES\6502.s
      At line 1211 in file ..\NES\6502.s

spr_ram 00000000

Symbol: spr_ram
   Definitions
      At line 7 in file ..\NES\6502.s
   Uses
      At line 1431 in file ..\NES\6502.s
Comment: spr_ram used once
13 symbols
682 symbols in table
